/*
 Tiny PowerPaste plugin

 Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.

 Version: 5.6.1-517
*/
!function(){function Ud(b){return function(a){return d=typeof(c=a),(null===c?"null":"object"==d&&(Array.prototype.isPrototypeOf(c)||c.constructor&&"Array"===c.constructor.name)?"array":"object"==d&&(String.prototype.isPrototypeOf(c)||c.constructor&&"String"===c.constructor.name)?"string":d)===b;var c,d}}function Vd(b){return function(a){return typeof a===b}}function ba(){}function oc(b,a){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return b(a.apply(null,c))}}function z(b){return function(){return b}}
function wa(b){return b}function xk(b,a){return b===a}function la(b){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];return function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];d=a.concat(d);return b.apply(null,d)}}function pc(b){return function(){throw Error(b);}}function yk(b){return b()}function Wd(b,a){b-=a;return 0==b?0:0<b?1:-1}function $f(b){var a=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(b);if(a){b=parseInt(a[1],10);var c=parseInt(a[2],10);a=parseInt(a[3],
10);b={major:b,minor:c,patch:a}}else b={major:0,minor:0,patch:0};return b}function ag(b){return $f([b.majorVersion,b.minorVersion].join(".").split(".").slice(0,3).join("."))}function Xd(b,a){var c;if(c=b)b=ag(b),a=$f(a),c=Wd(b.major,a.major),0!==c?b=c:(c=Wd(b.minor,a.minor),0!==c?b=c:(b=Wd(b.patch,a.patch),b=0!==b?b:0)),c=-1===b;return c}function Yd(){return ed}function bg(b){return b()}function pa(b,a){return-1<zk.call(b,a)}function Lb(b,a){for(var c=0,d=b.length;c<d;c++)if(a(b[c],c))return!0;return!1}
function N(b,a){for(var c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a(b[e],e);return d}function G(b,a){for(var c=0,d=b.length;c<d;c++)a(b[c],c)}function cg(b,a){for(var c=[],d=[],e=0,f=b.length;e<f;e++){var g=b[e];(a(g,e)?c:d).push(g)}return{pass:c,fail:d}}function ta(b,a){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d];a(f,d)&&c.push(f)}return c}function ob(b,a,c){return G(b,function(d,e){c=a(c,d,e)}),c}function Sa(b,a){a:{for(var c=Pa,d=0,e=b.length;d<e;d++){var f=b[d];if(a(f,d)){b=w.some(f);break a}if(c(f,
d))break}b=w.none()}return b}function dg(b,a){for(var c=0,d=b.length;c<d;c++)if(a(b[c],c))return w.some(c);return w.none()}function eg(b){for(var a=[],c=0,d=b.length;c<d;++c){if(!fd(b[c]))throw Error("Arr.flatten item "+c+" was not an array, input: "+b);Ak.apply(a,b[c])}return a}function ia(b,a){return eg(N(b,a))}function fg(b,a){for(var c=0,d=b.length;c<d;++c)if(!0!==a(b[c],c))return!1;return!0}function gg(b,a){for(var c={},d=0,e=b.length;d<e;d++){var f=b[d];c[String(f)]=a(f,d)}return c}function vb(b,
a){for(var c=0;c<b.length;c++){var d=a(b[c],c);if(d.isSome())return d}return w.none()}function hg(b){return fb(b)&&pa(["clean","merge","prompt"],b)}function Zd(b,a,c){b=b.getParam(a,c);return Ua(b)||hg(b)?b:c}function ig(b){return b.getParam("automatic_uploads",!0,"boolean")}function $d(b){return b.getParam("paste_preprocess")}function jg(b){return Zd(b,"powerpaste_word_import","prompt")}function kg(b){return Zd(b,"powerpaste_html_import","clean")}function ae(b){return!1!==b.getParam("paste_merge_formats")}
function lg(b){return tinymce.explode(b.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))}function mg(b,a){b.dom.bind(a,"drop dragstart dragend dragover dragenter dragleave dragdrop draggesture",function(c){c.preventDefault();c.stopImmediatePropagation()})}function qc(b,a,c){if(c||2===arguments.length)for(var d,e=0,f=a.length;e<f;e++)!d&&e in a||((d=d||Array.prototype.slice.call(a,0,e))[e]=a[e]);return b.concat(d||a)}function xa(b,a){for(var c=Va(b),d=0,e=c.length;d<
e;d++){var f=c[d];a(b[f],f)}}function ng(b,a){return Bk(b,function(c,d){return{k:d,v:a(c,d)}})}function og(b,a){var c={},d=function(e,f){c[f]=e};return xa(b,function(e,f){(a(e,f)?d:ba)(e,f)}),c}function pg(b,a){var c=[];return xa(b,function(d,e){c.push(a(d,e))}),c}function qg(b,a){return wb(b,a)?w.from(b[a]):w.none()}function Wa(b){if(!fd(b))throw Error("cases must be an array");if(0===b.length)throw Error("there must be at least one case");var a=[],c={};return G(b,function(d,e){var f=Va(d);if(1!==
f.length)throw Error("one and only one name per case");var g=f[0],h=d[g];if(void 0!==c[g])throw Error("duplicate key detected:"+g);if("cata"===g)throw Error("cannot have a case named cata (sorry)");if(!fd(h))throw Error("case arguments must be an array");a.push(g);c[g]=function(){for(var l=[],m=0;m<arguments.length;m++)l[m]=arguments[m];m=l.length;if(m!==h.length)throw Error("Wrong number of arguments to case "+g+". Expected "+h.length+" ("+h+"), got "+m);return{fold:function(){for(var k=[],q=0;q<
arguments.length;q++)k[q]=arguments[q];if(k.length!==b.length)throw Error("Wrong number of arguments to fold. Expected "+b.length+", got "+k.length);return k[e].apply(null,l)},match:function(k){var q=Va(k);if(a.length!==q.length)throw Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+q.join(","));if(!fg(a,function(p){return pa(q,p)}))throw Error("Not all branches were specified when using match. Specified: "+q.join(", ")+"\nRequired: "+a.join(", "));return k[g].apply(null,
l)},log:function(k){console.log(k,{constructors:a,constructor:g,params:l})}}}}),c}function Ck(b){setTimeout(function(){throw b;},0)}function rc(b){return a=b,Mb(function(c){var d=[],e=0;0===a.length?c([]):G(a,function(f,g){f.get(function(h){d[g]=h;++e>=a.length&&c(d)})})});var a}function sc(b){var a=(new Date).getTime();return b+"_"+Math.floor(1E9*Math.random())+ ++Dk+String(a)}function tc(b,a){var c=document.createElement("canvas");return c.width=b,c.height=a,c}function Ek(b){var a=tc(b.width,b.height);
return a.getContext("2d").drawImage(b,0,0),a}function Ja(b){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof b)throw new TypeError("not a function");this._value=this._state=null;this._deferreds=[];be(b,Nb(rg,this),Nb(ce,this))}function sg(b){var a=this;null!==this._state?tg(function(){var c=a._state?b.onFulfilled:b.onRejected;if(null!==c){try{var d=c(a._value)}catch(e){return void b.reject(e)}b.resolve(d)}else(a._state?b.resolve:b.reject)(a._value)}):
this._deferreds.push(b)}function rg(b){try{if(b===this)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"==typeof b||"function"==typeof b)){var a=b.then;if("function"==typeof a)return void be(Nb(a,b),Nb(rg,this),Nb(ce,this))}this._state=!0;this._value=b;ug.call(this)}catch(c){ce.call(this,c)}}function ce(b){this._state=!1;this._value=b;ug.call(this)}function ug(){for(var b=0,a=this._deferreds;b<a.length;b++)sg.call(this,a[b]);this._deferreds=[]}function Fk(b,a,c,d){this.onFulfilled=
"function"==typeof b?b:null;this.onRejected="function"==typeof a?a:null;this.resolve=c;this.reject=d}function vg(b){var a=b.split(",");b=/data:([^;]+)/.exec(a[0]);if(!b)return w.none();b=b[1];a=atob(a[1]);for(var c=a.length,d=Math.ceil(c/1024),e=Array(d),f=0;f<d;++f){for(var g=1024*f,h=Math.min(1024+g,c),l=Array(h-g),m=0;g<h;++m,++g)l[m]=a[g].charCodeAt(0);e[f]=new Uint8Array(l)}return w.some(new Blob(e,{type:b}))}function wg(b,a,c){return a=a||"image/png",Ua(HTMLCanvasElement.prototype.toBlob)?new Ka(function(d,
e){b.toBlob(function(f){f?d(f):e()},a,c)}):de(b.toDataURL(a,c))}function xg(b){return a=b,(new Ka(function(c,d){function e(){g.removeEventListener("load",h);g.removeEventListener("error",l)}var f=URL.createObjectURL(a),g=new Image,h=function(){e();c(g)},l=function(){e();d("Unable to load data of type "+a.type+": "+f)};g.addEventListener("load",h);g.addEventListener("error",l);g.src=f;g.complete&&setTimeout(h,0)})).then(function(c){URL.revokeObjectURL(c.src);var d=tc(c.naturalWidth||c.width,c.naturalHeight||
c.height);return d.getContext("2d").drawImage(c,0,0),d});var a}function yg(b){return new Ka(function(a){var c=new FileReader;c.onloadend=function(){a(c.result)};c.readAsDataURL(b)})}function ee(b,a,c){function d(e,f){return b.then(function(g){return g.toDataURL(e||"image/png",f)})}return{getType:z(a.type),toBlob:function(){return Ka.resolve(a)},toDataURL:z(c),toBase64:function(){return c.split(",")[1]},toAdjustedBlob:function(e,f){return b.then(function(g){return wg(g,e,f)})},toAdjustedDataURL:d,
toAdjustedBase64:function(e,f){return d(e,f).then(function(g){return g.split(",")[1]})},toCanvas:function(){return b.then(Ek)}}}function fe(b,a){return wg(b,a).then(function(c){return ee(Ka.resolve(b),c,b.toDataURL())})}function zg(b,a){return d=a,ee(xg(c=b),c,d);var c,d}function Ag(b){return(0===(a=b.src).indexOf("data:")?de:Bg)(a).then(function(c){return yg(d=c).then(function(e){return ee(xg(d),d,e)});var d});var a}function Cg(b,a,c){return void 0===a&&void 0===c?b.toBlob():b.toAdjustedBlob(a,c)}
function uc(b){var a=URL.createObjectURL(b);return Dg(b,a)}function Eg(b,a,c){return""===a||b.length>=a.length&&b.substr(c,c+a.length)===a}function pb(b,a){return ca(b,a)?(c=a.length,b.substring(c)):b;var c}function gd(b,a){return Ob(b,a)?(c=a.length,b.substring(0,b.length-c)):b;var c}function U(b,a){return-1!==b.indexOf(a)}function Fg(b,a){b=b.split(".");var c,d;a=void 0!==a?a:Gg;for(var e=0;e<b.length;++e)void 0!==(c=a)[d=b[e]]&&null!==c[d]||(c[d]={}),a=c[d];return a}function Z(b){return b.dom.nodeName.toLowerCase()}
function hd(b){return function(a){return a.dom.nodeType===b}}function xb(b){return 8===b.dom.nodeType||"#comment"===Z(b)}function ya(b){return function(a){return Ha(a)&&Z(a)===b}}function Hg(b,a,c){if(!(fb(c)||Gk(c)||Hk(c)))throw console.error("Invalid call to Attribute.set. Key ",a,":: Value ",c,":: Element ",b),Error("Attribute value was not simple");b.setAttribute(a,c+"")}function S(b,a,c){Hg(b.dom,a,c)}function vc(b,a){var c=b.dom;xa(a,function(d,e){Hg(c,e,d)})}function za(b,a){b=b.dom.getAttribute(a);
return null===b?void 0:b}function ma(b,a){return w.from(za(b,a))}function wc(b,a){b=b.dom;return!(!b||!b.hasAttribute)&&b.hasAttribute(a)}function V(b,a){b.dom.removeAttribute(a)}function Ig(){return'Safari does not support direct paste of images. <a href="https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work" style="text-decoration: underline">More information on image pasting for Safari</a>'}function gb(b){return tinymce.translate(Ik[b])}function xc(b){if(null==
b)throw Error("Node cannot be null or undefined");return{dom:b}}function Xa(b){return function(a){for(var c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return Jg(b,a,d)}}function P(b,a){Kg&&Kg(b,null);for(var c=a.length;c--;){var d,e=a[c];"string"!=typeof e||(d=yb(e))!==e&&(Jk(a)||(a[c]=d),e=d);b[e]=!0}return b}function Pb(b){var a=Kk(null),c=void 0;for(c in b)Jg(Lk,b,[c])&&(a[c]=b[c]);return a}function id(b,a){for(;null!==b;){var c=Mk(b,a);if(c){if(c.get)return Xa(c.get);
if("function"==typeof c.value)return Xa(c.value)}b=Nk(b)}return function(d){return console.warn("fallback value for",d),null}}function $a(b){if(Array.isArray(b)){for(var a=0,c=Array(b.length);a<b.length;a++)c[a]=b[a];return c}return Array.from(b)}function ge(b){return{sanitizeHtml:function(a,c){return b(a)?a:function(d){yc.addHook("uponSanitizeElement",function(g,h){pa(Lg,h.tagName)||wb(h.allowedTags,h.tagName)||(h.allowedTags[h.tagName]=!0)});yc.addHook("uponSanitizeAttribute",function(g,h){0===
h.attrName.indexOf("on")||wb(h.allowedAttributes,h.attrName)||(h.allowedAttributes[h.attrName]=!0);h.attrValue&&-1!==h.attrValue.indexOf("\n")&&(h.attrValue=h.attrValue.replace(/\r?\n/g,""))});var e=ca(zc(d),"<!"),f=e?"<body>"+d+"</body>":d.replace(/^[\S\s]*?(<!DOCTYPE|<html)/i,"$1");d=yc.sanitize(f,{ALLOW_UNKNOWN_PROTOCOLS:!0,FORBID_TAGS:Lg,WHOLE_DOCUMENT:-1!==d.lastIndexOf("</html>")});return yc.removeHook("uponSanitizeElement"),yc.removeHook("uponSanitizeAttribute"),e?gd(pb(d,"<body>"),"</body>"):
d}(a)},sanitizeText:wa}}function he(b){return-1!==b.indexOf(ie)}function Ok(b,a){a=(new tinymce.html.DomParser({},b.schema)).parse(a,{forced_root_block:!1,isRootContent:!0});return(new tinymce.html.Serializer({validate:!0},b.schema)).serialize(a)}function Mg(b){var a=ge(he),c={sanitizeHtml:la(Ok,b),sanitizeText:wa};return{sanitizeText:a.sanitizeText,sanitizeHtml:function(d,e){return(he(d)?c:a).sanitizeHtml(d,e)}}}function jd(b){(a=document.createElement("div")).appendChild(b.cloneNode(!0));var a;
return a.innerHTML}function Ng(b,a){return function(){return b.apply(a,arguments)}}function je(b){"undefined"!=typeof console&&console.log&&console.log(b)}function Og(b,a,c){return function(d){for(var e=1;e<arguments.length;e++);return tinymce.each(Array.prototype.slice.call(arguments,1),function(f){for(var g in f)d[g]=f[g]}),d}(function(d){if(b&&"string"!=typeof b)return b;switch(b){case "clean":return Pg;case "merge":return Qg;default:return d}}(a),{base_64_images:c})}function ke(b){return b.replace(/-(.)/g,
function(a,c){return c.toUpperCase()})}function Ac(b,a,c){function d(r){e===X&&f.filter(r)}var e,f,g,h,l,m,k;switch(b.nodeType){case 1:a?e=Da:(e=X,f=Pk(b),g={},h=function(r,n){g[r]=n},null!=(k=c||b.getAttribute("style"))&&k.split||(k=b.style.cssText),Aa(k.split(";"),function(r){var n=r.indexOf(":");0<n&&(l=(l=(l=zb(r.substring(0,n))).toUpperCase()===l?l.toLowerCase():l).replace(/([A-Z])/g,function(u,v){return"-"+v.toLowerCase()}),m=zb(r.substring(n+1)),le=le||0===l.indexOf("mso-"),h(l,m))}),le||(m=
b.style["mso-list"])&&h("mso-list",m));var q="HTML"!==b.scopeName&&b.scopeName&&b.tagName&&0>=b.tagName.indexOf(":")?(b.scopeName+":"+b.tagName).toUpperCase():b.tagName;break;case 3:e=qb;var p=b.nodeValue;break;case 8:e=Bc;p=b.nodeValue;break;default:je("WARNING: Unsupported node type encountered: "+b.nodeType)}return{getNode:function(){return f&&f.getAttributes(),b},tag:function(){return q},type:function(){return e},text:function(){return p},toString:function(){return"Type: "+e+", Tag: "+q+" Text: "+
p},getAttribute:function(r){return f.get(r.toLowerCase())},filterAttributes:d,filterStyles:function(r){var n;e===X&&(n="",Aa(g,function(u,v){u=r(v,u);null===u?(b.style.removeProperty?b.style.removeProperty(ke(v)):b.style.removeAttribute(ke(v)),delete g[v]):(n+=v+": "+u+"; ",g[v]=u)}),n=n||null,d(function(u,v){return"style"===u?n:v}),b.style.cssText=n)},getAttributeCount:function(){return f.getAttributeCount()},attributes:function(r){f.each(r)},getStyle:function(r){return g[r]},styles:function(r){Aa(g,
function(n,u){r(u,n)})},getComputedStyle:function(){return(r=b).ownerDocument.defaultView?r.ownerDocument.defaultView.getComputedStyle(r,null):r.currentStyle||{};var r},isWhitespace:function(){return e===qb&&/^[\s\u00A0]*$/.test(p)}}}function kd(b,a,c,d){var e=d.createElement(b),f="";return Aa(a,function(g,h){e.setAttribute(h,g)}),Aa(c,function(g,h){f+=h+":"+g+";";e.style[ke(h)]=g}),Ac(e,!1,""!==f?f:null)}function Ab(b,a){return Ac(a.createElement(b),!0)}function Qk(b){var a=b.createDocumentFragment();
return{dom:a,receive:function(c){switch(c.type()){case X:c=c.getNode().cloneNode(!1);a.appendChild(c);a=c;break;case qb:c=b.createTextNode(c.text());a.appendChild(c);break;case Da:a=a.parentNode;break;case Bc:break;default:throw{message:"Unsupported token type: "+c.type()};}}}}function Ya(b,a){return function(c,d,e){function f(){a&&a(u);p=!1;k=[];q=[]}function g(v){Aa(v,function(y){c.receive(y)})}function h(v){p?q.push(v):c.receive(v)}function l(){r();g(q);f()}var m,k,q,p=!1,r=function(){Aa(m,function(v){h(v)});
n()},n=function(){m=[]},u={document:e||window.document,settings:d||{},emit:h,receive:function(v){a&&k.push(v);b(u,v);v===Cc&&l()},startTransaction:function(){p=!0},rollback:function(){g(k);f()},commit:l,defer:function(v){(m=m||[]).push(v)},hasDeferred:function(){return m&&0<m.length},emitDeferred:r,dropDeferred:n};return f(),u}}function Bb(b){return Ya(function(a,c){c.filterAttributes(Ng(b,a));a.emit(c)})}function Cb(b){return"A"===b.tag()||"SPAN"===b.tag()}function me(b){return(b=b.getStyle("mso-list"))&&
"skip"!==b}function ne(b,a){return b.type()===X?0===b.getAttributeCount()||a&&1===b.getAttributeCount()&&null!==b.getAttribute("style")&&void 0!==b.getAttribute("style"):b.type()===Da}function Rg(b,a){rb.push(a);Qb=Qb||[];if(a.type()===X)Qb.push(a);else if(a.type()===Da&&(Qb.pop(),0===Qb.length)){if(ld){var c;a=rb.length;var d;for(d=0;d<a;d++)if(c=rb[d])if(c.type()===X&&"SPAN"===c.tag()&&ne(c))a:{c=void 0;for(var e=a,f=1,g=d+1;g<e;g++)if((c=rb[g])&&"SPAN"===c.tag())if(c.type()===X)f++;else if(c.type()===
Da&&0==--f){rb[g]=null;break a}}else b.emit(c)}rb=[];ld=!(Qb=[])}}function Sg(b){return!ne(b)&&!/^OLE_LINK/.test(b.getAttribute("name"))}function oe(b,a){a={tag:b.tag,type:b.type,variant:a};return b.start&&(a.start=b.start),b.type||delete a.type,a}function Tg(b,a,c){var d,e,f,g=null;return b&&(d=b.text,e=b.symbolFont),d=zb(d),(g=Rk[d])?g=oe(g,d):e?g=(g=Sk[d])?oe(g,d):{tag:"UL",variant:d}:(Aa(Tk,function(h){if(h.regex.test(d)){if(a&&Ug(h.type,a,!0))return(g=h.type).start=parseInt(d,10),!1;(g=g||h.type).start=
parseInt(d,10)}}),g&&!g.variant&&(f="("===d.charAt(0)?"()":")"===d.charAt(d.length-1)?")":".",g=oe(g,f))),g=g&&"OL"===g.tag&&c&&("P"!==c.tag()||/^MsoHeading/.test(c.getAttribute("class")))?null:g}function Vg(b,a){function c(g){(g=g.style.fontFamily)&&(f="Wingdings"===g||"Symbol"===g)}var d,e,f=!1;if(b.type()===X&&a.openedTag&&"SPAN"===b.tag()){c(b=a.openedTag.getNode());for(1<b.childNodes.length&&"A"===b.firstChild.tagName&&""===b.firstChild.textContent&&(b=b.childNodes[1]);b.firstChild&&("SPAN"===
b.firstChild.tagName||"A"===b.firstChild.tagName);)c(b=b.firstChild);return(b=b.firstChild)&&3===b.nodeType?(d=b.value,zb(d)||(d=(b=b.parentNode.nextSibling)?b.value:""),b&&zb(b.parentNode.textContent)==d&&(e=Tg({text:d,symbolFont:f},null,a.originalToken))&&b.nextSibling&&"SPAN"===b.nextSibling.tagName&&/^[\u00A0\s]/.test(b.nextSibling.firstChild.value)&&("P"===a.openedTag.tag()||"UL"===e.tag)):b&&"IMG"===b.tagName}}function Uk(b,a){function c(k,q){var p={},r={};m++;q&&k.type&&(p={"list-style-type":k.type});
k.start&&1<k.start&&(r={start:k.start});h.push(k);b.emit(kd(k.tag,r,p,a));g=k}function d(){b.emit(Ab(h.pop().tag,a));m--;g=h[h.length-1]}function e(k,q,p){var r,n={};k?void 0!==(r=k.getStyle("margin-left"))&&(n["margin-left"]=r):n["list-style-type"]="none";g&&!Ug(g,q)&&(d(),p&&(b.emit(kd("P",{},{},a)),b.emit(Ac(a.createTextNode("\u00a0"))),b.emit(Ab("P",a))),c(q,!0));b.emit(kd("LI",{},n,a));k&&"P"!==k.tag()?(l.push(k.tag()),k.filterStyles(function(){return null}),b.emit(k)):l.push("P")}function f(){var k=
l?l.pop():"P";"P"!==k&&b.emit(Ab(k,a));b.emit(Ab("LI",a))}var g,h=[],l=[],m=0;return{openList:c,closelist:d,closeAllLists:function(){for(;0<m;)f(),d();b.commit()},closeItem:f,openLI:e,openItem:function(k,q,p,r){if(p){for(m=m||0;k<m;)f(),d();var n;if(p="UL"===(n=p).tag&&Vk[k-1]===n.type?{tag:"UL"}:n,m===k)f(),e(q,p,r);else for(1<k&&0<l.length&&"P"!==l[l.length-1]&&(b.emit(Ab(l[l.length-1],a)),l[l.length-1]="P");m<k;)c(p,m===k-1),e(m===k?q:void 0,p)}},getCurrentListType:function(){return g},getCurrentLevel:function(){return m}}}
function md(b,a){je("Unexpected token in list conversion: "+a.toString());b.rollback()}function pe(b,a,c){c.type()===qb&&""===zb(c.text())?b.defer(c):a.skippedPara||c.type()!==X||"P"!==c.tag()||me(c)?Rb(b,a,c):(a.openedTag=c,b.defer(c),a.nextFilter=Wk)}function Xk(b,a,c){c.type()===Da&&a.originalToken.tag()===c.tag()&&(a.nextFilter=pe,a.styleLevelAdjust=-1);b.emit(c)}function Wg(b){var a,c,d;qa.nextFilter=Yk;qa.itemLevel=0;qa.originalToken=null;qa.commentMode=!1;qa.openedTag=null;qa.symbolFont=!1;
qa.listType=null;qa.indentGuesser={guessIndentLevel:function(e,f,g,h){var l;if(h&&/^([0-9]+\.)+[0-9]+\.?$/.test(h.text))f=h.text.replace(/([0-9]+|\.$)/g,"").length+1;else{g=c||parseInt(Zk(g,f.getAttribute("class")));e=e.getNode();f=f.getNode();h=0;for(e=e.parentNode;null!=e&&e!==f.parentNode;)h+=e.offsetLeft,e=e.offsetParent;f=(l=h,g?a?l+=a:0===l&&(l+=a=g):g=48,c=g=Math.min(l,g),Math.max(1,Math.floor(l/g))||1)}return f}};qa.emitter=Uk(b,b.document);qa.styles=(d=!1,{check:function(e){return d&&e.type()===
qb?(e.text(),!0):e.type()===X&&"STYLE"===e.tag()?d=!0:e.type()===Da&&"STYLE"===e.tag()&&!(d=!1)}});qa.spanCount=[];qa.skippedPara=!1;qa.styleLevelAdjust=0;qa.bulletInfo=void 0}function $k(b,a,c){b=al(b);var d=Xg(b);a.setWordContent(d);var e=Yg;return function(f,g,h,l){var m=Qk(h);f=function(k,q){q=q||window.document;var p=q.createElement("div");q.body.appendChild(p);p.style.position="absolute";p.style.left="-10000px";p.innerHTML=k;var r=p.firstChild||Cc,n=[],u=!1;return{hasNext:function(){return void 0!==
r},next:function(){var v=r,y=u;return!u&&r.firstChild?(n.push(r),r=r.firstChild):u=!u&&1===r.nodeType||(r.nextSibling?(r=r.nextSibling,!1):(r=n.pop(),!0)),v===Cc||r||(q.body.removeChild(p),r=Cc),v===Cc?v:v?Ac(v,y):void 0}}}(f,h);for(g=function(k,q,p){for(var r=m,n=k.length-1;0<=n;n--)r=k[n](r,q,p);return r}(l,g,h);f.hasNext();)g.receive(f.next());return m.dom}(b,a,c,e=d?bl.concat(Yg):e)}function Zg(b,a,c){return{showDialog:function(d){function e(h){var l,m,k,q,p=Mg(b).sanitizeHtml(d);0<p.length&&
(b.fire("PastePreProcess",{content:{content:p},internal:!1}),l=Og(h,Pg,!0),m=Og(h,Qg,!0),k=m,q=$k(p,{setWordContent:function(r){k=r?l:m},get:function(r){return k[r]}},b.getDoc()),b.fire("PastePostProcess",{node:q,internal:!1}),b.undoManager.transact(function(){var r=jd(q);b.insertContent(r)}))}var f=jg(b),g=kg(b);f=Xg(d)?f:g;(Ua(f)?f():L.resolve(f)).then(function(h){h=hg(h)?h:"clean";"prompt"===h?(c?cl:dl).openDialog(b,a,e):e(h)},function(h){console.error(h);e("clean")})}}}function $g(b,a,c,d,e){var f,
g;a=a.replace(ie,"");a=b.hasEventListeners("PastePreProcess")?b.fire("PastePreProcess",{internal:c,content:a,source:d,mode:e}).content:a;return b.hasEventListeners("PastePostProcess")?(f=b.dom.add(b.getBody(),"div",{style:"display:none"},a),g=b.fire("PastePostProcess",{internal:c,node:f,source:d,mode:e}).node.innerHTML,b.dom.remove(f),g):a}function el(b,a,c,d){function e(g,h){return h in g&&0<g[h].length}var f;b.on("dragstart dragend",function(g){f="dragstart"===g.type});b.on("dragover dragend dragleave",
function(g){f||g.preventDefault()});b.on("drop",function(g){if(!f){var h,l=tinymce.dom.RangeUtils;l&&l.getCaretRangeFromPoint&&null!=(h=l.getCaretRangeFromPoint(g.clientX||0,g.clientY||0,b.getDoc()))&&b.selection.setRng(h);h=ta(g.target.files||g.dataTransfer.files,(k=lg(b),function(q){return ca(q.type,"image/")&&Lb(k,function(p){return r=p.toLowerCase(),(wb(n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},r)?"image/"+n[r]:"image/"+r)===q.type;var r,
n})}));if(0<h.length)return rc(N(h,uc)).get(function(q){var p=N(q,function(r){var n=D.fromTag("img");return S(n,"src",La.cata(r,c.getLocalURL,function(u,v,y){return v})),n.dom.outerHTML}).join("");b.insertContent($g(b,p,!1,"imagedrop","auto"),{merge:ae(b)});ig(b)&&c.uploadImages(q)}),void g.preventDefault();l=h=function(q){var p,r={};if(q&&(!q.getData||(p=q.getData("Text"))&&0<p.length&&(r["text/plain"]=p),q.types))for(p=0;p<q.types.length;p++){var n=q.types[p];r[n]=q.getData(n)}return r}(g.dataTransfer);
(m=l["text/plain"])&&0===m.indexOf("file://")||!e(l,"text/html")&&!e(l,"text/plain")||(Zg(b,gb,d).showDialog(h["text/html"]||h["text/plain"]),g.preventDefault())}var m,k})}function fl(){function b(c){URL.revokeObjectURL(c.objurl())}var a={};return{add:function(c,d,e){d={id:z(c),imageresult:z(d),objurl:z(e)};return a[c]=d},get:function(c){return qg(a,c)},remove:function(c){var d=a[c];delete a[c];void 0!==d&&b(d)},lookupByData:function(c){a:{for(var d=a,e=Va(d),f=0,g=e.length;f<g;f++){var h=d[e[f]];
if(h.imageresult().toDataURL()===c){c=w.some(h);break a}}c=w.none()}return c},destroy:function(){xa(a,b);a={}}}}function Ta(b){var a=[];return{bind:function(c){if(void 0===c)throw Error("Event bind error: undefined handler");a.push(c)},unbind:function(c){a=ta(a,function(d){return d!==c})},trigger:function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];var e={};G(b,function(f,g){e[f]=c[g]});G(a,function(f){f(e)})}}}function Db(b){return{registry:ng(b,function(a){return{bind:a.bind,unbind:a.unbind}}),
trigger:ng(b,function(a){return a.trigger})}}function Sb(b){var a,c=!1;return function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];return c||(c=!0,a=b.apply(null,d)),a}}function ah(b,a){var c=String(a).toLowerCase();return Sa(b,function(d){return d.search(c)})}function hb(b){return function(a){return U(a,b)}}function gl(b){return window.matchMedia(b).matches}function qe(b,a){b=b.dom;if(1!==b.nodeType)return!1;if(void 0!==b.matches)return b.matches(a);if(void 0!==b.msMatchesSelector)return b.msMatchesSelector(a);
if(void 0!==b.webkitMatchesSelector)return b.webkitMatchesSelector(a);if(void 0!==b.mozMatchesSelector)return b.mozMatchesSelector(a);throw Error("Browser lacks native selectors");}function bh(b){return 1!==b.nodeType&&9!==b.nodeType&&11!==b.nodeType||0===b.childElementCount}function ra(b,a){a=void 0===a?document:a.dom;return bh(a)?[]:N(a.querySelectorAll(b),D.fromDom)}function Eb(b,a){return b.dom===a.dom}function ab(b){return D.fromDom(b.dom.ownerDocument)}function Dc(b){return hl(b)?b:ab(b)}function bb(b){return w.from(b.dom.parentNode).map(D.fromDom)}
function nd(b){return w.from(b.dom.previousSibling).map(D.fromDom)}function Tb(b){return w.from(b.dom.nextSibling).map(D.fromDom)}function ch(b){return a=function(d){for(var e=[],f=function(h){return e.push(h),d(h)},g=d(b);(g=g.bind(f)).isSome(););return e}(nd),(c=il.call(a,0)).reverse(),c;var a,c}function da(b){return N(b.dom.childNodes,D.fromDom)}function od(b,a){return ra(a,b)}function re(b){var a=b.replace(/\./g,"-");return{resolve:function(c){return N(c.split(" "),function(d){return a+"-"+d}).join(" ")}}}
function jl(b,a){return ra("img["+pd+'="'+a+'"]',b)}function kl(b){return od(b,"img:not(["+pd+"])["+ib.blobId()+"]")}function ll(){function b(){return 0<a.length}var a=[],c=[],d=Db({complete:Ta(["response"])});return{findById:jl,findAll:kl,register:function(e,f){S(e,pd,f);a.push(f)},report:function(e,f,g){G(f,function(h){V(h,pd);c.push({success:g,element:h.dom})});a=ta(a,function(h){return h!==e});b()||(d.trigger.complete(c),c=[])},inProgress:b,isActive:function(e){return pa(a,e)},events:d.registry}}
function dh(){return se(0,0)}function eh(b){function a(d){return function(){return c===d}}var c=b.current;return{current:c,version:b.version,isEdge:a("Edge"),isChrome:a("Chrome"),isIE:a("IE"),isOpera:a("Opera"),isFirefox:a(fh),isSafari:a("Safari")}}function gh(b){function a(d){return function(){return c===d}}var c=b.current;return{current:c,version:b.version,isWindows:a(hh),isiOS:a("iOS"),isAndroid:a(ih),isOSX:a("OSX"),isLinux:a("Linux"),isSolaris:a(jh),isFreeBSD:a(kh),isChromeOS:a(lh)}}function ml(b){return Mb(function(a){var c=
new FileReader;c.onload=function(d){a(d.target?d.target.result:"")};c.readAsText(b)})}function mh(b){try{var a=JSON.parse(b);return R.value(a)}catch(c){return R.error("Response was not JSON.")}}function nl(b,a){function c(d){return jb(kb(R.error({message:d,status:a.status,responseText:a.responseText})))}switch(b){case fa.JSON:return mh(a.response).fold(c,nh);case fa.Blob:case fa.Text:return nh(a.response);default:return c("unknown data type")}}function ol(b){return jb(Mb(function(a){function c(){var p,
r=b.url;(function(n,u){switch(n){case fa.JSON:return mh(u.response).fold(function(){return kb(u.response)},kb);case fa.Blob:return w.from(u.response).map(ml).getOr(kb("no response content"));default:return fa.Text,kb(u.response)}})(b.responseType,p=e).map(function(n){return{message:0===p.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+r+": "+p.statusText,status:p.status,responseText:n}}).get(function(n){return a(R.error(n))})}var d,e=new XMLHttpRequest;e.open(b.method,
(d=b.url,w.from(b.query).map(function(p){p=pg(p,function(n,u){return encodeURIComponent(u)+"="+encodeURIComponent(n)});var r=U(d,"?")?"&":"?";return 0<p.length?d+r+p.join("&"):d}).getOr(d)),!0);var f,g,h,l,m,k=(f=b.body,g=w.from(f).bind(function(p){switch(p.type){case fa.JSON:return w.some("application/json");case fa.FormData:return w.some("application/x-www-form-urlencoded; charset=UTF-8");case fa.MultipartFormData:return w.none();default:return fa.Text,w.some("text/plain")}}),h=!0===b.credentials?
w.some(!0):w.none(),l=function(){switch(b.responseType){case fa.Blob:return"application/octet-stream";case fa.JSON:return"application/json, text/javascript";case fa.Text:return"text/plain";default:return""}}()+", */*; q=0.01",m=void 0!==b.headers?b.headers:{},{contentType:g,responseType:function(){switch(b.responseType){case fa.JSON:return w.none();case fa.Blob:return w.some("blob");case fa.Text:return w.some("text");default:return w.none()}}(),credentials:h,accept:l,headers:m,progress:Ua(b.progress)?
w.some(b.progress):w.none()});var q=e;k.contentType.each(function(p){return q.setRequestHeader("Content-Type",p)});q.setRequestHeader("Accept",k.accept);k.credentials.each(function(p){return q.withCredentials=p});k.responseType.each(function(p){return q.responseType=p});k.progress.each(function(p){return q.upload.addEventListener("progress",function(r){return p(r.loaded,r.total)})});xa(k.headers,function(p,r){return q.setRequestHeader(r,p)});e.onerror=c;e.onload=function(){0===e.status&&!ca(b.url,
"file:")||100>e.status||400<=e.status?c():nl(b.responseType,e).get(a)};w.from(b.body).map(function(p){return p.type===fa.JSON?JSON.stringify(p.data):p.type===fa.FormData||p.type===fa.MultipartFormData?(r=p.data,n=new FormData,xa(r,function(u,v){n.append(v,u)}),n):p.data;var r,n}).fold(function(){return e.send()},function(p){e.send(p)})}))}function te(b,a){var c,d,e,f;return d=null!==(c=(a=void 0===a?{}:a).strictMode)&&void 0!==c&&c,e=(d?pl:ql).exec(b),f=gg("source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
function(g,h){var l;return null!==(l=e[h])&&void 0!==l?l:""}),ua(ua({},f),{queryKey:function(g){for(var h={};;){var l=rl.exec(g);if(null===l)return h;h[l[1]]=l[2]}}(f.query)})}function qd(b){for(var a,c="";""!==b;)ca(b,"../")?b=pb(b,"../"):ca(b,"./")?b=pb(b,"./"):ca(b,"/./")?b="/"+pb(b,"/./"):"/."===b?b="/":ca(b,"/../")?(b="/"+pb(b,"/../"),c=gd(c,c.substring(c.lastIndexOf("/")))):"/.."===b?(b="/",c=gd(c,c.substring(c.lastIndexOf("/")))):"."===b||".."===b?b="":(b=pb(b,a=/(^\/?.*?)(\/|$)/.exec(b)[1]),
c+=a);return c}function ue(b,a,c){return{message:z(b),status:z(a),contents:z(c)}}function ve(b,a){b=za(b,a);return void 0===b||""===b?[]:b.split(" ")}function Ec(b){return void 0!==b.dom.classList}function oh(b){return ve(b,"class")}function Fb(b,a){var c;Ec(b)?b.dom.classList.add(a):(c=ve(b,"class").concat([a]),S(b,"class",c.join(" ")))}function we(b,a){var c;Ec(b)?b.dom.classList.remove(a):0<(c=ta(ve(b,"class"),function(d){return d!==a})).length?S(b,"class",c.join(" ")):V(b,"class");0===(Ec(b)?
b.dom.classList:oh(b)).length&&V(b,"class")}function rd(b,a){return Ec(b)&&b.dom.classList.contains(a)}function ph(b){return function(a){return rd(a,b)}}function qh(b,a,c){b=b.dom;for(c=Ua(c)?c:Pa;b.parentNode;){b=b.parentNode;var d=D.fromDom(b);if(a(d))return w.some(d);if(c(d))break}return w.none()}function xe(b,a){return Sa(b.dom.childNodes,function(c){return a(D.fromDom(c))}).map(D.fromDom)}function ye(b,a){var c=function(d){for(var e=0;e<d.childNodes.length;e++){var f=D.fromDom(d.childNodes[e]);
if(a(f))return w.some(f);f=c(d.childNodes[e]);if(f.isSome())return f}return w.none()};return c(b.dom)}function ze(b,a,c){return qh(b,function(d){return qe(d,a)},c)}function Ae(b,a){return c=a,bh(d=void 0===b?document:b.dom)?w.none():w.from(d.querySelector(c)).map(D.fromDom);var c,d}function rh(b,a,c){return qe(b,a)?w.some(b):Ua(c)&&c(b)?w.none():ze(b,a,c)}function sh(b,a){return{image:z(b),blobInfo:z(a)}}function Ub(b,a){a=(a||document).createElement("div");return a.innerHTML=b,da(D.fromDom(a))}function cb(b,
a){bb(b).each(function(c){c.dom.insertBefore(a.dom,b.dom)})}function th(b,a){Tb(b).fold(function(){bb(b).each(function(c){va(c,a)})},function(c){cb(c,a)})}function uh(b,a){w.from(b.dom.childNodes[0]).map(D.fromDom).fold(function(){va(b,a)},function(c){b.dom.insertBefore(a.dom,c.dom)})}function Be(b,a){cb(b,a);va(a,b)}function Ma(b,a){G(a,function(c){va(b,c)})}function sl(b){we(b,ib.uploadInProgress())}function vh(b){return{importImages:function(a){return rc(ia(a,function(c){return La.cata(c,function(d,
e,f){var g=e.toDataURL();return[Mb(function(h){e.toBlob().then(function(l){var m,k,q,p;b.editorUpload.blobCache.add({id:z(d),name:z(d),filename:(m=l.type,z(4===(p=ag(tinymce)).major&&6>p.minor?d:d+"."+(k=m.toLowerCase(),wb(q={"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"},k)?q[k]:"dat"))),blob:z(l),base64:z(g.split(",")[1]),blobUri:z(f),uri:z(null)});h(l)})})]},z([]))}))},uploadImages:function(){b.uploadImages()},prepareImages:ba,getLocalURL:function(a,c,d){return c.toDataURL()}}}
function tl(b,a){function c(n,u,v){G(u,function(y){S(y,"data-mce-src",n.location)});(function(y,A,B){for(var C=0;C<y.undoManager.data.length;C++)y.undoManager.data[C].content=y.undoManager.data[C].content.split(A.objurl()).join(B.location)})(b,v,n)}function d(){return gb("error.code.images.not.found")+l+gb("error.full.stop")}function e(){return gb("error.imageupload")+l+gb("error.full.stop")}function f(n){n=n.status();m.showDialog(h,(0===n||400<=n||500>n?d:e)())}function g(n,u){var v=q,y=n.blobInfo().id(),
A=n.image(),B=v.isActive(y);v.register(A,y);Fb(A,ib.uploadInProgress());(B?w.none():w.some(y)).each(function(C){function E(){console.error("Internal error with blob cache",M);W(Ce.failure(ue("Internal error with blob cache",666,M)))}var H=n.blobInfo();var I=r;var Q=q;var T=k;var O=D.fromDom(b.getBody());var M=C;var W=function(ea){ea.fold(u,c)};I.upload(H,M,function(ea){var Gb,db=Q.findById(O,M);G(db,(Gb=ib.uploadInProgress(),function(Qa){we(Qa,Gb)}));ea.fold(function(Qa){W(Ce.failure(Qa))},function(Qa){var Na=
M;G(db,function(Hb){S(Hb,"src",Qa.location);V(Hb,ib.blobId())});ul(T,Na).fold(E,function(Hb){W(Ce.success(Qa,db,Hb))})});Q.report(M,db,ea.isValue())})})}var h,l,m,k=fl(),q=ll(),p=(h=b,l=a.url,m=wh,{instance:function(){return Sb(f)}}),r=vl(a);return q.events.complete.bind(function(n){for(n=0;n<b.undoManager.data.length;n++){var u=b.undoManager.data[n].content,v=D.fromTag("div");Ma(v,Ub(u));G(od(v,"."+ib.uploadInProgress()),sl);b.undoManager.data[n].content=v.dom.innerHTML}!0}),{importImages:function(){return kb([])},
uploadImages:function(n){var u=p.instance();var v=q;var y=k;var A=D.fromDom(b.getBody());A=v.findAll(A);G(v.inProgress()?[]:N(A,function(H){return I=y,T=za(Q=H,ib.blobId()),I.get(T).fold(function(){return R.error(T)},function(O){return R.value(sh(Q,O))});var I,Q,T}),function(H){H.fold(function(I){q.report(I,[],!1)},function(I){g(I,u)})});var B=p.instance();var C=k;var E=D.fromDom(b.getBody());G(ia(n,function(H){return La.cata(H,function(I,Q,T){return Ae(E,'img[src="'+T+'"]').fold(function(){return[R.error("Image that was just inserted could not be found: "+
T)]},function(O){return[R.value((M=C,W=I,Gb=T,db=O,Qa=(ea=Q).toDataURL(),Na=M.lookupByData(Qa).getOrThunk(function(){return M.add(W,ea,Gb)}),S(db,ib.blobId(),Na.id()),sh(db,Na)))];var M,W,ea,Gb,db,Qa,Na})},z([]))}),function(H){H.fold(function(I){console.error(I)},function(I){g(I,B)})})},prepareImages:ba,getLocalURL:function(n,u,v){return v}}}function xh(b,a,c,d){var e,f,g=b.selection,h=b.dom,l=b.getBody(),m=c.isText();if(c.reset(),d.clipboardData&&d.clipboardData.getData("text/html"))return d.preventDefault(),
c=d.clipboardData.getData("text/html"),d=c.match(/<html[\s\S]+<\/html>/i),a(null===d?c:d[0]);if(!h.get("_mcePaste")){if(e=h.add(l,"div",{id:"_mcePaste",class:"mcePaste"},'\ufeff<br _mce_bogus="1">'),f=l!==b.getDoc().body?h.getPos(b.selection.getStart(),l).y:l.scrollTop,h.setStyles(e,{position:"absolute",left:-1E4,top:f,width:1,height:1,overflow:"hidden"}),tinymce.isIE)return(q=h.doc.body.createTextRange()).moveToElementText(e),q.execCommand("Paste"),h.remove(e),"\ufeff"===e.innerHTML?(b.execCommand("mcePasteWord"),
void d.preventDefault()):(a(m?e.innerText:e.innerHTML),tinymce.dom.Event.cancel(d));var k,q,p=function(n){n.preventDefault()};h.bind(b.getDoc(),"mousedown",p);h.bind(b.getDoc(),"keydown",p);tinymce.isGecko&&((q=b.selection.getRng(!0)).startContainer!==q.endContainer||3!==q.startContainer.nodeType||1===(k=h.select("p,h1,h2,h3,h4,h5,h6,pre",e)).length&&h.remove(k.reverse(),!0));var r=b.selection.getRng();e=e.firstChild;(q=b.getDoc().createRange()).setStart(e,0);q.setEnd(e,1);g.setRng(q);window.setTimeout(function(){var n=
"",u=h.select("div.mcePaste");Aa(u,function(v){var y=v.firstChild;y&&"DIV"===y.nodeName&&y.style.marginTop&&y.style.backgroundColor&&h.remove(y,1);Aa(h.select("div.mcePaste",v),function(A){h.remove(A,1)});Aa(h.select("span.Apple-style-span",v),function(A){h.remove(A,1)});Aa(h.select("br[_mce_bogus]",v),function(A){h.remove(A)});n+=v.innerHTML});Aa(u,function(v){h.remove(v)});r&&g.setRng(r);a(n);h.unbind(b.getDoc(),"mousedown",p);h.unbind(b.getDoc(),"keydown",p)},0)}}function sb(b){var a=b;return{get:function(){return a},
set:function(c){a=c}}}function yh(b){var a=sb(w.none());return{clear:function(){a.get().each(b);a.set(w.none())},isSet:function(){return a.get().isSome()},get:function(){return a.get()},set:function(c){a.get().each(b);a.set(w.some(c))}}}function De(){var b=yh(ba);return ua(ua({},b),{on:function(a){return b.get().each(a)}})}function wl(b,a,c,d,e){var f=function(g){function h(){return m.stopPropagation()}function l(){return m.preventDefault()}var m,k;c(g)&&d((m=g,k=oc(l,h),{target:D.fromDom(function(q){if(xl()&&
null!=q.target){var p=D.fromDom(q.target);if(Ha(p)&&null!=p.dom.shadowRoot&&q.composed&&q.composedPath&&(p=q.composedPath()))return 0<p.length?w.some(p[0]):w.none()}return w.from(q.target)}(m).getOr(m.target)),x:m.clientX,y:m.clientY,stop:h,prevent:l,kill:k,raw:m}))};return b.dom.addEventListener(a,f,e),{unbind:la(yl,b,a,f,e)}}function Vb(b,a,c){return wl(b,a,zl,c,!1)}function zh(b,a){function c(d){return b(d)?w.from(d.dom.nodeValue):w.none()}return{get:function(d){if(!b(d))throw Error("Can only get "+
a+" value of a "+a+" node");return c(d).getOr("")},getOption:c,set:function(d,e){if(!b(d))throw Error("Can only set raw "+a+" value of a "+a+" node");d.dom.nodeValue=e}}}function Ah(b,a,c){var d=b.document.createRange();return a.fold(function(e){d.setStartBefore(e.dom)},function(e,f){d.setStart(e.dom,f)},function(e){d.setStartAfter(e.dom)}),c.fold(function(e){d.setEndBefore(e.dom)},function(e,f){d.setEnd(e.dom,f)},function(e){d.setEndAfter(e.dom)}),d}function Ee(b,a,c,d,e){b=b.document.createRange();
return b.setStart(a.dom,c),b.setEnd(d.dom,e),b}function Bh(b,a,c){return a(D.fromDom(c.startContainer),c.startOffset,D.fromDom(c.endContainer),c.endOffset)}function Ch(b){return Fe.get(b)}function Dh(b,a){var c=Z(b);return"input"===c?Fc.after(b):pa(["br","img"],c)?0===a?Fc.before(b):Fc.after(b):Fc.on(b,a)}function Eh(b,a,c,d){var e=ab(b).dom.createRange();return e.setStart(b.dom,a),e.setEnd(c.dom,d),e}function Ge(b,a,c,d,e){var f=Ee(b,a,c,d,e);w.from(b.getSelection()).each(function(g){g.removeAllRanges();
g.addRange(f)})}function Al(b,a){return c=b,f=a.match({domRange:function(g){return{ltr:z(g),rtl:w.none}},relative:function(g,h){return{ltr:Sb(function(){return Ah(c,g,h)}),rtl:Sb(function(){return w.some(Ah(c,h,g))})}},exact:function(g,h,l,m){return{ltr:Sb(function(){return Ee(c,g,h,l,m)}),rtl:Sb(function(){return w.some(Ee(c,l,m,g,h))})}}}),((e=(d=f).ltr()).collapsed?d.rtl().filter(function(g){return!1===g.collapsed}).map(function(g){return Gc.rtl(D.fromDom(g.endContainer),g.endOffset,D.fromDom(g.startContainer),
g.startOffset)}).getOrThunk(function(){return Bh(0,Gc.ltr,e)}):Bh(0,Gc.ltr,e)).match({ltr:function(g,h,l,m){Ge(b,g,h,l,m)},rtl:function(g,h,l,m){w.from(b.getSelection()).each(function(k){if(k.setBaseAndExtent)k.setBaseAndExtent(g.dom,h,l.dom,m);else if(k.extend)try{var q=l;var p=m;(r=k).collapse(g.dom,h);r.extend(q.dom,p)}catch(n){Ge(b,l,m,g,h)}else Ge(b,l,m,g,h);var r})}});var c,d,e,f}function Fh(b){if(0<b.rangeCount){var a=b.getRangeAt(0);b=b.getRangeAt(b.rangeCount-1);return w.some(He(D.fromDom(a.startContainer),
a.startOffset,D.fromDom(b.endContainer),b.endOffset))}return w.none()}function Bl(b){if(null===b.anchorNode||null===b.focusNode)return Fh(b);var a=D.fromDom(b.anchorNode),c=D.fromDom(b.focusNode),d=b.anchorOffset,e=b.focusOffset,f=Eh(a,d,c,e);d=Eb(a,c)&&d===e;return f.collapsed&&!d?w.some(He(a,b.anchorOffset,c,b.focusOffset)):Fh(b)}function Gh(b){return w.from(b.getSelection()).filter(function(a){return 0<a.rangeCount}).bind(Bl)}function Ie(b){b.dom.textContent="";G(da(b),function(a){Y(a)})}function sd(b){var a=
da(b);0<a.length&&G(a,function(c){cb(b,c)});Y(b)}function Hh(b,a,c,d){return{startContainer:z(b),startOffset:z(a),endContainer:z(c),endOffset:z(d),collapsed:z(Eb(b,c)&&a===d)}}function Je(b){var a,c=(a=!1,{isBlocked:function(){return a},block:function(){a=!0},unblock:function(){a=!1}});return{control:c,instance:function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];c.isBlocked()||b.apply(void 0,d)}}}function td(b,a,c){return void 0===c&&(c=xk),b.exists(function(d){return c(d,a)})}function Hc(b){return void 0!==
b.style&&Ua(b.style.getPropertyValue)}function Ke(b,a,c){if(!fb(c))throw console.error("Invalid call to CSS.set. Property ",a,":: Value ",c,":: Element ",b),Error("CSS value must be a string: "+c);Hc(b)&&b.style.setProperty(a,c)}function sa(b,a,c){Ke(b.dom,a,c)}function Wb(b,a){var c=b.dom;xa(a,function(d,e){Ke(c,e,d)})}function ja(b,a){var c=b.dom,d=window.getComputedStyle(c).getPropertyValue(a);return""!==d||Le(b)?d:Ih(c,a)}function ka(b,a){b=Ih(b.dom,a);return w.from(b).filter(function(c){return 0<
c.length})}function Me(b){var a={};b=b.dom;if(Hc(b))for(var c=0;c<b.style.length;c++){var d=b.style.item(c);a[d]=b.style[d]}return a}function ha(b,a){var c=b.dom;Hc(c)&&c.style.removeProperty(a);td(ma(b,"style").map(zc),"")&&V(b,"style")}function Cl(b,a){function c(e){return rd(e,Jh)}var d=D.fromTag("div");return vc(d,a),vc(d,{contenteditable:"true","aria-hidden":"true"}),Wb(d,{position:"fixed",top:"0px",width:"100px",height:"100px",overflow:"hidden",opacity:"0"}),G([Kh,Jh],function(e){Fb(d,e)}),
{attach:function(e){Ie(d);sa(d,"left","rtl"===Ic(e)?"100000px":"-100000px");va(e,d)},focus:function(){ze(d,"body").each(function(e){b.toOff(e,d)})},contents:function(){return Tb(d).filter(c).each(function(e){var f=da(e);Ma(d,f);Y(e)}),Dl(d,c),G(da(d),function(e){Ha(e)&&!e.dom.hasChildNodes()&&pa(El,Z(e))&&Y(e)}),{elements:da(d),html:d.dom.innerHTML,offscreen:d}},container:z(d),detach:function(){Y(d)}}}function Fl(b){var a=Eb(b.start,b.finish)&&b.soffset===b.foffset;return{startContainer:z(b.start),
startOffset:z(b.soffset),endContainer:z(b.finish),endOffset:z(b.foffset),collapsed:z(a)}}function Ic(b){return"rtl"===ja(b,"direction")?"rtl":"ltr"}function Gl(b){return function(a){function c(){h.cleanup();var n=l.contents();l.detach();k.trigger.after(n.elements,n.html,l.container())}var d,e,f,g,h,l,m,k,q=Db({after:Ta(["container"])}),p=(d=Hl,e=D.fromTag("br"),f=w.none(),g=function(n){return D.fromDom(Dc(n).dom.defaultView).dom},{cleanup:function(){Y(e)},toOn:function(n,u){var v=g(u);f.each(function(y){var A=
n.dom.childNodes.length,B=Eb(n,y.startContainer())&&A<y.startOffset()?A:y.startOffset();A=Eb(n,y.endContainer())&&A<y.endOffset()?A:y.endOffset();y=Hh(y.startContainer(),B,y.endContainer(),A);d.set(v,y)})},toOff:function(n,u){n=g(u);va(u,e);f=d.get(n);d.set(n,Hh(e,0,e,0))}}),r=(l=Cl(h=p,b),m=Je(function(){k.trigger.before();l.attach(a);l.focus();var n=ab(a);Il(n,m,c)}),{instance:z(function(){m.instance()}),destroy:ba,events:(k=Db({before:Ta([]),after:Ta(["elements","html","container"])})).registry});
return r.events.after.bind(function(n){p.toOn(a,n.container);q.trigger.after(n.container)}),{run:function(){r.instance()()},events:q.registry}}}function Jl(b,a){return Ne.nu(function(c){function d(m){G(l,function(k){k.unbind()});c(m.fold(function(k){return R.error(k+'Unable to download editor stylesheets from "'+b+'"')},R.value))}var e,f,g,h=(e=D.fromDom(document),vc(f=D.fromTag("link",e.dom),{rel:"stylesheet",type:"text/css",href:b}),g=function(){var m=e.dom.head;if(null==m)throw Error("Head is not available yet");
return D.fromDom(m)}(),va(g,f),f),l=[Vb(h,"load",function(m){a:{try{var k=m.target.dom.sheet.cssRules;var q=Kl(k)&&0===k.length;break a}catch(p){}q=void 0}q?d(R.error("")):a(d)}),Vb(h,"error",la(d,R.error("")))]})}function ud(b,a,c,d,e){return b.fold(a,c,d,e)}function Lh(b,a){var c={};return G(Mh,function(d){a[d].or(b[d]).each(function(e){c[d]=e})}),na(c)}function Nh(b){return{response:vd(b),bundle:na({})}}function wd(b){return L.resolve(Nh(b))}function Oh(b,a,c,d){return{steps:b,input:a,label:c,
capture:d}}function Ph(b,a){var c,d,e=Lh(b.bundle,a.bundle);return{response:(c=b.response,d=a.response,ud(c,w.none,w.none,w.none,function(f,g,h){return ud(d,w.none,function(l,m){return w.some(Jc.incomplete(l,m,h))},w.none,w.none)}).getOr(d)),bundle:e}}function Qh(b,a,c){function d(){return b}function e(){var f=c(a,b);return null!=f.then?f.then(function(g){return Ph(b,g)}):Ph(b,f)}return b.response.fold(d,e,d,e)}function Oe(b,a){var c=Z(b),d=void 0!==a.condition?a.condition:Ra;return t.matches(a.name,
c)&&d(b)}function Pe(b,a,c){var d;b=b.dom.getAttribute("style");var e=(d={},G(null==b?[]:b.split(";"),function(g){g=g.split(":");2===g.length&&(d[zc(g[0])]=zc(g[1]))}),d),f={};return G(a,function(g){var h=e[g];void 0===h||c(h,g)||(f[g]=h)}),f}function Rh(b){return N(Va(b),function(a){return a+": "+b[a]}).join("; ")}function Sh(b,a){var c,d,e,f=Pe(b,Ll,a);!function(g,h,l){S(g,"style","");var m,k,q=Va(h).length,p=Va(l).length;0===q&&0===p?V(g,"style"):0===q?S(g,"style",Rh(l)):(xa(h,function(r,n){sa(g,
n,r)}),m=za(g,"style"),k=0<p?Rh(l)+"; ":"",S(g,"style",k+m))}(b,(d=null==(c=b.dom.style)?[]:c,e={},G(d,function(g){ka(b,g).each(function(h){a(h,g)||(e[g]=h)})}),e),f)}function Ml(b,a){var c;var d=(c={},G(b.dom.attributes,function(f){a(f.value,f.name)||(c[f.name]=f.value)}),c);var e=N(b.dom.attributes,function(f){return f.name});Va(d).length!==e.length&&(G(e,function(f){V(b,f)}),xa(d,function(f,g){S(b,g,f)}))}function Th(b,a,c){b(c,function(d,e){return Lb(a,function(f){return g=c,h=d,l=e,m=f.name,
k=void 0!==f.condition?f.condition:Ra,q=void 0!==f.value?f.value:t.all(),t.matches(m,l)&&t.matches(q,h)&&k(g);var g,h,l,m,k,q})})}function Xb(b,a,c){var d,e=D.fromDom(b);switch(b.nodeType){case 1:a?d=Yb:(d=Qe,Wb(e,c||{}));var f=("HTML"!==b.scopeName&&b.scopeName&&b.tagName&&0>=b.tagName.indexOf(":")?b.scopeName+":"+b.tagName:b.tagName).toLowerCase();break;case 3:d=Kc;var g=b.nodeValue;break;case 8:d=Uh;g=b.nodeValue;break;default:console.log("WARNING: Unsupported node type encountered: "+b.nodeType)}return{getNode:z(b),
tag:function(){return f},type:function(){return d},text:function(){return g}}}function Vh(b,a,c,d){var e=d.createElement(b);return xa(a,function(f,g){e.setAttribute(g,f+"")}),Xb(e,!1,c)}function Lc(b,a){return Xb(a.createElement(b),!0)}function Nl(b){var a=b.createDocumentFragment(),c=a;return{dom:a,receive:function(d){switch(d.type()){case Qe:d=d.getNode().cloneNode(!1);c.appendChild(d);c=d;break;case Kc:d=b.createTextNode(d.text());c.appendChild(d);break;case Yb:d=c.parentNode;c=null===d?a:d;break;
case Uh:break;default:throw Error("Unsupported token type: "+d.type());}},label:"SERIALISER"}}function oa(b){return function(a){var c=Zb({styles:[],attributes:[],classes:[],tags:[]},b);G(ra("*",a),function(d){Th(Sh,c.styles,d);Th(Ml,c.attributes,d);G(c.classes,function(e){G(wc(d,"class")?(Ec(d)?function(f){f=f.dom.classList;for(var g=Array(f.length),h=0;h<f.length;h++){var l=f.item(h);null!==l&&(g[h]=l)}return g}:oh)(d):[],function(f){t.matches(e.name,f)&&we(d,f)})})});G(ra("*",a),function(d){Lb(c.tags,
la(Oe,d))&&Y(d)})}}function Ib(b){return function(a){var c=Zb({tags:[]},b);G(ra("*",a),function(d){Lb(c.tags,la(Oe,d))&&sd(d)})}}function Ea(b){return function(a){var c=Zb({tags:[]},b);G(ra("*",a),function(d){Sa(c.tags,la(Oe,d)).each(function(e){e.mutate(d)})})}}function Wh(b){return function(a){var c=a.dom.innerHTML;c=function(d,e,f){var g=Nl(d);e=function(h,l){var m=(l=void 0===l?window.document:l).createElement("div");l.body.appendChild(m);m.style.position="absolute";m.style.left="-10000px";m.innerHTML=
h;var k=m.firstChild||xd,q=[],p=!1;return{hasNext:function(){return void 0!==k},next:function(){var r=k,n=k,u=p;return!p&&r.firstChild?(q.push(r),k=r.firstChild):p=!p&&1===r.nodeType||(r.nextSibling?(k=r.nextSibling,!1):(k=q.pop(),!0)),n===xd||k||(l.body.removeChild(m),k=xd),n===xd?n:n?Xb(n,u):void 0}}}(e,d);for(d=function(h,l){for(var m=g,k=l.length-1;0<=k;k--)m=l[k](m,{},h);return m}(d,f);e.hasNext();)f=e.next(),d.receive(f);return g.dom}(ab(a).dom,c,b);Ie(a);a.dom.appendChild(c)}}function Re(b,
a,c){var d=D.fromTag("div",b.dom);Wb(d,{position:"fixed",left:"-100000px",top:"0px"});va(function(){var e=b.dom.body;if(null==e)throw Error("Body is not available yet");return D.fromDom(e)}(),d);d.dom.innerHTML=a;G(c,function(e){e(d)});a=d.dom.innerHTML;return Y(d),a}function Xh(b,a){return function(c){function d(g){c.receive(g)}function e(g,h,l){return Xb(h,void 0!==l?l:g.type()===Yb,{})}var f={emit:d,emitTokens:function(g){G(g,d)},receive:function(g){b(f,g,e)},document:window.document};return a(f),
f}}function Se(b,a){if(void 0===b||void 0===a)throw console.trace(),Error("brick");b.nextFilter.set(a)}function Ol(b,a,c,d){b=c.getCurrentListType();var e=c.getCurrentLevel()==d.level()?b:null,f=d.emblems();return Sa(f,function(g){return"ul"===g.tag||null!=e&&Yh(g,e,!0)}).orThunk(function(){return 0<f.length?w.some(f[0]):w.none()}).filter(function(g){if(g="ol"===g.tag)pa(["p"],a.tag())?(g=za(D.fromDom(a.getNode()),"class"),g=null!=g&&/^MsoHeading/.test(g)):g=1;return!g})}function Te(b,a,c){return{pred:b,
action:a,label:z(c)}}function Zh(b,a,c){function d(e,f,g){Sa(a,function(h){return h.pred(f,g)}).fold(z(c),function(h){return h.action})(e,f,g)}return d.toString=function(){return"Handlers for "+b},d}function Za(b,a){return{state:z(b),result:z(a)}}function yd(b,a){return{state:z(b),value:z(a)}}function Mc(b,a,c,d){return{level:z(b),type:z(a),types:z(c),items:z(d)}}function $h(b){var a=b.items().slice(0);if(0<a.length&&"p"!==a[a.length-1]){var c=a[a.length-1];return a[a.length-1]="p",yd(Mc(b.level(),
b.type(),b.types(),a),w.some(c))}return yd(b,w.none())}function ai(b,a,c){for(var d=[];a(b);){var e=c(b);b=e.state();d=d.concat(e.result())}return Za(b,d)}function bi(b,a,c){var d=a.start&&1<a.start?{start:a.start}:{},e=b.level()+1,f=b.types().concat([a]);c=[la(Vh,a.tag,d,c)];return Za(Mc(e,a,f,b.items()),c)}function ci(b){var a=b.types().slice(0),c=[la(Lc,a.pop().tag)];return Za(Mc(b.level()-1,a[a.length-1],a,b.items()),c)}function di(b,a,c){var d,e,f,g,h,l,m,k=a?null==(m=ja(D.fromDom(a.getNode()),
"margin-left"))||"0px"===m?{}:{"margin-left":m}:{"list-style-type":"none"};b=b.type()&&!Yh(b.type(),c)?Za((e=bi((d=ci(b)).state(),c,c.type?{"list-style-type":c.type}:{})).state(),d.result().concat(e.result())):Za(b,[]);d=[la(Vh,"li",{},k)];e=(f=b.state(),g=a&&a.tag(),h=f.items().slice(0),(l=void 0!==g&&"p"!==g?w.some(g):w.none()).fold(function(){h.push("p")},function(q){h.push(q)}),yd(Mc(f.level(),f.type(),f.types(),h),l));f=e.value().map(function(q){q=a.getNode();var p=Ra;return Sh(D.fromDom(q),
p),[z(a)]}).getOr([]);return Za(e.state(),b.result().concat(d).concat(f))}function ei(b){var a=la(Lc,"li");b=$h(b);var c=b.value().fold(function(){return[a]},function(d){return[la(Lc,d),a]});return Za(b.state(),c)}function zd(b){if(0===b.length)throw Error("Compose must have at least one element in the list");var a=b[b.length-1];b=ia(b,function(c){return c.result()});return Za(a.state(),b)}function Pl(b){b=ei(b);var a=ci(b.state());return zd([b,a])}function fi(b,a){return c=a,ai(b,function(d){return d.level()>
c},Pl);var c}function Ql(b,a,c,d){var e,f,g,h,l,m,k,q;b=b.level()>a?fi(b,a):Za(b,[]);var p=b.state().level()===a?(k=di((m=0<(l=b.state()).level()?ei(l):Za(l,[])).state(),c,d),zd([m,k])):(e=b.state(),g=(f=1<a?$h(e):yd(e,w.none())).value().map(function(r){return[la(Lc,r)]}).getOr([]),q=f.state(),Za((h=ai(q,function(r){return r.level()<a},function(r){return u=d,v=a,y=c,A=(n=r).level()===v-1&&u.type?{"list-style-type":u.type}:{},C=di((B=bi(n,u,A)).state(),B.state().level()==v?y:void 0,u),zd([B,C]);var n,
u,v,y,A,B,C})).state(),g.concat(h.result())));return zd([b,p])}function gi(b){for(var a=[];null!==b.nextNode();)a.push(D.fromDom(b.currentNode));return a}function Ad(b){b=Pe(b,["mso-list"],Pa)["mso-list"];return(b=null!=b&&/ level([0-9]+)/.exec(b))&&b[1]?w.some(parseInt(b[1],10)):w.none()}function Nc(b,a){var c,d,e,f=b.dom.textContent.trim();b=(c=hi[f]?[hi[f]]:[],d=a&&ii[f]?[ii[f]]:a?[{tag:"ul",variant:f}]:[],e=ia(Rl,function(g){if(g.regex.test(f)){var h=Zb,l=g.type;var m=(p=f).split(".");0===m.length?
m=p:(p=m[m.length-1],m=0===p.length&&1<m.length?m[m.length-2]:p);g=[h(l,(r=m,n=parseInt(r,10),isNaN(n)?{}:{start:n}),{variant:(k=g.type,q=f,Ue===k.variant?"("===q.charAt(0)?"()":")"===q.charAt(q.length-1)?")":".":k.variant)})]}else g=[];return g;var k,q,p,r,n}),N(c.concat(d).concat(e),function(g){return void 0!==g.variant?g:Zb(g,{variant:f})}));return 0<b.length?w.some(b):w.none()}function ji(b){return ye(b,function(a){return(Ha(a)?Pe(a,["mso-list"],Pa):{})["mso-list"]})}function Sl(b){G(function(a){var c=
w.none().fold(Tl,function(f){return function(g){return f(g.nodeValue)}});c.acceptNode=c;var d,e;return d=document.createTreeWalker(a.dom,NodeFilter.SHOW_COMMENT,c,!1),((e=lb().browser).isIE()||e.isEdge()?function(f){try{return gi(f)}catch(g){return[]}}:gi)(d)}(b),Y)}function Oc(b,a,c,d){S(b,"data-list-level",a);S(b,"data-list-emblems",JSON.stringify(c));Sl(b);G(d,Y);V(b,"style");V(b,"class")}function Ul(b){return Ad(a=b).bind(function(c){return xe(a,Bd).bind(function(d){return Nc(d,!0).map(function(e){return{mutate:function(){Oc(a,
c,e,[d])}}})})}).orThunk(function(){return Ad(c=b).bind(function(d){return xe(c,xb).bind(Tb).filter(ya("span")).bind(function(e){return Nc(e,Bd(e)).map(function(f){return{mutate:function(){Oc(c,d,f,[e])}}})})});var c}).orThunk(function(){return Ad(c=b).bind(function(d){return xe(c,xb).bind(Tb).filter(ya("span")).bind(function(e){return Nc(e,Bd(e)).map(function(f){return{mutate:function(){Oc(c,d,f,[e])}}})})});var c}).orThunk(function(){return"p"!==Z(c=b)?w.none():Ad(c).bind(function(d){return ji(c).bind(function(e){return Nc(e,
!1).map(function(f){return{mutate:function(){Oc(c,d,f,[bb(e).getOr(e)])}}})})});var c}).orThunk(function(){return"p"!==Z(c=b)?w.none():ji(c).bind(function(d){var e=bb(d).getOr(d);return Nc(d,Bd(e)).bind(function(f){return ka(c,"margin-left").bind(function(g){g=parseInt(g,10);return isNaN(g)?w.none():w.some(Math.max(1,Math.ceil(g/18)))}).map(function(g){return{mutate:function(){Oc(c,g,f,[e])}}})})});var c});var a}function Vl(b){return(xb(c=b)?(a="v:shape",w.from(c.dom.nodeValue).bind(function(d){var e=
d.indexOf("]>");d=function(f){try{return(new DOMParser).parseFromString(f,"text/html").body}catch(h){var g=document.implementation.createHTMLDocument("").body;return g.innerHTML=f,g}}("<div>"+d.slice(e+2,d.lastIndexOf("<!["))+"</div>");return ye(D.fromDom(d),function(f){return Z(f)===a})})):w.none()).map(function(d){var e,f,g=za(d,"o:spid");g=void 0===g?ma(d,"id").getOr(""):g;var h=D.fromTag("img");return Fb(h,"rtf-data-image"),S(h,"data-image-id",g.substr(7)),S(h,"data-image-type","code"),e={width:ka(d,
"width"),height:ka(d,"height")},f=h.dom,xa(e,function(l,m){l.fold(function(){Hc(f)&&f.style.removeProperty(m)},function(k){Ke(f,m,k)})}),h});var a,c}function Wl(b){if(ya("img")(b)){var a=za(b,"src");if(null!=a&&ca(a,"file://"))return b=D.fromDom(b.dom.cloneNode(!1)),a=a.split(/[\/\\]/),S(b,"data-image-id",a[a.length-1]),V(b,"src"),S(b,"data-image-type","local"),Fb(b,"rtf-data-image"),w.some(b)}return w.none()}function Ve(b){return function(a){ma(a,b.attrName).each(function(c){var d,e=null==b.styleName?
b.attrName:b.styleName;ka(a,e).isNone()&&(d=b.mapValue(c),sa(a,e,d));V(a,b.attrName)})}}function We(b){b=b.toString(16);return(1===b.length?"0"+b:b).toUpperCase()}function ki(b){return{value:We(b.red)+We(b.green)+We(b.blue)}}function Xe(b,a,c,d){return{red:b,green:a,blue:c,alpha:d}}function li(b,a,c,d){return Xe(parseInt(b,10),parseInt(a,10),parseInt(c,10),parseFloat(d))}function mi(b){return"currentcolor"===b||"transparent"===b?b:"#"+(a=pb(b,"#").toUpperCase(),(Xl.test(c=a)||Yl.test(c)?w.some({value:pb(a,
"#").toUpperCase()}):w.none()).orThunk(function(){if("transparent"===b)var d=w.some(Xe(0,0,0,0));else d=Zl.exec(b),null!==d?d=w.some(li(d[1],d[2],d[3],"1")):(d=$l.exec(b),d=null!==d?w.some(li(d[1],d[2],d[3],d[4])):w.none());return d.map(ki)}).getOrThunk(function(){var d=document.createElement("canvas");d.height=1;d.width=1;var e=d.getContext("2d");e.clearRect(0,0,d.width,d.height);e.fillStyle=b;e.fillRect(0,0,1,1);d=e.getImageData(0,0,1,1).data;return ki(Xe(d[0],d[1],d[2],d[3]))}).value);var a,c}
function ni(b,a){switch(a){case "color":return mi(b);case "font-family":return b.replace(/['"]/g,"");case "font-weight":a:switch(b){case "bold":b="700";break a;case "normal":b="400"}return b;default:return Ob(a,"-color")?mi(b):b.replace(/^0(pt|px|pc|in|cm|mm|Q|cap|ch|ic|em|ex|lh|rlh|rem|vw|vh|vb|vi|vmax|vmin|%)$/,"0")}}function Cd(b){return Ea({tags:[{name:t.exact(b.matchTag,t.caseInsensitive),mutate:function(a){qg(Me(a),b.key).exists(function(c){return pa(b.values,c)})&&(Be(a,D.fromTag(b.newTag)),
ha(a,b.key),fd(b.removeExtra)&&G(b.removeExtra,function(c){return ha(a,c),0}))}}]})}function oi(b,a){return ye(b,a).isSome()}function Pc(b,a){var c=D.fromTag(b);cb(a,c);G(a.dom.attributes,function(d){c.dom.setAttribute(d.name,d.value)});b=da(a);return Ma(c,b),Y(a),c}function am(b){var a=Pc("span",b),c={"font-size":{1:"8pt",2:"10pt",3:"12pt",4:"14pt",5:"18pt",6:"24pt",7:"36pt"}};xa({face:"font-family",size:"font-size",color:"color"},function(d,e){ma(a,e).each(function(f){var g=c[d];sa(a,d,void 0!==
g&&void 0!==g[f]?g[f]:f);V(a,e)})})}function bm(b){b=Pc("span",b);Fb(b,"ephox-limbo-transform");sa(b,"text-decoration","underline")}function Qc(b){b=Z(b);return"td"===b||"tr"===b||"col"===b||"th"===b}function Ye(b){b=b.dom.attributes;return null==b||0===b.length||1===b.length&&"style"===b[0].name}function pi(b,a){return function(c){return b(c).filter(function(d){return $b(c)&&a(d.dom.textContent||""," ")}).isSome()}}function qi(b,a,c){return{name:t.exact(b,t.caseInsensitive),condition:function(d){return wc(d,
a)},mutate:function(d){ma(d,a).each(function(e){S(d,c,e);V(d,a)})}}}function cm(b){var a="table thead tbody tfoot th tr td ul ol li".split(" "),c=Ze(b,xb),d=Sa(c,function(f){return U($e.get(f),"StartFragment")}),e=Sa(c,function(f){return U($e.get(f),"EndFragment")});d.each(function(f){e.each(function(g){var h,l=f,m=[];for(g=(h=Eh(f,0,g,0),D.fromDom(h.commonAncestorContainer));void 0!==g&&!Eb(g,b);)pa(a,Z(g))?l=g:m.push(g),g=bb(g).getOrUndefined();G(m,sd);G(ch(l),Y)});Y(f)});e.each(Y)}function ri(b,
a){return Fe.getOption(b).exists(function(c){return 0===a(c).length})}function si(b){return G(da(b),function(a){ri(a,zc)&&Y(a)})}function Dd(b){return b.browser.isIE()&&11<=b.browser.version.major}function dm(b,a){var c,d,e,f,g,h,l,m,k=a.merge,q=(d=(c=b.browser.isFirefox()||b.browser.isEdge())?Wl:Vl,e=!c,f=Dd(b)?ba:Wh([Xh(function(p,r){var n=d(D.fromDom(r.getNode())).fold(function(){return[r]},function(u){var v=r.type()===Yb,y=[Xb(u.dom,v)];return!v&&e&&y.push(Xb(u.dom,!0)),y});p.emitTokens(n)},ba)]),
{annotate:[a.type===Ba.Word?f:ba],local:[c?ba:em]});return eg([q.local,Dd(b)||a.type!==Ba.Word?[]:[fm],a.type===Ba.GoogleDocs?[gm]:[],q.annotate,(m=k?[]:a.cleanFilteredInlineElements,[hm,im,Ea({tags:ta([{name:"b",transform:{mutate:la(Pc,"strong")}},{name:"i",transform:{mutate:la(Pc,"em")}},{name:"u",transform:{mutate:bm}},{name:"s",transform:{mutate:la(Pc,"strike")}},{name:"font",transform:{mutate:am,debug:!0}}],function(p){return!pa(m,p.name)}).map(function(p){return ua({name:t.exact(p.name,t.caseInsensitive)},
p.transform)})})]),function(){if(a.type!==Ba.Word)return[];var p=[jm],r=Dd(b)?[]:km;return p.concat(r).concat([lm])}(),a.type===Ba.GoogleDocs?qc(qc(qc(qc([mm],nm),om),[function(p){var r=[],n={border:b.browser.isFirefox()?"medium none":"none","text-decoration":"none"},u=function(v,y){var A;Ue===y||(A=D.fromTag(Z(v)),va(y,A),r.push({me:v,fake:A}));G(ta(da(v),Ha),function(B){return u(B,v)})};u(p);G(N(r,function(v){var y=v.fake,A=v.me;v=og(Me(A),function(C,E){var H=ja(y,E);return ni(C,E)===ni(H,E)});
var B=og(n,function(C,E){return td(ka(A,E),C)});return{fake:y,me:A,toRemove:v,toPreserve:B}}),function(v){var y=v.me,A=v.toPreserve,B=v.fake;xa(v.toRemove,function(C,E){ha(y,E)});xa(A,function(C,E){sa(y,E,C)});Y(B)})},pm,qm]),a.type!==Ba.GoogleDocs||a.indentUseMargin?[]:[rm]):[],[sm],[tm],[um],[ti],(h=[ui,vm,wm],l=[ui,xm,Ib({tags:N(g=void 0===(g=a.cleanFilteredInlineElements)?[]:g,function(p){return{name:t.exact(p,t.caseInsensitive)}})}),ym],a.merge?h:l),[zm,Am,Bm,vi],[Cm],[Dm],[Em],[Fm],a.type===
Ba.Html&&a.merge?[Gm]:[],[Hm],[Im],Dd(b)&&a.type===Ba.Word?[Jm]:[],[wi],a.type===Ba.Word?[Km,Lm,Mm,Nm]:[],[Om],[Pm]])}function xi(b,a){void 0===a&&(a=2);a=Math.pow(10,a);return Math.ceil(Math.round(b*a)/a)}function yi(b,a,c,d,e){return g=a,h=c,l=d,m=e,(f=b).toCanvas().then(function(k){var q=f.getType(),p=g,r=h,n=tc(l,m);return n.getContext("2d").drawImage(k,-p,-r),fe(n,q)});var f,g,h,l,m}function Rc(b){return parseInt(b,10)}function zi(b){return b.isPx&&(b.cropWidth!==b.width||b.cropHeight!==b.height)}
function Qm(b,a){return function(c){return d=ja(a,"transform"),w.from(Ai.exec(d)).map(function(e){return Math.round(parseFloat(e[1])*(180/Math.PI))}).fold(function(){return L.resolve(c)},function(e){return g=e,(f=c).toCanvas().then(function(h){var l=f.getType(),m=(0>g?360+g:g)*Math.PI/180,k=h.width,q=h.height,p=Math.sin(m),r=Math.cos(m),n=xi(Math.abs(k*r)+Math.abs(q*p));p=xi(Math.abs(k*p)+Math.abs(q*r));r=tc(n,p);var u=r.getContext("2d");return u.translate(n/2,p/2),u.rotate(m),u.drawImage(h,-k/2,
-q/2),fe(r,l)}).then(function(h){return ha(a,"transform"),V(b,"width"),V(b,"height"),h});var f,g});var d}}function Rm(b,a,c){return Ag(b.dom).then((f=a,function(g){return h=f.width,l=f.height,k=h,q=l,(m=g).toCanvas().then(function(p){return Bi(p,k,q).then(function(r){return fe(r,m.getType())})});var h,l,m,k,q})).then((d=b,e=a,function(g){if(zi(e)){var h=-1*Rc(ja(d,"margin-top"));return yi(g,-1*Rc(ja(d,"margin-left")),h,e.cropWidth,e.cropHeight).then(function(l){return vc(d,{width:e.cropWidth,height:e.cropHeight}),
l})}return L.resolve(g)})).then(Qm(b,c)).then(function(g){g=g.toDataURL();return S(b,"src",g),L.resolve()});var d,e,f}function Sm(b){return bb(b).filter(ya("span")).map(function(a){function c(){ha(b,"margin-top");ha(b,"margin-left");ha(a,"width");ha(a,"height");ha(a,"overflow");ha(a,"display");var k=["transform"];Ha(a)&&Ha(b)&&G(k,function(q){ka(a,q).each(function(p){ka(b,q).isNone()&&sa(b,q,p)})});ha(a,"transform")}function d(k,q){return ma(k,q).map(Rc).filter(function(p){return!isNaN(p)}).getOr(0)}
var e,f,g,h,l,m=(e=ja(a,"width"),f=ja(a,"height"),g=d(b,"width"),h=d(b,"height"),{isPx:(l=/^\d+px$/).test(e)&&l.test(f),cropWidth:Rc(e),cropHeight:Rc(f),width:g,height:h});return(zi(m)||Ai.test(ja(a,"transform"))?Rm(b,m,a):L.resolve()).then(c,c)}).getOrThunk(function(){return L.resolve()})}function Ci(b,a){return dg(b,function(c){return c.start===a})}function Ed(b,a,c){return{element:b,start:a,finish:c}}function Fd(b){return ua(ua({},b),{isBoundary:function(){return b.fold(Tm,ac,ac,ac)},toText:function(){return b.fold(w.none,
w.none,function(a){return w.some(a)},w.none)},is:function(a){return b.fold(ac,ac,function(c,d){return d.eq(c,a)},ac)},len:function(){return b.fold(Um,Di,function(a,c){return c.property().getText(a).length},Di)}})}function Vm(b,a,c){var d,e=ia(c,function(g){return[g.start,g.finish]}),f=(d=function(g,h){return function(l,m,k){var q=l.property().getText(m);k=ta(function(r,n){if(0===n.length)return[r];var u=ob(n,function(v,y){if(0===y)return v;var A=r.substring(v.prev,y);return{prev:y,values:v.values.concat([A])}},
{prev:0,values:[]});n=n[n.length-1];return n<r.length?u.values.concat(r.substring(n)):u.values}(q,k),function(r){return 0<r.length});if(1>=k.length)return[Ed(m,0,q.length)];l.property().setText(m,k[0]);q=Ei(k.slice(1),function(r,n){r=Ed(l.create().text(r),n,n+r.length);return w.some(r)},k[0].length);var p=N(q,function(r){return r.element});return l.insert().afterAll(m,p),[Ed(m,0,k[0].length)].concat(q)}(b,g.element,h)},0===e.length?a:ia(a,function(g){var h,l,m=ia(e,function(k){return k>=g.start&&
k<=g.finish?[k-g.start]:[]});return 0<m.length?(h=d(g,m),l=g.start,N(h,function(k){return ua(ua({},k),{start:k.start+l,finish:k.finish+l})})):[g]}));return N(c,function(g){var h,l,m,k,q=N((h=g.start,l=g.finish,m=Ci(f,h),k=Ci(f,l),m.bind(function(p){var r=k.getOr(f[f.length-1]&&f[f.length-1].finish===l?f.length+1:-1);return-1<r?w.some(f.slice(p,r)):w.none()}).getOr([])),function(p){return p.element});h=N(q,b.property().getText).join("");return{elements:q,word:g.word,exact:h}})}function Wm(b){return!rh(b,
"a",void 0).isSome()}function Xm(b){var a;G((a={word:"__INTERNAL__",pattern:Ym(Zm)},$m(an,b,[a],void 0)),function(c){var d,e=c.exact;(0>e.indexOf("@")||bn(e))&&(d=c.elements,w.from(d[0]).filter(Wm).map(function(f){var g=D.fromTag("a");return cb(f,g),Ma(g,d),S(g,"href",g.dom.textContent),g}))})}function cn(b){G(b,function(a){Ha(a)&&ka(a,"position").isSome()&&ha(a,"position")})}function dn(b){var a,c,d,e=ta(b,ya("li"));0<e.length&&(a=ch(e[0]),c=D.fromTag("ul"),cb(b[0],c),0<a.length&&(d=D.fromTag("li"),
va(c,d),Ma(d,a)),Ma(c,e))}function Fi(b){var a=da(b);G([Xm,cn,dn],function(c){c(a)})}function en(b){return void 0!==b&&void 0!==b.types&&null!==b.types}function bc(b){return function(a){return{discriminator:b,data:a}}}function Sc(b){return function(a){return a.discriminator===b?w.some(a.data):w.none()}}function fn(b){return U(a=b,"<html")&&(U(a,'xmlns:o="urn:schemas-microsoft-com:office:office"')||U(a,'xmlns:x="urn:schemas-microsoft-com:office:excel"'))||U(b,'meta name="ProgId" content="Word.Document"');
var a}function gn(b){return U(b,'id="docs-internal-guid-')}function hn(b){return 0<b.length}function Gi(b,a){return Hi(b.types,a).map(function(c){return b.getData(c.type)}).filter(hn)}function af(b){return Gi(b,"html")}function jn(b){return af(b).filter(gn)}function cc(b){return kn?w.from(b.clipboardData).filter(en):w.none()}function Ii(b){var a=D.fromTag("div");b=Re(ab(a),b,[cm]);var c=ab(a).dom,d=D.fromDom(c.createDocumentFragment());return Ma(d,Ub(b,c)),Ie(a),va(a,d),ln({container:a})}function Ji(b){return N(b,
function(a){return a.asset})}function Ki(b,a,c){function d(g,h,l){e.trigger.block(!0);h=vb(b,function(p){return p.getAvailable(g).map(function(r){return Oh(p.steps,r,p.label,p.capture())})}).getOrThunk(function(){var p=a.getAvailable(g);return Oh(a.steps,p,a.label,a.capture())});h.capture&&l();var m,k;l=h.steps;l=(m=h.input,k=ob(l,function(p,r){return null!=p.then?p.then(function(n){return Qh(n,m,r)}):Qh(p,m,r)},{response:Oa([],[]),bundle:na({})}),null!=k.then?k:L.resolve(k));var q=mb.getLabelForApi(h.label);
l.then(function(p){var r=p.bundle.isInternal.getOr(!1),n=p.bundle.officeStyles.fold(z("auto"),function(u){return u?"merge":"clean"});e.trigger.block(!1);ud(p.response,function(u){e.trigger.error(u)},function(u,v){e.trigger.insert(u,Ji(v),v,r,q,n)},function(){e.trigger.cancel()},function(u,v,y){e.trigger.insert(u,Ji(v),v,r,q,n);e.trigger.error(y)})})}var e=Db({cancel:Ta([]),error:Ta(["message"]),insert:Ta("elements assets correlated isInternal source mode".split(" ")),block:Ta(["state"])}),f=Je(function(g){Gh(D.fromDom(Dc(D.fromDom(g.target)).dom.defaultView).dom).each(function(h){function l(p){return void 0===
p.items?w.none():(r=p.types,vb(mn,function(n){return Hi(r,n)}).map(function(n){n=[];for(var u=0;u<p.items.length;u++)n.push(p.items[u]);return nn({images:n})}));var r}function m(p){return vb(p.types,function(r){return"text/plain"===r?w.some(p.getData(r)).map(function(n){return bf({text:q.sanitizeText(n)})}):w.none()})}var k,q;rd(h.start,Li())||(void 0===(q=c)&&(q=Gd),k={getWordData:function(){return cc(g).bind(function(p){return af(p).filter(fn).map(function(r){var n=Gi(p,"rtf");return Mi({html:r,
rtf:n.fold(function(){return Ni()},function(u){return on(u)})})})})},getGoogleDocsData:function(){return cc(g).bind(jn).map(function(p){return q.sanitizeHtml(p,"googledocs")}).map(Ii)},getImage:function(){return cc(g).bind(l)},getText:function(){return cc(g).fold(function(){var p=window.clipboardData;return void 0!==p?w.some(bf({text:q.sanitizeText(p.getData("text"))})):w.none()},m)},getHtml:function(){return cc(g).bind(af).map(q.sanitizeHtml).map(Ii)},getOnlyText:function(){return cc(g).bind(function(p){return 1===
(r=p.types).length&&"text/plain"===r[0]?m(p):w.none();var r})},getNative:function(){return pn({nativeEvent:g})},getVoid:function(){return qn({})}},Oi()&&(f.control.block(),g.preventDefault()),d(k,f.control,function(){g.preventDefault()}))})});return{paste:f.instance,pasteCustom:function(g,h){d(g,Je(ba).control,void 0===h?ba:h)},isBlocked:f.control.isBlocked,destroy:ba,events:e.registry}}function rn(){var b=w.none();return{convert:function(a){b=Pi(a)},listen:function(a){b.getOrThunk(function(){return L.resolve([])}).then(a)},
clear:function(){b=w.none()}}}function Tc(b,a){return{asset:b,image:a}}function Qi(b,a){return La.cata(b,function(c,d,e){return S(a,"src",e),!0},Pa)}function cf(b,a){var c=[];return G(b,function(d,e){e=a[e];Qi(d,e)&&c.push(Tc(d,e))}),c}function Ri(b){return uc(b).toPromise()}function Si(b,a){return{asyncAsset:b.then(R.value,R.error),image:a}}function Ti(b){var a=D.fromTag("div");return Ma(a,b),ra("img[src]",a)}function Ui(b){return 0===b.indexOf("data:")&&-1<b.indexOf("base64")}function Vi(b){return ma(b,
"src").exists(function(a){return Ui(a)||0===a.indexOf("blob:")})}function sn(b){return ia(Ti(b),function(a){var c=ma(a,"src").getOr("");return Ui(c)?tn(c).map(function(d){return Si(Ri(d),a)}).toArray():0===c.indexOf("blob:")?w.from(0===c.indexOf("blob:")?Bg(c):0===c.indexOf("data:")?de(c):null).map(function(d){return Si(d.then(Ri),a)}).toArray():[]})}function Ei(b,a,c){return ob(b,function(d,e){return a(e,d.len).fold(z(d),function(f){return{len:f.finish,list:d.list.concat([f])}})},{len:c=void 0===
c?0:c,list:[]}).list}function un(b,a,c){var d,e,f;a=ia(a,function(g){return vn(b,g,c)});return ta((d=function(g){return g.match({boundary:function(){return Uc.excludeWithout(g)},empty:function(){return Uc.excludeWith(g)},text:function(){return Uc.include(g)},nonEditable:function(){return Uc.excludeWithout(g)}})},e=[],f=[],G(a,function(g){var h=d(g);Uc.cata(h,function(){f.push(g)},function(){0<f.length&&e.push(f);e.push([g]);f=[]},function(){0<f.length&&e.push(f);f=[]})}),0<f.length&&e.push(f),e),
function(g){return 0<g.length})}function df(b){return function(a,c){function d(){return L.resolve(c)}function e(f,g){return!1===b.allowLocalImages?(G(r=ta(Ti(q=f),Vi),Y),L.resolve({response:0<r.length?(p=ta(q,function(n){return!ya("img")(n)||!Vi(n)}),Jb(p,[],"errors.local.images.disallowed")):c.response,bundle:c.bundle})):0===g.length?(l=sn(h=f),m=L.all(N(l,function(n){return n.asyncAsset})),k=N(l,function(n){return n.image}),m.then(function(n){var u,v;n=(u=[],v=[],G(n,function(A){A.fold(function(B){u.push(B)},
function(B){v.push(B)})}),{errors:u,values:v});var y=cf(n.values,k);return{response:0<n.errors.length?Jb(h,y,"errors.imageimport.failed"):Oa(h,y),bundle:c.bundle}})):d();var h,l,m,k,q,p,r}return c.response.fold(wd,e,d,e)}}function Wi(b,a,c){return void 0===c&&(c=!1),new Ka(function(d){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&d({status:e.status,blob:e.response})};e.open("GET",b,!0);e.withCredentials=c;xa(a,function(f,g){e.setRequestHeader(g,f)});e.responseType="blob";
e.send()})}function Xi(b){var a="ImageProxy HTTP error: "+Sa(wn,function(c){return b===c.code}).fold(z("Unknown ImageProxy error"),function(c){return c.message});return Ka.reject(a)}function xn(b){return Sa(yn,function(a){return a.type===b}).fold(z("Unknown service error"),function(a){return a.message})}function zn(b){return a=b,(new Ka(function(c,d){var e=new FileReader;e.onload=function(){c(e.result)};e.onerror=function(f){d(f)};e.readAsText(a)})).then(function(c){try{var d=w.some(JSON.parse(c))}catch(e){d=
w.none()}c="ImageProxy Service error: "+d.bind(function(e){return f=ob(["error","type"],function(g,h){return null==g?void 0:g[h]},e),w.from(f).map(xn);var f}).getOr("Invalid JSON in service error message");return Ka.reject(c)});var a}function Yi(b){return 200>b||300<=b}function An(b,a,c){return void 0===c&&(c=!1),a?(g={"Content-Type":"application/json;charset=UTF-8","tiny-api-key":a},Wi((e=a,f=-1===(d=b).indexOf("?")?"?":"&",/[?&]apiKey=/.test(d)?d:d+f+"apiKey="+encodeURIComponent(e)),g).then(function(h){return Yi(h.status)?
(l=h.status,"application/json"!==(null==(m=h.blob)?void 0:m.type)||400!==l&&403!==l&&404!==l&&500!==l?Xi(l):zn(m)):Ka.resolve(h.blob);var l,m})):Wi(b,{},c).then(function(h){return Yi(h.status)?Xi(h.status):Ka.resolve(h.blob)});var d,e,f,g}function Bn(b,a){function c(){return L.resolve({response:a.response,bundle:a.bundle})}function d(g){return Zi(g).then(function(h){var l=sc("image");h=zg(g,h);var m=URL.createObjectURL(g);return La.blob(l,h,m)})}function e(g,h){return La.url(sc("image"),h,g)}function f(g,
h){var l=!1,m=ia(g,function(k){return ra("img",k)});return L.all(N(m,function(k){var q=k.dom.src,p=te(q);return U(p.host,"google")&&!ca(p.path,"/drawings/")?An(k.dom.src).then(d,function(){return l=!0,e(k,q)}):e(k,q)})).then(function(k){k=h.concat(cf(k,m));return{response:l?Jb(g,k,"errors.imageimport.failed"):Oa(g,k),bundle:a.bundle}},function(){return{response:vd("errors.imageimport.invalid"),bundle:a.bundle}})}return a.response.fold(c,f,c,f)}function $i(b){var a=b.isWord.getOr(!1);return a&&b.officeStyles.getOr(!0)||
!a&&b.htmlStyles.getOr(!1)}function ef(b){return b.isWord.getOr(!1)?Ba.Word:b.isGoogleDocs.getOr(!1)?Ba.GoogleDocs:Ba.Html}function ff(b,a){function c(g){return w.some(Zb(d,{officeStyles:g,gdocsStyles:g,htmlStyles:g}))}var d,e,f=(e=(d=a).translations,{get:function(g){var h=function(){switch(g){case Ba.Word:return"officeStyles";case Ba.GoogleDocs:return"gdocsStyles";default:return"htmlStyles"}}();h=d[h];return Ua(h)?h().then(function(l){return c("merge"===l)},function(l){return console.error(l),c(!1)}):
"clean"===h?L.resolve(c(!1)):"merge"===h?L.resolve(c(!0)):new L(function(l){var m=D.fromTag("div");Fb(m,Hd("styles-dialog-content"));var k=D.fromTag("p");Ma(k,Ub(e("cement.dialog.paste.instructions")));va(m,k);k={text:e("cement.dialog.paste.clean"),tabindex:0,className:Hd("clean-styles"),click:function(){p.destroy();l(c(!1))}};var q={text:e("cement.dialog.paste.merge"),tabindex:1,className:Hd("merge-styles"),click:function(){p.destroy();l(c(!0))}},p=b();p.setTitle(e("cement.dialog.paste.title"));
p.setContent(m);p.setButtons([k,q]);p.events.close.bind(function(){p.destroy();l(w.none())});p.show()})},destroy:ba});return function(g,h){var l=h.response;return f.get(ef(h.bundle)).then(function(m){return m.fold(function(){return{response:Id(),bundle:h.bundle}},function(k){return{response:l,bundle:na({officeStyles:k.officeStyles,gdocsStyles:k.gdocsStyles,htmlStyles:k.htmlStyles})}})})}}function aj(b,a){return function(c,d){return d.bundle.isInternal.getOr(!1)?L.resolve({response:d.response,bundle:na({officeStyles:!0,
gdocsStyles:!0,htmlStyles:!0})}):ff(b,a)(c,d)}}function Cn(b,a){if(!Le(b))throw Error("Internal error: attempted to write to an iframe that is not in the DOM");var c=function(d){d=d.dom;try{var e=d.contentWindow?d.contentWindow.document:d.contentDocument,f=D.fromDom;return null!=e?w.some(f(e)):w.none()}catch(g){return console.log("Error reading iframe: ",d),console.log("Error was: "+g),w.none()}}(b).getOrThunk(function(){return ab(b)}).dom;c.open("text/html","replace");c.writeln(a);c.close()}function gf(b,
a,c){function d(f){return-1!==f.selector.indexOf(",")}var e=ia(ta(b,d),function(f){return N(f.selector.split(","),function(g){return{selector:g.trim(),raw:f.raw}})});b=ta(b,function(f){return!d(f)}).concat(e);b.sort(function(f,g){return Dn.compare(f.selector,g.selector)}).reverse();b=ia(b,function(f){var g=ra(f.selector,a);return G(g,function(h){var l,m;Wb(h,(l=f.raw,m={},G(l,function(k){void 0!==l[k]&&(pa(h.dom.style,k)||(m[k]=l[k]))}),m))}),g});c&&G(b,function(f){V(f,"class")})}function bj(b,a,
c,d){gf(ia(Array.prototype.slice.call(b.dom.styleSheets),Jd).map(function(e){var f=e.selector;return{selector:c.hasOwnProperty(f)?c[f]:f,raw:e.raw}}),a,d)}function cj(b,a,c,d){gf(ta(ia(Array.prototype.slice.call(b.dom.styleSheets),Jd),function(e){return ca(e.selector,c)}),a,d)}function dj(b,a,c,d){gf(ta(ia(Array.prototype.slice.call(b.dom.styleSheets),Jd),function(e){return pa(c,e.selector)}),a,d)}function En(b){var a,c=(a=D.fromDom(document.body),{play:function(d,e,f){var g=D.fromTag("div"),h=D.fromTag("iframe");
Wb(g,{display:"none"});var l=Vb(h,"load",function(){var m;l.unbind();Cn(h,d);var k=null===(m=h.dom.contentWindow)||void 0===m?void 0:m.document;if(void 0===k)throw Error("sandbox iframe load event did not fire correctly");m=D.fromDom(k);k=m.dom.body;if(void 0===k)throw Error("sandbox iframe does not have a body");k=D.fromDom(k);m=e(m,k);Y(g);setTimeout(la(f,m),0)});va(g,h);va(a,g)}});return function(d){return new L(function(e){c.play(d,function(f,g){return h=f,l=g,m={mergeInline:z(b)},(k=m.mergeInline())&&
(Fn.inlineStyles(h,l,Gn),wi(l)),Hn(l,k),g.dom.innerHTML;var h,l,m,k},e)})}}function In(b,a,c,d){a=d.sanitizeHtml(a,"word");return En(b)(a).then(function(e){function f(m){return{response:Oa(g,m),bundle:na({})}}var g=Ub(e);e=D.fromTag("div");Ma(e,g);var h=ta(ra("img[src]",e),function(m){return ma(m,"src").exists(function(k){return ca(k,"blob:")||ca(k,"data:")})}),l=ra("img[data-image-src]",e);if(0===h.length&&0===l.length)return f([]);if(c)return G(h,function(m){return V(m,"id"),0}),L.all(N(h,function(m){var k=
m.dom;return Ag(k).then(function(q){return q.toBlob().then(function(p){return r=q,n=p,u=ca(k.src,"blob:")?k.src:URL.createObjectURL(n),v=sc("image"),Tc(La.blob(v,r,u),m);var r,n,u,v})})})).then(f);G(h,Y);G(l,Y);e=da(e);return{response:Jb(e,[],"errors.local.images.disallowed"),bundle:na({})}})}function ej(b){try{var a=b(),c=null!=a&&0<a.length?Ub(a):[];return R.value(c)}catch(d){return console.error("PowerPaste error code: PT01. Message: ",d),R.error("errors.paste.process.failure")}}function fj(b){return b.fold(Nh,
function(a){return{response:Oa(a,[]),bundle:na({})}})}function gj(b,a,c,d,e){return ej(function(){var f,g,h,l={type:d,merge:c,cleanFilteredInlineElements:null!==(f=e.cleanFilteredInlineElements)&&void 0!==f?f:[],indentUseMargin:null!==(g=e.indentUseMargin)&&void 0!==g&&g};return h=Jn,Fi(a),Re(b,a.dom.innerHTML,dm(h,l))})}function Kn(b){function a(e){return{response:Oa([e],[]),bundle:na({})}}return d=od(c=b,"img"),L.all(N(d,Sm)).then(function(){return c}).then(a).catch(function(){return a(b)});var c,
d}function hj(b,a,c,d,e,f){return gj(b,a,d,c,f).fold(wd,function(g){return e.then(function(h){var l,m;h=(l=[],m=ia(g,function(k){return ya("img")(k)?[k]:ra("img",k)}),G(h,function(k){La.cata(k,function(q,p,r){G(m,function(n){za(n,"src")===r&&l.push(Tc(k,n))})},ba)}),l);return{response:Oa(g,h),bundle:na({})}})})}function Ln(b,a){var c,d,e;b=((c=D.fromTag("div")).dom.textContent=b,c.dom.innerHTML);a=Ub(1===(d=N(ob(e=b.replace(/\t/g,0>=a?"":Array(a+1).join(" ")),function(f,g){-1!==" \f\t\v".indexOf(g)||
"\u00a0"===g?(!(g=f.pcIsSpace||""===f.str||f.str.length===e.length-1)&&(g=(h=f.str.length+1)<e.length&&0<=h)&&(h=e[h],g="\n"===h||"\r"===h),f=g?{pcIsSpace:!1,str:f.str+"\u00a0"}:{pcIsSpace:!0,str:f.str+" "}):f={pcIsSpace:"\n"===g||"\r"===g,str:f.str+g};return f;var h},{pcIsSpace:!1,str:""}).str.replace(/^[\r\n]*|[\r\n]*$/g,"").split(/(?:\r?\n){2}/),function(f){return f.split(/\n|\r\n/).join("<br />")})).length?d[0]:N(d,function(f){return"<p>"+f+"</p>"}).join(""));return Oa(a,[])}function ij(b){return function(a,
c){return d=b,{response:0<(e=Mn(a).getOrDie("Required text input for Text Handler")).text.length?Ln(e.text,d):Id(),bundle:na({})};var d,e}}function jj(b,a){function c(d,e){var f=D.fromTag("div");Ma(f,d);Fi(f);d=da(f);return{response:Oa(d,e),bundle:a.bundle}}b=z(a);return a.response.fold(b,c,b,c)}function kj(b,a,c){return function(d,e){var f=hf(d).getOrDie("Wrong input type for HTML handler").container,g=ab(a);d=e.bundle;return d.isInternal.getOr(!1)?fj(ej(function(){return Re(g,f.dom.innerHTML,[ti,
vi])})):(b(f),fj(gj(g,f,$i(d),ef(d),c)))}}function Nn(b,a,c){return function(d,e){var f=e.bundle;return f.proxyBin.fold(function(){return console.error("There was no proxy bin setup. Ensure you have run proxyStep first."),L.resolve({response:Id(),bundle:na({})})},function(g){var h=$i(f),l=ef(f),m=f.isInternal.getOr(!1),k=new L(function(p){f.backgroundAssets.fold(function(){p([])},function(r){r.listen(p)})}),q=ab(b);return m?function(p,r,n,u){var v=Ba.Html;r=r.findClipboardTags(da(n)).getOr([]);G(r,
Y);r=L.resolve([]);return hj(p,n,v,!0,r,u)}(q,a,g,c):hj(q,g,l,h,k,c)})}}function On(b,a){return Pn}function lj(b){return function(a,c){a=Lh(c.bundle,na(b));return{response:c.response,bundle:a}}}function Qn(b,a){return Kn(hf(b).getOrDie("Wrong input type for HTML handler").container)}function Rn(b,a){return oi(b,function(c){return Ha(c)&&ma(c,"style").exists(function(d){return-1<d.indexOf("mso-")})})}function Sn(b,a){var c;return 0<=(c=b.dom.innerHTML).indexOf("<o:p>")||a.browser.isEdge()&&0<=c.indexOf('v:shapes="')||
a.browser.isEdge()&&0<=c.indexOf("mso-")||0<=c.indexOf("mso-list")||0<=c.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal")||0<=c.indexOf("MsoListParagraphCxSpFirst")||0<=c.indexOf("<w:WordDocument>")}function mj(b,a,c,d,e,f,g){return-1===b||-1===a?w.none():w.some({start:b,end:a,bower:c,regex:d,idRef:e,isEquation:f,attrs:g})}function jf(b,a){if(-1===a)return a;var c=0,d=b.length;do{var e=b.indexOf("{",a),f=b.indexOf("}",a);if(e<f&&-1!==e?(a=e+1,++c):(f<e||0>e)&&-1!==f&&(a=f+1,--c),d<a||-1===f)return-1}while(0<
c);return a}function Tn(b,a,c,d,e){var f;a=b.substring(c,d);var g=b.indexOf("\\picscalex",c);return mj(c,d,a,/[^a-fA-F0-9]([a-fA-F0-9]+)\}$/,"i",e,(f=b.indexOf("\\bliptag",g),-1<g&&g<f?w.from(b.substring(g,f)):w.none()))}function Un(b,a,c,d,e){return mj(c,d,b.substring(c,d),/([a-fA-F0-9]{64,})(?:\}.*)/,"s",e,w.none())}function Vn(b){for(var a=[],c=function(){return b.length},d=function(f){var g,h,l,m,k,q=(g=f.bower,h=f.regex,l=f.isEquation,m=f.attrs,(null!==(k=/\\shplid(\d+)/.exec(g))?w.some(k[1]):
w.none()).map(function(p){var r=f.idRef+p;return(0<=g.indexOf("\\pngblip")?R.value("image/png"):0<=g.indexOf("\\jpegblip")?R.value("image/jpeg"):R.error("errors.imageimport.unsupported")).fold(function(n){return Kb.unsupported(r,n,l,m)},function(n){return((u=g.match(h))&&u[1]&&0==u[1].length%2?R.value(u[1]):R.error("errors.imageimport.invalid")).fold(function(v){return Kb.unsupported(r,v,l,m)},function(v){return Kb.supported(r,n,function(y,A){if(0===y.length)throw Error("Zero length content passed to Hex conversion");
for(var B=Array(y.length/2),C=0;C<y.length;C+=2){var E=y.substr(C,2);B[Math.floor(C/2)]=parseInt(E,16)}y=new Uint8Array(B);return new Blob([y],{type:A})}(v,n),l,m)});var u})}));return a=a.concat(q.toArray()),f.end},e=0;e<b.length;)e=Wn(b,e).fold(c,d);return a}function kf(b){return Kb.cata(b,function(a,c,d){return a},function(a,c,d,e,f){return a})}function lf(b){return Kb.cata(b,function(a,c,d){return d},function(a,c,d,e,f){return e})}function nj(b){return Kb.cata(b,function(a,c,d){return R.error(c)},
function(a,c,d,e,f){return R.value(d)})}function Xn(b,a){b=(new RegExp("\\\\pic"+a+"(\\-?\\d+)\\\\")).exec(b)[1];return parseInt(b,10)}function oj(b,a,c,d,e){var f=[],g=[],h=!1;return{blobs:ia(b,function(l,m){var k=za(l,"data-image-id");return V(l,"rtf-data-image"),V(l,"data-image-id"),V(l,"data-ms-equation"),e||V(l,"data-image-src"),"unsupported"===k?(h=!0,S(l,"alt",c("errors.imageimport.unsupported")),[]):Sa(a,function(q,p){return d(q,p,k,m)}).fold(function(){return console.log("WARNING: unable to find data for image ",
l.dom),h=!0,S(l,"alt",c("errors.imageimport.unsupported")),[]},function(q){return nj(q).fold(function(p){return h=!0,console.error("PowerPaste error code: RTF04"),S(l,"alt",c(p)),[]},function(p){return f.push(l),g.push(Kb.cata(q,function(r,n,u){return w.none()},function(r,n,u,v,y){return y})),e&&V(l,"data-image-src"),[p]})})}),filteredImages:f,imageAttrs:g,failedImage:h}}function Yn(b,a,c,d,e){a=ob(a,function(k,q){var p=kf(q),r=lf(q);return dg(k,function(n){return!r&&!lf(n)&&kf(n)===p}).fold(function(){return k.concat([q])},
function(n){return nj(k[n]).isValue()?k:k.slice(0,n).concat(k.slice(n+1)).concat([q])})},[]);e=e.keepSrc||!1;var f=cg(a,function(k){return!lf(k)});a=f.pass;f=f.fail;var g=cg(b,function(k){return"true"!==za(k,"data-ms-equation")});b=g.fail;a=oj(g.pass,a,d,function(k,q,p,r){return kf(k)===p},e);d=oj(b,f,d,function(k,q,p,r){return q===r},e);var h=a.filteredImages.concat(d.filteredImages),l=a.imageAttrs.concat(d.imageAttrs);e=a.blobs.concat(d.blobs);var m=a.failedImage||d.failedImage;rc(N(e,uc)).get(function(k){(k.length===
l.length?L.all(N(k,function(q,p){return r=q,l[p].fold(function(){return L.resolve(r)},function(n){return La.cata(r,function(u,v,y){return v.toCanvas().then(function(A){var B,C,E,H,I,Q,T,O=D.fromDom(A);A=ma(O,"width").map(function(W){return parseInt(W,10)}).getOr(1);O=ma(O,"height").map(function(W){return parseInt(W,10)}).getOr(1);var M=(H=(C=(B=la(Xn,n))("wgoal"))/A,I=(E=B("hgoal"))/O,{cropl:(Q=B("cropl"))/H,cropt:(T=B("cropt"))/I,cropw:(C-Q-B("cropr"))/H,croph:(E-T-B("cropb"))/I});return A===M.cropw&&
O===M.croph&&0===M.cropl&&0===M.cropt?L.resolve(r):yi(v,M.cropl,M.cropt,M.cropw,M.croph).then(function(W){return W.toBlob().then(function(ea){URL.revokeObjectURL(y);ea=URL.createObjectURL(ea);return La.blob(u,W,ea)})})})},function(u,v,y){return L.resolve(r)})});var r})):L.resolve(k)).then(function(q){q=cf(q,h);c(q,m)})})}function Zn(b){return function(a,c){return new L(function(d,e){function f(k){return d({response:k,bundle:na({})})}function g(k){function q(){return L.resolve(c)}function p(r,n){var u=
D.fromTag("div");return Ma(u,r),k.fold(function(){var v=ra("[rtf-data-image]",u);if(0<v.length){G(v,Y);var y=da(u);v=(console.error("PowerPaste error code: RTF03"),f(Jb(y,n,"errors.imageimport.failed")))}else v=(y=da(u),f(Oa(y,n)));return v},function(v){m.processRtf(u,n,v,b)})}return c.response.fold(q,p,q,p)}var h,l,m=(h=b.translations,{events:(l=Db({insert:Ta(["elements","correlated"]),incomplete:Ta(["elements","correlated","message"])})).registry,processRtf:function(k,q,p,r){p=Vn(p.replace(/\r/g,
"").replace(/\n/g,""));Yn(ra("[rtf-data-image]",k),p,function(n,u){var v=da(k);n=n.concat(q);u?(console.error("PowerPaste error code: RTF01"),l.trigger.incomplete(v,n,"errors.imageimport.failed")):l.trigger.insert(v,n)},h,r)}});m.events.insert.bind(function(k){f(Oa(k.elements,k.correlated))});m.events.incomplete.bind(function(k){console.error("PowerPaste error code: RTF02");f(Jb(k.elements,k.correlated,k.message))});(function(k,q){var p=Va(q);if(p.length!==$n.length)throw Error("Partial match");vb(p,
function(r){return k.discriminator===r?w.some(q[r]):w.none()}).getOrDie("Must find branch for constructor: "+k.discriminator)(k.data)})(pj(a).getOrDie("Word input required for rtf data").rtf,{disabled:function(){g(w.none())},fromClipboard:function(k){g(!0===b.allowLocalImages?w.some(k.rtf):w.none())}})})}}function ao(b){function a(){return L.resolve(b)}return La.cata(b.asset,function(c,d,e){return/tiff$/.test(d.getType())?Cg(d,"image/png").then(function(f){return uc(f).toPromise()}).then(w.some).catch(function(f){return console.warn(f),
w.none()}).then(function(f){return f.map(function(g){var h=b.image;return URL.revokeObjectURL(e),Qi(g,h),Tc(g,h)}).getOr(b)}):a()},a)}function Vc(b,a){function c(d,e){return L.all(N(d,ao)).then(function(f){return{response:e(f),bundle:a.bundle}})}return ud(a.response,wd,function(d,e){return c(e,function(f){return Oa(d,f)})},function(){return L.resolve(a)},function(d,e,f){return c(e,function(g){return console.error("PowerPaste error code:  IMG01"),Jb(d,g,f)})})}function bo(b,a){return b.isSupported?
a.getWordData():w.none()}function co(b){return b.getNative()}function eo(b){return b.getImage()}function fo(b){return b.getHtml()}function go(b){return b.getText()}function ho(b){return b.getOnlyText()}function io(b){return b.getGoogleDocsData()}function jo(b){return b.getVoid()}function dc(b,a,c,d){return{label:b,getAvailable:a,steps:c,capture:z(d)}}function qj(b,a,c,d){return{label:b,getAvailable:a,steps:c,capture:z(d)}}function ko(b,a,c){return dc(mb.msoffice,la(bo,b),[lj({isWord:!0}),ff(a,c),
(d=b,function(f,g){var h,l,m;f=pj(f).getOrDie("Wrong input type for Word Import handler");return h=g.bundle.officeStyles.getOr(!0),l=e,m=f.html,d.cleanDocument(m,h,l).then(function(k){if(null==k||0===k.length)return{response:Oa([],[]),bundle:na({})};var q=void 0===l.sanitizer?ge(l.intraFlag.isMarked):l.sanitizer;return In(h,k,l.allowLocalImages,q)},function(k){return console.error("PowerPaste error code: WIM01"),{response:vd("errors.paste.process.failure"),bundle:na({})}})}),Zn(e=c),Vc],!0);var d,
e}function lo(b){return dc(mb.image,eo,[!1===b.allowLocalImages?function(a,c){return wd("errors.local.images.disallowed")}:function(a,c){a=mo(a).getOrDie("Must have image data for images handler");return rc(N(ob(ta(a.images,function(d){return"file"===d.kind&&/image/.test(d.type)}),function(d,e){e=e.getAsFile();return null!==e?d.concat(e):d},[]),uc)).toPromise().then(function(d){var e,f;return{response:(e=[],f=[],G(d,function(g){return La.cata(g,function(h,l,m){h=D.fromTag("img");S(h,"src",m);e.push(h);
f.push(Tc(g,h))},function(h,l,m){console.error("Internal error: Paste operation produced an image URL instead of a Data URI: ",l)})}),Oa(e,f)),bundle:na({})}})},Vc],!0)}function rj(b){return dc(mb.text,go,[ij(void 0===b?4:b),jj],!0)}function no(b,a,c,d,e){var f,g,h,l=oo(e=void 0===e?po:e,d.baseUrl,d.cacheSuffix),m=Gl(void 0!==d.pasteBinAttrs?d.pasteBinAttrs:{});e=void 0===d.sanitizer?ge(d.intraFlag.isMarked):d.sanitizer;var k=lb().browser.isIE();return Ki(qc([(f=w.from(d.tabSpaces).getOr(4),dc(mb.plaintext,
ho,[ij(f),jj],!0)),ko(l,a,d),dc(mb.googledocs,io,[lj({isGoogleDocs:!0}),ff(a,d),Qn,kj(c,b,d),Bn,df(d),Vc],!0),dc(mb.native,fo,[(h=d.intraFlag,function(q,p){q=hf(q).getOrDie("Wrong input type for HTML handler");q=h.findClipboardTags(da(q.container));q.each(function(r){G(r,Y)});q=q.isSome();return{response:p.response,bundle:na({isInternal:q})}}),aj(a,d),kj(c,b,d),df(d),Vc],!0),lo(d)],k?[]:[rj(d.tabSpaces)]),qj(mb.fallback,co,[(g=d.intraFlag,function(q,p){var r=qo(q).getOrDie("Must pass through event type").nativeEvent,
n=rn(),u=p.response;return new L(function(v,y){y=m(b);y.events.after.bind(function(A){var B,C,E,H,I,Q,T;A=A.container;mf.browser.isSafari()&&Ae(A,'img[src^="webkit-fake-url"]').isSome()?(B=mf.deviceType.isWebView()?"webview.imagepaste":"safari.imagepaste",v({response:vd(B),bundle:na({})})):(c(A),Fb(A,ro()),C=((T=(Q=mf).browser).isIE()&&11<=T.version.major?Rn:Sn)(A,Q),E=Lb(ra("*[id]",A),function(O){return ma(O,"id").exists(function(M){return ca(M,"docs-internal-guid-")})}),H=da(A),I=g.findClipboardTags(H).isSome(),
v({response:u,bundle:na({isWord:C,isGoogleDocs:E,isInternal:I,proxyBin:A,backgroundAssets:n})}))});n.convert(r);y.run()})}),aj(a,d),Nn(b,d.intraFlag,d),df(d),Vc],!1),e)}function so(){var b={},a={};tinymce.Resource={add:function(c,d){a[c]&&(a[c](d),delete a[c]);b[c]=L.resolve(d)},load:function(c,d){var e='Script at URL "'+d+'" failed to load',f='Script at URL "'+d+"\" did not call `tinymce.Resource.add('"+c+"', data)` within 1 second";if(void 0!==b[c])return b[c];var g=new L(function(h,l){var m=function(k,
q,p){function r(y){return function(){for(var A=[],B=0;B<arguments.length;B++)A[B]=arguments[B];n||(n=!0,null!==u&&(clearTimeout(u),u=null),y.apply(void 0,A))}}void 0===p&&(p=1E3);var n=!1,u=null;k=r(k);var v=r(q);return{reject:v,resolve:k,start:function(){for(var y=[],A=0;A<arguments.length;A++)y[A]=arguments[A];n||(u=setTimeout(function(){return v.apply(void 0,y)},p))}}}(h,l);a[c]=m.resolve;tinymce.ScriptLoader.loadScripts([d],function(){return m.start(f)},function(){return m.reject(e)})});return b[c]=
g}}}function sj(b,a,c,d){a:{var e=b.clipboardData,f=a.html,g=a.text;if(!1===tinymce.Env.iOS&&"function"==typeof(null==e?void 0:e.setData))try{var h=(e.clearData(),e.setData("text/html",f),e.setData("text/plain",g),e.setData(tj(),f),1);break a}catch(l){h=void 0;break a}h=void 0}h?(b.preventDefault(),d()):c(a.html,d)}function uj(b){return function(a,c){var d=b.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"});a=b.dom.create("div",{contenteditable:"true","data-mce-bogus":"all"},a);b.dom.setStyles(d,
{position:"fixed",top:"50%",left:"-3000px",width:"1000px",overflow:"hidden"});d.appendChild(a);b.dom.add(b.getBody(),d);var e=b.selection.getRng();a.focus();var f=b.dom.createRng();f.selectNodeContents(a);b.selection.setRng(f);setTimeout(function(){var g;b.selection.setRng(e);null!==(g=d.parentNode)&&void 0!==g&&g.removeChild(d);c()},0)}}function vj(b){var a=b.selection.getContent({contextual:!0}).replace(/ contenteditable="([^"]+)"/g,' data-mce-contenteditable="$1"');return{html:ie+a,text:b.selection.getContent({format:"text"})}}
function wj(b){return!b.selection.isCollapsed()||null!==(a=b).dom.getParent(a.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",a.getBody());var a}function xj(b){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(b)}function yj(b){var a=/^<a href="([^"]+)">([^<]+)<\/a>$/.exec(b);return w.from(a).bind(function(c){var d={url:c[1],html:b};return c[1]===c[2]?w.some(d):w.none()})}function zj(b,a,c){return"extra"in b.undoManager?(b.undoManager.extra(function(){b.insertContent(a,{merge:ae(b),
paste:!0});w.some(!0)},c),w.some(!0)):w.none()}function to(b,a){return yj(a).bind(function(c){return!1===b.selection.isCollapsed()&&xj(c.url)?zj(b,c.html,function(){b.execCommand("mceInsertLink",!1,c.url)}):w.none()})}function uo(b,a){return yj(a).bind(function(c){return f=c.url,g=lg(b),xj(h=f.toLowerCase())&&Lb(g,function(l){return Ob(h,"."+l.toLowerCase())})?zj(d=b,(e=c).html,function(){d.insertContent('<img src="'+e.url+'">')}):w.none();var d,e,f,g,h})}function vo(b,a,c,d,e,f){function g(r,n,u){var v=
r.getParam("smart_paste",!0,"boolean")?[to,uo]:[];vb(v.concat([function(y,A){return y.undoManager.transact(function(){y.insertContent(A,{merge:ae(y),paste:!0});w.some(!0);G(N(y.getBody().getElementsByTagName("*"),D.fromDom),function(B){wc(B,"data-mce-style")&&!wc(B,"style")&&ma(B,"data-mce-style").each(function(C){return S(B,"style",C)})});e.prepareImages(u)}),w.some(!0)}]),function(y){return y(r,n)})}function h(){m.on(function(r){return b.selection.moveToBookmark(r)});m.clear()}var l=yh(function(r){return r.unbind()}),
m=De(),k=(d?d.jsUrl:c).replace(/\/$/,"")+"/"+"/js".replace(/^\//,""),q=Mg(b),p=b.getParam("paste_tab_spaces",4,"number");b.on("init",function(){var r,n,u={baseUrl:k,cacheSuffix:b.getParam("cache_suffix"),officeStyles:jg(b),htmlStyles:kg(b),gdocsStyles:Zd(b,"powerpaste_googledocs_import","prompt"),translations:gb,allowLocalImages:b.getParam("powerpaste_allow_local_images",!0,"boolean"),pasteBinAttrs:{"data-mce-bogus":"all",class:"mce-pastebin"},intraFlag:{isMarked:he,findClipboardTags:function(B){B=
ta(B,function(C){return xb(C)&&U($e.get(C),tj())});return B.length?w.some(B):w.none()}},keepSrc:b.getParam("powerpaste_keep_unsupported_src",!1,"boolean"),cleanFilteredInlineElements:(r=b.getParam("powerpaste_clean_filtered_inline_elements"),fb(r)?N(r.split(","),function(B){return B.trim()}):[]),indentUseMargin:b.getParam("indent_use_margin",!1),sanitizer:q,tabSpaces:p};r=f?{createDialog:function(){function B(){T.trigger.close()}var C,E,H="",I=De(),Q=(C=sb([{text:"Close",name:"close",type:"custom",
primary:!0}]),E=sb({}),{setButtons:function(O){var M={};O=N(O,function(W){var ea=W.text;return M[ea.toLowerCase()]=W.click,{text:ea,name:ea.toLowerCase(),type:"custom"}});E.set(M);C.set(O)},getButtons:C.get,getAction:function(O){var M=E.get();return wb(M,O)?w.some(M[O]):w.none()}}),T=Db({close:Ta([])});return{events:T.registry,setTitle:function(O){return H=O},setContent:function(O){return I.set(O)},setButtons:function(O){Q.setButtons(O)},show:function(){I.on(function(O){O=jd(O.dom);O={title:H,body:{type:"panel",
items:[{type:"htmlpanel",html:O}]},initialData:{},buttons:Q.getButtons(),onCancel:B,onAction:function(M,W){Q.getAction(W.name).each(yk);M.close()}};b.windowManager.open(O)})},hide:ba,destroy:function(){I.clear()},reflow:ba}}}:{createDialog:function(){function B(){O.trigger.close()}function C(){E.off("close",B);E.close("close")}var E,H="",I=[],Q=[],T=De(),O=Db({close:Ta([])});return{events:O.registry,setTitle:function(M){H=M},setContent:function(M){I=[{type:"container",html:jd(M.dom)}];T.set(M)},setButtons:function(M){var W=
[];M.forEach(function(ea){W.push({text:ea.text,ariaLabel:ea.text,onclick:ea.click})});Q=W},show:function(){0===Q.length&&(Q=[{text:"Close",onclick:function(){E.close()}}]);E=b.windowManager.open({title:H,spacing:10,padding:10,minWidth:300,minHeight:100,layout:"flex",items:I,buttons:Q});var M=D.fromDom(E.getEl());T.on(function(W){var ea=Ae(M,"."+za(W,"class")).getOrDie("We must find this element or we cannot continue");cb(ea,W);Y(ea)});E.on("close",B)},hide:function(){C()},destroy:function(){C()},
reflow:ba}}};var v=D.fromDom(b.getBody()),y=no(v,r.createDialog,ba,u,wo),A=(n=q,Ki([rj(p)],qj(mb.discard,jo,[On],!0),n=void 0===q?Gd:n));G([y,A],function(B){B.events.cancel.bind(function(){h()});B.events.error.bind(function(C){h();b.notificationManager?b.notificationManager.open({text:gb(C.message),type:"error"}):(f?xo:wh).showDialog(b,gb(C.message))});B.events.insert.bind(function(C){var E=N(C.elements,function(H){return jd(H.dom)}).join("").replace(/ data-mce-contenteditable="([^"]+)"/g,' contenteditable="$1"');
b.focus();e.importImages(C.assets).get(function(){h();g(b,$g(b,E,C.isInternal,C.source,C.mode),C.assets);ig(b)&&e.uploadImages(C.assets)})});Xd(tinymce,"5.7.0")||B.events.block.bind(function(C){b.setProgressState(C.state)})});b.addCommand("mceInsertClipboardContent",function(B,C){var E,H,I,Q;void 0!==C.content?y.pasteCustom((I=C.content,Q=void 0===q?Gd:q,{getWordData:function(){return w.some(Mi({html:Q.sanitizeHtml(I),rtf:Ni()}))},getGoogleDocsData:w.none,getImage:w.none,getHtml:w.none,getText:w.none,
getNative:pc("There is no native event"),getOnlyText:w.none,getVoid:pc("There is no paste event")})):void 0!==C.text&&A.pasteCustom((E=C.text,H=void 0===q?Gd:q,{getWordData:w.none,getGoogleDocsData:w.none,getImage:w.none,getHtml:w.none,getText:function(){return w.some(bf({text:H.sanitizeText(E)}))},getNative:pc("There is no native event"),getOnlyText:w.none,getVoid:pc("There is no paste event")}))});n=Vb(v,"paste",function(B){var C;b.readonly||(C=B.raw,(yo?w.from(C.clipboardData).bind(function(E){return w.from(E.getData("text/html"))}):
w.none()).bind(function(E){return U(E,"<google-sheets-html-origin")?w.some("googlesheets"):U(I=E," data-ccp-props=")&&U(I," paraid=")&&/font-family:.+?_MSFontService(&quot;)?[,;]/.test(I)?w.some("mswordonline"):U(H=E,"<meta name=ProgId content=Excel.Sheet>")&&!U(H,'="urn:schemas-microsoft-com:office:')?w.some("msexcelonline"):w.none();var H,I}).each(function(E){b.fire("PowerPasteTempStats",{source:E})}),m.isSet()||m.set(b.selection.getBookmark(1)),(a.isText()?A:y).paste(B.raw),a.reset())});l.set(n);
b.on("cut",function(B){wj(b)&&sj(B,vj(b),uj(b),function(){var C,E=lb().browser;E.isChrome()||E.isFirefox()?(C=b.selection.getRng(),tinymce.util.Delay.setEditorTimeout(b,function(){b.selection.setRng(C);b.execCommand("Delete")},0)):b.execCommand("Delete")})});b.on("copy",function(B){wj(b)&&sj(B,vj(b),uj(b),ba)})});b.on("remove",function(){l.clear()})}function zo(b,a){function c(){var f=!d.get();d.set(f);b.fire("PastePlainTextToggle",{state:f});b.focus()}var d=sb(b.getParam("paste_as_text",!1,"boolean")),
e=sb(!1);b.on("keydown",function(f){tinymce.util.VK.metaKeyPressed(f)&&86===f.keyCode&&f.shiftKey&&(e.set(!0),tinymce.Env.ie&&10>tinymce.Env.ie&&(f.preventDefault(),b.fire("paste",{})))});return{buttonToggle:function(f){var g=!d.get();a?f.setActive(g):this.active(g);c()},toggle:c,reset:function(){e.set(!1)},isText:function(){return e.get()||d.get()}}}var Ue,fb=Ud("string"),Kl=Ud("object"),fd=Ud("array"),Gk=Vd("boolean"),Ua=Vd("function"),Hk=Vd("number"),Pa=z(!1),Ra=z(!(Ue=void 0)),ed={fold:function(b,
a){return b()},isSome:Pa,isNone:Ra,getOr:wa,getOrThunk:bg,getOrDie:function(b){throw Error(b||"error: getOrDie called on none.");},getOrNull:z(null),getOrUndefined:z(void 0),or:wa,orThunk:bg,map:Yd,each:ba,bind:Yd,exists:Pa,forall:Ra,filter:function(){return ed},toArray:function(){return[]},toString:z("none()")},nf=function(b){function a(){return e}function c(f){return f(b)}var d=z(b),e={fold:function(f,g){return g(b)},isSome:Ra,isNone:Pa,getOr:d,getOrThunk:d,getOrDie:d,getOrNull:d,getOrUndefined:d,
or:a,orThunk:a,map:function(f){return nf(f(b))},each:function(f){f(b)},bind:c,exists:c,forall:c,filter:function(f){return f(b)?e:ed},toArray:function(){return[b]},toString:function(){return"some("+b+")"}};return e},w={some:nf,none:Yd,from:function(b){return null==b?ed:nf(b)}},il=Array.prototype.slice,zk=Array.prototype.indexOf,Ak=Array.prototype.push,ua=function(){return(ua=Object.assign||function(b){for(var a,c=1,d=arguments.length;c<d;c++)for(var e in a=arguments[c])Object.prototype.hasOwnProperty.call(a,
e)&&(b[e]=a[e]);return b}).apply(this,arguments)},Va=Object.keys,Ao=Object.hasOwnProperty,Bk=function(b,a){var c={};return xa(b,function(d,e){d=a(d,e);c[d.k]=d.v}),c},wb=function(b,a){return Ao.call(b,a)},Bo=Wa([{blob:["id","imageresult","objurl"]},{url:["id","url","raw"]}]),La=ua({cata:function(b,a,c){return b.fold(a,c)}},Bo),Aj={},of={exports:Aj};(function(b){"object"==typeof Aj&&void 0!==of?of.exports=b():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?
self:this).EphoxContactWrapper=b()})(function(){return function e(a,c,d){function f(l,m){if(!c[l]){if(!a[l]){if(g)return g(l,!0);m=Error("Cannot find module '"+l+"'");throw m.code="MODULE_NOT_FOUND",m;}m=c[l]={exports:{}};a[l][0].call(m.exports,function(k){return f(a[l][1][k]||k)},m,m.exports,e,a,c,d)}return c[l].exports}for(var g=!1,h=0;h<d.length;h++)f(d[h]);return f}({1:[function(a,c,d){function e(){throw Error("setTimeout has not been defined");}function f(){throw Error("clearTimeout has not been defined");
}function g(y){if(q===setTimeout)return setTimeout(y,0);if((q===e||!q)&&setTimeout)return q=setTimeout,setTimeout(y,0);try{return q(y,0)}catch(A){try{return q.call(null,y,0)}catch(B){return q.call(this,y,0)}}}function h(){u&&r&&(u=!1,r.length?n=r.concat(n):v=-1,n.length&&l())}function l(){if(!u){var y=g(h);u=!0;for(var A=n.length;A;){r=n;for(n=[];++v<A;)r&&r[v].run();v=-1;A=n.length}r=null;u=!1;(function(B){if(p===clearTimeout)return clearTimeout(B);if((p===f||!p)&&clearTimeout)return p=clearTimeout,
clearTimeout(B);try{p(B)}catch(C){try{return p.call(null,B)}catch(E){return p.call(this,B)}}})(y)}}function m(y,A){this.fun=y;this.array=A}function k(){}a=c.exports={};try{var q="function"==typeof setTimeout?setTimeout:e}catch(y){q=e}try{var p="function"==typeof clearTimeout?clearTimeout:f}catch(y){p=f}!0;var r,n=[],u=!1,v=-1;a.nextTick=function(y){var A=Array(arguments.length-1);if(1<arguments.length)for(var B=1;B<arguments.length;B++)A[B-1]=arguments[B];n.push(new m(y,A));1!==n.length||u||g(l)};
m.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=k;a.addListener=k;a.once=k;a.off=k;a.removeListener=k;a.removeAllListeners=k;a.emit=k;a.prependListener=k;a.prependOnceListener=k;a.listeners=function(y){return[]};a.binding=function(y){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(y){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},
{}],2:[function(a,c,d){!function(e){function f(){}function g(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];p(n,this)}function h(n,u){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,g._immediateFn(function(){var v=1===n._state?u.onFulfilled:u.onRejected;if(null!==v){try{var y=v(n._value)}catch(A){return void m(u.promise,
A)}l(u.promise,y)}else(1===n._state?l:m)(u.promise,n._value)})):n._deferreds.push(u)}function l(n,u){try{if(u===n)throw new TypeError("A promise cannot be resolved with itself.");if(u&&("object"==typeof u||"function"==typeof u)){var v=u.then;if(u instanceof g)return n._state=3,n._value=u,void k(n);if("function"==typeof v)return void p((y=v,A=u,function(){y.apply(A,arguments)}),n)}n._state=1;n._value=u;k(n)}catch(B){m(n,B)}var y,A}function m(n,u){n._state=2;n._value=u;k(n)}function k(n){2===n._state&&
0===n._deferreds.length&&g._immediateFn(function(){n._handled||g._unhandledRejectionFn(n._value)});for(var u=0,v=n._deferreds.length;u<v;u++)h(n,n._deferreds[u]);n._deferreds=null}function q(n,u,v){this.onFulfilled="function"==typeof n?n:null;this.onRejected="function"==typeof u?u:null;this.promise=v}function p(n,u){var v=!1;try{n(function(y){v||(v=!0,l(u,y))},function(y){v||(v=!0,m(u,y))})}catch(y){v||(v=!0,m(u,y))}}var r=setTimeout;g.prototype.catch=function(n){return this.then(null,n)};g.prototype.then=
function(n,u){var v=new this.constructor(f);return h(this,new q(n,u,v)),v};g.all=function(n){var u=Array.prototype.slice.call(n);return new g(function(v,y){if(0===u.length)return v([]);for(var A=u.length,B=0;B<u.length;B++)!function I(E,H){try{if(H&&("object"==typeof H||"function"==typeof H)){var Q=H.then;if("function"==typeof Q)return Q.call(H,function(T){I(E,T)},y),0}u[E]=H;0==--A&&v(u)}catch(T){y(T)}}(B,u[B])})};g.resolve=function(n){return n&&"object"==typeof n&&n.constructor===g?n:new g(function(u){u(n)})};
g.reject=function(n){return new g(function(u,v){v(n)})};g.race=function(n){return new g(function(u,v){for(var y=0,A=n.length;y<A;y++)n[y].then(u,v)})};g._immediateFn="function"==typeof e?function(n){e(n)}:function(n){r(n,0)};g._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};g._setImmediateFn=function(n){g._immediateFn=n};g._setUnhandledRejectionFn=function(n){g._unhandledRejectionFn=n};void 0!==c&&c.exports?c.exports=
g:this.Promise||(this.Promise=g)}.call(this,a("timers").setImmediate)},{timers:3}],3:[function(a,c,d){!function(e,f){function g(p,r){this._id=p;this._clearFn=r}var h=a("process/browser.js").nextTick,l=Function.prototype.apply,m=Array.prototype.slice,k={},q=0;d.setTimeout=function(){return new g(l.call(setTimeout,window,arguments),clearTimeout)};d.setInterval=function(){return new g(l.call(setInterval,window,arguments),clearInterval)};d.clearTimeout=d.clearInterval=function(p){p.close()};g.prototype.unref=
g.prototype.ref=function(){};g.prototype.close=function(){this._clearFn.call(window,this._id)};d.enroll=function(p,r){clearTimeout(p._idleTimeoutId);p._idleTimeout=r};d.unenroll=function(p){clearTimeout(p._idleTimeoutId);p._idleTimeout=-1};d._unrefActive=d.active=function(p){clearTimeout(p._idleTimeoutId);var r=p._idleTimeout;0<=r&&(p._idleTimeoutId=setTimeout(function(){p._onTimeout&&p._onTimeout()},r))};d.setImmediate="function"==typeof e?e:function(p){var r=q++,n=!(2>arguments.length)&&m.call(arguments,
1);return k[r]=!0,h(function(){k[r]&&(n?p.apply(null,n):p.call(null),d.clearImmediate(r))}),r};d.clearImmediate="function"==typeof f?f:function(p){delete k[p]}}.call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(a,c,d){a=a("promise-polyfill");d="undefined"!=typeof window?window:Function("return this;")();c.exports={boltExport:d.Promise||a}},{"promise-polyfill":2}]},{},[4])(4)});var pf,tg,Nb,Bj,be,L=of.exports.boltExport,qf=function(b){function a(g){e()?
f(g):d.push(g)}var c=w.none(),d=[],e=function(){return c.isSome()},f=function(g){c.each(function(h){setTimeout(function(){g(h)},0)})};return b(function(g){e()||(c=w.some(g),G(d,f),d=[])}),{get:a,map:function(g){return qf(function(h){a(function(l){h(g(l))})})},isReady:e}},Ne={nu:qf,pure:function(b){return qf(function(a){a(b)})}},ec=function(b){function a(c){b().then(c,Ck)}return{map:function(c){return ec(function(){return b().then(c)})},bind:function(c){return ec(function(){return b().then(function(d){return c(d).toPromise()})})},
anonBind:function(c){return ec(function(){return b().then(function(){return c.toPromise()})})},toLazy:function(){return Ne.nu(a)},toCached:function(){var c=null;return ec(function(){return c=null===c?b():c})},toPromise:b,get:a}},Mb=function(b){return ec(function(){return new L(b)})},kb=function(b){return ec(function(){return L.resolve(b)})},Dk=0,Ka=window.Promise||(pf=window,tg=Ja.immediateFn||"function"==typeof pf.setImmediate&&pf.setImmediate||function(b){return setTimeout(b,1)},Nb=function(b,a){return function(){for(var c=
[],d=0;d<arguments.length;d++)c[d]=arguments[d];return b.apply(a,c)}},Bj=Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)},be=function(b,a,c){var d=!1;try{b(function(e){d||(d=!0,a(e))},function(e){d||(d=!0,c(e))})}catch(e){d||(d=!0,c(e))}},Ja.prototype.catch=function(b){return this.then(null,b)},Ja.prototype.then=function(b,a){var c=this;return new Ja(function(d,e){sg.call(c,new Fk(b,a,d,e))})},Ja.all=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];
var c=Array.prototype.slice.call(1===b.length&&Bj(b[0])?b[0]:b);return new Ja(function(d,e){if(0===c.length)return d([]);for(var f=c.length,g=function(l,m){try{if(m&&("object"==typeof m||"function"==typeof m)){var k=m.then;if("function"==typeof k)return void k.call(m,function(q){g(l,q)},e)}c[l]=m;0==--f&&d(c)}catch(q){e(q)}},h=0;h<c.length;h++)g(h,c[h])})},Ja.resolve=function(b){return b&&"object"==typeof b&&b.constructor===Ja?b:new Ja(function(a){a(b)})},Ja.reject=function(b){return new Ja(function(a,
c){c(b)})},Ja.race=function(b){return new Ja(function(a,c){for(var d=0;d<b.length;d++)b[d].then(a,c)})},Ja),Cj,Dj,Bg=function(b){return new Ka(function(a,c){var d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="blob";d.onload=function(){200===this.status&&a(this.response)};d.onerror=function(){var e;c(0===this.status?((e=Error("No access to download image")).code=18,e.name="SecurityError",e):Error("Error "+this.status+" downloading image"))};d.send()})},de=function(b){return new Ka(function(a,
c){vg(b).fold(function(){c("uri is not base64: "+b)},a)})},Zi=yg,tn=vg,Dg=function(b,a){return Mb(function(c){Zi(b).then(function(d){d=zg(b,d);var e=sc("image");d=La.blob(e,d,a);c(d)})})},ca=function(b,a){return Eg(b,a,0)},Ob=function(b,a){return Eg(b,a,b.length-a.length)},zc=(Cj=/^\s+|\s+$/g,function(b){return b.replace(Cj,"")}),Gg="undefined"!=typeof window?window:Function("return this;")(),Ha=hd(1),$b=hd(3),hl=hd(9),Co=hd(11),D={fromHtml:function(b,a){a=(a||document).createElement("div");if(a.innerHTML=
b,!a.hasChildNodes()||1<a.childNodes.length)throw console.error("HTML does not have a single root node",b),Error("HTML must have a single root node");return xc(a.childNodes[0])},fromTag:function(b,a){b=(a||document).createElement(b);return xc(b)},fromText:function(b,a){b=(a||document).createTextNode(b);return xc(b)},fromDom:xc,fromPoint:function(b,a,c){return w.from(b.dom.elementFromPoint(a,c)).map(xc)}},Ik={"cement.dialog.paste.title":"Paste Formatting Options","cement.dialog.paste.instructions":"Choose to keep or remove formatting in the pasted content.",
"cement.dialog.paste.merge":"Keep formatting","cement.dialog.paste.clean":"Remove formatting","safari.imagepaste":Ig(),"webview.imagepaste":Ig(),"error.code.images.not.found":"The images service was not found: (","error.imageupload":"Image failed to upload: (","error.full.stop":").","errors.local.images.disallowed":"Local image paste has been disabled. Local images have been removed from pasted content.","errors.imageimport.failed":"Some images failed to import.","errors.imageimport.unsupported":"Unsupported image type.",
"errors.imageimport.invalid":"Image is invalid."},Lk=Object.hasOwnProperty,Kg=Object.setPrototypeOf,Jk=Object.isFrozen,Nk=Object.getPrototypeOf,Mk=Object.getOwnPropertyDescriptor,Ia=Object.freeze,nb=Object.seal,Kk=Object.create,Ej="undefined"!=typeof Reflect&&Reflect,Jg=Ej.apply||function(b,a,c){return b.apply(a,c)};Ia=Ia||function(b){return b};nb=nb||function(b){return b};var Do=Ej.construct||function(b,a){return new (Function.prototype.bind.apply(b,[null].concat(function(c){if(Array.isArray(c)){for(var d=
0,e=Array(c.length);d<c.length;d++)e[d]=c[d];return e}return Array.from(c)}(a))))},Eo=Xa(Array.prototype.forEach),Fj=Xa(Array.prototype.pop),Wc=Xa(Array.prototype.push),yb=Xa(String.prototype.toLowerCase),Gj=Xa(String.prototype.match),tb=Xa(String.prototype.replace),Fo=Xa(String.prototype.indexOf),Go=Xa(String.prototype.trim),ub=Xa(RegExp.prototype.test),Hj=(Dj=TypeError,function(){for(var b=arguments.length,a=Array(b),c=0;c<b;c++)a[c]=arguments[c];return Do(Dj,a)}),Ij=Ia("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
rf=Ia("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),sf=Ia("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
Ho=Ia("animate color-profile cursor discard fedropshadow feimage font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),tf=Ia("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),Io=Ia("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
Jj=Ia(["#text"]),Kj=Ia("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
uf=Ia("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Lj=Ia("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Kd=Ia(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Jo=nb(/\{\{[\s\S]*|[\s\S]*\}\}/gm),Ko=nb(/<%[\s\S]*|[\s\S]*%>/gm),Lo=nb(/^data-[\-\w.\u00B7-\uFFFF]/),Mo=nb(/^aria-[\-\w]+$/),No=nb(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Oo=nb(/^(?:\w+script|data):/i),Po=nb(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&
"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},vf,Mj,Ld,yc=function c(a){function d(x){return c(x)}function e(x){fc&&fc===x||(x=Pb(x=x&&"object"===(void 0===x?"undefined":Xc(x))?x:{}),Fa="ALLOWED_TAGS"in x?P({},x.ALLOWED_TAGS):Nj,Ga="ALLOWED_ATTR"in x?P({},x.ALLOWED_ATTR):Oj,wf="ADD_URI_SAFE_ATTR"in x?P(Pb(Pj),x.ADD_URI_SAFE_ATTR):Pj,Qj="ADD_DATA_URI_TAGS"in x?P(Pb(Rj),x.ADD_DATA_URI_TAGS):Rj,xf="FORBID_TAGS"in x?P({},x.FORBID_TAGS):{},Sj="FORBID_ATTR"in
x?P({},x.FORBID_ATTR):{},gc="USE_PROFILES"in x&&x.USE_PROFILES,Tj=!1!==x.ALLOW_ARIA_ATTR,yf=!1!==x.ALLOW_DATA_ATTR,Uj=x.ALLOW_UNKNOWN_PROTOCOLS||!1,hc=x.SAFE_FOR_TEMPLATES||!1,Yc=x.WHOLE_DOCUMENT||!1,ic=x.RETURN_DOM||!1,Md=x.RETURN_DOM_FRAGMENT||!1,Vj=!1!==x.RETURN_DOM_IMPORT,Nd=x.RETURN_TRUSTED_TYPE||!1,zf=x.FORCE_BODY||!1,Wj=!1!==x.SANITIZE_DOM,Af=!1!==x.KEEP_CONTENT,Zc=x.IN_PLACE||!1,Bf=x.ALLOWED_URI_REGEXP||Bf,Od=x.NAMESPACE||Od,hc&&(yf=!1),Md&&(ic=!0),gc&&(Fa=P({},[].concat($a(Jj))),Ga=[],!0===
gc.html&&(P(Fa,Ij),P(Ga,Kj)),!0===gc.svg&&(P(Fa,rf),P(Ga,uf),P(Ga,Kd)),!0===gc.svgFilters&&(P(Fa,sf),P(Ga,uf),P(Ga,Kd)),!0===gc.mathMl&&(P(Fa,tf),P(Ga,Lj),P(Ga,Kd))),x.ADD_TAGS&&P(Fa=Fa===Nj?Pb(Fa):Fa,x.ADD_TAGS),x.ADD_ATTR&&P(Ga=Ga===Oj?Pb(Ga):Ga,x.ADD_ATTR),x.ADD_URI_SAFE_ATTR&&P(wf,x.ADD_URI_SAFE_ATTR),Af&&(Fa["#text"]=!0),Yc&&P(Fa,["html","head","body"]),Fa.table&&(P(Fa,["tbody"]),delete xf.tbody),Ia&&Ia(x),fc=x)}function f(x){Wc(d.removed,{element:x});try{x.parentNode.removeChild(x)}catch(F){try{x.outerHTML=
Hb}catch(K){x.remove()}}}function g(x,F){try{Wc(d.removed,{attribute:F.getAttributeNode(x),from:F})}catch(K){Wc(d.removed,{attribute:null,from:F})}if(F.removeAttribute(x),"is"===x&&!Ga[x])if(ic||Md)try{f(F)}catch(K){}else try{F.setAttribute(x,"")}catch(K){}}function h(x){var F,K=void 0,J=void 0;zf?x="<remove></remove>"+x:J=(F=Gj(x,/^[\r\n\t ]+/))&&F[0];F=Na?Na.createHTML(x):x;if("http://www.w3.org/1999/xhtml"===Od)try{K=(new M).parseFromString(F,"text/html")}catch(aa){}K&&K.documentElement||((K=Cf.createDocument(Od,
"template",null)).documentElement.innerHTML=F);F=K.body||K.documentElement;return x&&J&&F.insertBefore(y.createTextNode(J),F.childNodes[0]||null),Yc?K.documentElement:F}function l(x){return Qo.call(x.ownerDocument||x,x,H.SHOW_ELEMENT|H.SHOW_COMMENT|H.SHOW_TEXT,function(){return H.FILTER_ACCEPT},!1)}function m(x){return"object"===(void 0===C?"undefined":Xc(C))?x instanceof C:x&&"object"===(void 0===x?"undefined":Xc(x))&&"number"==typeof x.nodeType&&"string"==typeof x.nodeName}function k(x,F,K){eb[x]&&
Eo(eb[x],function(J){J.call(d,F,K,fc)})}function q(x){var F;if((k("beforeSanitizeElements",x,null),!(x instanceof T||x instanceof O||"string"==typeof x.nodeName&&"string"==typeof x.textContent&&"function"==typeof x.removeChild&&x.attributes instanceof Q&&"function"==typeof x.removeAttribute&&"function"==typeof x.setAttribute&&"string"==typeof x.namespaceURI&&"function"==typeof x.insertBefore))||Gj(x.nodeName,/[\u0080-\uFFFF]/))return f(x),1;var K=yb(x.nodeName);if(k("uponSanitizeElement",x,{tagName:K,
allowedTags:Fa}),!(m(x.firstElementChild)||m(x.content)&&m(x.content.firstElementChild))&&ub(/<[/\w]/g,x.innerHTML)&&ub(/<[/\w]/g,x.textContent))return f(x),1;if(Fa[K]&&!xf[K]){var J;if(J=x instanceof E){var aa=Qa(x);aa&&aa.tagName||(aa={namespaceURI:"http://www.w3.org/1999/xhtml",tagName:"template"});J=yb(x.tagName);var Ca=yb(aa.tagName);"http://www.w3.org/2000/svg"===x.namespaceURI?J="http://www.w3.org/1999/xhtml"===aa.namespaceURI?"svg"===J:"http://www.w3.org/1998/Math/MathML"===aa.namespaceURI?
"svg"===J&&("annotation-xml"===Ca||Xj[Ca]):!!Pd[J]:"http://www.w3.org/1998/Math/MathML"===x.namespaceURI?J="http://www.w3.org/1999/xhtml"===aa.namespaceURI?"math"===J:"http://www.w3.org/2000/svg"===aa.namespaceURI?"math"===J&&Yj[Ca]:!!Df[J]:"http://www.w3.org/1999/xhtml"!==x.namespaceURI||"http://www.w3.org/2000/svg"===aa.namespaceURI&&!Yj[Ca]||"http://www.w3.org/1998/Math/MathML"===aa.namespaceURI&&!Xj[Ca]?J=void 0:(aa=P({},["title","style","font","a","script"]),J=!Df[J]&&(aa[J]||!Pd[J]));J=!J}return J||
("noscript"===K||"noembed"===K)&&ub(/<\/no(script|embed)/i,x.innerHTML)?(f(x),1):(hc&&3===x.nodeType&&(F=x.textContent,F=tb(F,Ef," "),F=tb(F,Ff," "),x.textContent!==F&&(Wc(d.removed,{element:x.cloneNode()}),x.textContent=F)),k("afterSanitizeElements",x,null),0)}if(Af&&!Ro[K]&&(F=Qa(x)||x.parentNode,(K=db(x)||x.childNodes)&&F))for(J=K.length-1;0<=J;--J)F.insertBefore(ea(K[J],!0),Gb(x));return f(x),1}function p(x,F,K){return Wj&&("id"===F||"name"===F)&&(K in y||K in So)||!(yf&&ub(To,F)||Tj&&ub(Uo,F)||
Ga[F]&&!Sj[F]&&(wf[F]||ub(Bf,tb(K,Zj,""))||("src"===F||"xlink:href"===F||"href"===F)&&"script"!==x&&0===Fo(K,"data:")&&Qj[x]||Uj&&!ub(Vo,tb(K,Zj,""))||!K))?!1:!0}function r(x){var F,K;k("beforeSanitizeAttributes",x,null);var J=x.attributes;if(J){var aa={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ga};for(K=J.length;K--;){var Ca=(F=J[K]).name,ak=F.namespaceURI;F=Go(F.value);var jc=yb(Ca);if(aa.attrName=jc,aa.attrValue=F,aa.keepAttr=!0,aa.forceKeepAttr=void 0,k("uponSanitizeAttribute",x,
aa),F=aa.attrValue,!aa.forceKeepAttr&&(g(Ca,x),aa.keepAttr))if(ub(/\/>/i,F))g(Ca,x);else if(hc&&(F=tb(F,Ef," "),F=tb(F,Ff," ")),p(x.nodeName.toLowerCase(),jc,F))try{ak?x.setAttributeNS(ak,Ca,F):x.setAttribute(Ca,F),Fj(d.removed)}catch(bk){}}k("afterSanitizeAttributes",x,null)}}var n=0<arguments.length&&void 0!==a?a:"undefined"==typeof window?null:window;if(d.version="2.2.8",d.removed=[],!n||!n.document||9!==n.document.nodeType)return d.isSupported=!1,d;var u,v=n.document,y=n.document,A=n.DocumentFragment,
B=n.HTMLTemplateElement,C=n.Node,E=n.Element,H=n.NodeFilter,I=n.NamedNodeMap,Q=void 0===I?n.NamedNodeMap||n.MozNamedAttrMap:I,T=n.Text,O=n.Comment,M=n.DOMParser;I=n.trustedTypes;var W=E.prototype,ea=id(W,"cloneNode"),Gb=id(W,"nextSibling"),db=id(W,"childNodes"),Qa=id(W,"parentNode");"function"!=typeof B||(u=y.createElement("template")).content&&u.content.ownerDocument&&(y=u.content.ownerDocument);var Na=function(x,F){if("object"!==(void 0===x?"undefined":Xc(x))||"function"!=typeof x.createPolicy)return null;
var K=null;F="dompurify"+((K=F.currentScript&&F.currentScript.hasAttribute("data-tt-policy-suffix")?F.currentScript.getAttribute("data-tt-policy-suffix"):K)?"#"+K:"");try{return x.createPolicy(F,{createHTML:function(J){return J}})}catch(J){return console.warn("TrustedTypes policy "+F+" could not be created."),null}}(I,v),Hb=Na&&Nd?Na.createHTML(""):"";u=y;var Cf=u.implementation,Qo=u.createNodeIterator,Wo=u.createDocumentFragment,Xo=v.importNode;u={};try{u=Pb(y).documentMode?y.documentMode:{}}catch(x){}var eb=
{};d.isSupported="function"==typeof Qa&&Cf&&void 0!==Cf.createHTMLDocument&&9!==u;var gc,Ef=Jo,Ff=Ko,To=Lo,Uo=Mo,Vo=Oo,Zj=Po,Bf=No,Fa=null,Nj=P({},[].concat($a(Ij),$a(rf),$a(sf),$a(tf),$a(Jj))),Ga=null,Oj=P({},[].concat($a(Kj),$a(uf),$a(Lj),$a(Kd))),xf=null,Sj=null,Tj=!0,yf=!0,Uj=!1,hc=!1,Yc=!1,Gf=!1,zf=!1,ic=!1,Md=!1,Vj=!0,Nd=!1,Wj=!0,Af=!0,Zc=!1,Ro=P({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),
Qj=null,Rj=P({},"audio video img source image track".split(" ")),wf=null,Pj=P({},"alt class for id label name pattern placeholder summary title value style xmlns".split(" ")),Od="http://www.w3.org/1999/xhtml",fc=null,So=y.createElement("form"),Xj=P({},["mi","mo","mn","ms","mtext"]),Yj=P({},["foreignobject","desc","title","annotation-xml"]),Pd=P({},rf);P(Pd,sf);P(Pd,Ho);var Df=P({},tf);return P(Df,Io),d.sanitize=function(x,F){var K,J=void 0,aa=void 0,Ca=void 0;if("string"!=typeof(x=x||"\x3c!--\x3e")&&
!m(x)){if("function"!=typeof x.toString)throw Hj("toString is not a function");if("string"!=typeof(x=x.toString()))throw Hj("dirty is not a string, aborting");}if(!d.isSupported){if("object"===Xc(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof x)return n.toStaticHTML(x);if(m(x))return n.toStaticHTML(x.outerHTML)}return x}if(Gf||e(F),d.removed=[],!(Zc="string"!=typeof x&&Zc))if(x instanceof C)1===(K=(J=h("\x3c!----\x3e")).ownerDocument.importNode(x,!0)).nodeType&&"BODY"===K.nodeName||
"HTML"===K.nodeName?J=K:J.appendChild(K);else{if(!ic&&!hc&&!Yc&&-1===x.indexOf("<"))return Na&&Nd?Na.createHTML(x):x;if(!(J=h(x)))return ic?null:Hb}J&&zf&&f(J.firstChild);for(K=l(Zc?x:J);F=K.nextNode();)3===F.nodeType&&F===aa||q(F)||(F.content instanceof A&&function bk(jc){var kc,Yo=l(jc);for(k("beforeSanitizeShadowDOM",jc,null);kc=Yo.nextNode();)k("uponSanitizeShadowNode",kc,null),q(kc)||(kc.content instanceof A&&bk(kc.content),r(kc));k("afterSanitizeShadowDOM",jc,null)}(F.content),r(F),aa=F);if(aa=
null,Zc)return x;if(ic){if(Md)for(Ca=Wo.call(J.ownerDocument);J.firstChild;)Ca.appendChild(J.firstChild);else Ca=J;return Vj?Xo.call(v,Ca,!0):Ca}x=Yc?J.outerHTML:J.innerHTML;return hc&&(x=tb(x,Ef," "),x=tb(x,Ff," ")),Na&&Nd?Na.createHTML(x):x},d.setConfig=function(x){e(x);Gf=!0},d.clearConfig=function(){fc=null;Gf=!1},d.isValidAttribute=function(x,F,K){return fc||e({}),p(yb(x),yb(F),K)},d.addHook=function(x,F){"function"==typeof F&&(eb[x]=eb[x]||[],Wc(eb[x],F))},d.removeHook=function(x){eb[x]&&Fj(eb[x])},
d.removeHooks=function(x){eb[x]&&(eb[x]=[])},d.removeAllHooks=function(){eb={}},d}(),Lg=["script","svg"],Gd={sanitizeHtml:wa,sanitizeText:wa},tj=z("x-tinymce/html"),ie="\x3c!-- x-tinymce/html --\x3e",Aa=tinymce.each,zb=tinymce.trim,Pg={strip_class_attributes:"all",retain_style_properties:"none"},Qg={strip_class_attributes:"none",retain_style_properties:"valid"},X="startElement",Da="endElement",qb="text",Bc="comment",Pk=function(a){function c(){return e}function d(m){Aa(l(),function(k,q){m(q,k)})}
var e,f,g,h=0,l=function(){return e={},h=0,Aa(a.attributes,function(m){var k=m.nodeName,q=m.value;!1===m.specified&&("name"!==m.nodeName||""===m.value)||null!=q&&(e[k]=q,h++)}),void 0===e.style&&a.style.cssText&&(e.style=a.style.cssText,h++),l=c,e};return{get:function(m){return l()[m]},each:d,filter:function(m){var k;f||(g=l);f=(k=f)&&m?function(q,p){return m(q,k(q,p))}:k||m;l=function(){return l=g,d(function(q,p){var r=f(q,p);null===r?(a.removeAttribute(q),delete e[q],h--):r!==p&&("class"===q?a.className=
r:a.setAttribute(q,r),e[q]=r)}),l=c,e}},getAttributes:function(){return l()},getAttributeCount:function(){return l(),h}}},le=!1,Cc=Ab("HTML",window.document),ck=[function(a){return 65279===a.charCodeAt(a.length-1)?a.substring(0,a.length-1):a}],Zo=tinymce.isIE&&9<=document.documentMode?[function(a){return a.replace(/<BR><BR>/g,"<br>")},function(a){return a.replace(/<br>/g," ")},function(a){return a.replace(/<br><br>/g,"<BR><BR>")},function(a){return/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(a)?
a.replace(/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"):a}].concat(ck):ck,al=(vf=Array.prototype.slice.call(Zo).reverse(),function(a){for(var c=0;c<vf.length;c++)a=(0,vf[c])(a);return a}),$o=/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/,
ap=Ya(function(a,c){var d=a.settings.get("retain_style_properties");c.filterStyles(function(e,f){switch(d){case "all":case "*":e=!0;break;case "valid":e=!$o.test(e);break;case void 0:case "none":e="list-style-type"===e;break;default:e=0<=(","+d+",").indexOf(","+e+",")}return e?f:null});a.emit(c)}),bp=Ya(function(a,c){a.seenList||(a.inferring?"LI"===c.tag()&&(c.type()===X?a.inferring++:(a.inferring--,a.inferring||(a.needsClosing=!0))):("OL"===c.tag()||"UL"===c.tag()?a.seenList=!0:"LI"===c.tag()&&(a.inferring=
1,a.needsClosing||a.emit(kd("UL",{},{},a.document))),!a.needsClosing||a.inferring||c.isWhitespace()||(a.needsClosing=!1,a.emit(Ab("UL",a.document)))));a.emit(c)}),cp=Bb(function(a,c){return"name"===a||"id"===a?null:c}),dp=Bb(function(a,c){if("class"===a)switch(this.settings.get("strip_class_attributes")){case "mso":return 0===c.indexOf("Mso")?null:c;case "none":break;default:return null}return c}),dk=function(){if(0<navigator.userAgent.indexOf("Gecko")&&0>navigator.userAgent.indexOf("WebKit"))return!1;
var a=document.createElement("div");try{a.innerHTML='<p style="mso-list: Ignore;">&nbsp;</p>'}catch(c){return!1}return"Ignore"===Ac(a.firstChild).getStyle("mso-list")}(),rb=[],Qb=[],ld=!1,ep=Ya(function(a,c){function d(e){return!(0<=",FONT,EM,STRONG,SAMP,ACRONYM,CITE,CODE,DFN,KBD,TT,B,I,U,S,SUB,SUP,INS,DEL,VAR,SPAN,".indexOf(","+e.tag()+",")&&ne(e,!0))}0===(rb=rb||[]).length?c.type()!==X||d(c)?a.emit(c):Rg(a,c):(ld=ld||d(c),Rg(a,c))}),fp=Bb(function(a,c){return"style"===a&&""===c?null:c}),gp=Bb(function(a,
c){return"lang"===a?null:c}),hp=Ya(function(a,c){if("IMG"===c.tag()){if(c.type()===Da&&a.skipEnd)return a.skipEnd=!1;if(c.type()===X&&(/^file:/.test(c.getAttribute("src"))||a.settings.get("base_64_images")&&/^data:image\/.*;base64/.test(c.getAttribute("src"))))return a.skipEnd=!0,0}a.emit(c)}),ip=Ya(function(a,c){"META"!==c.tag()&&"LINK"!==c.tag()&&a.emit(c)}),Hf=[],jp=Ya(function(a,c){c.type()===X&&"A"===c.tag()?(Hf.push(c),Sg(c)&&a.defer(c)):c.type()===Da&&"A"===c.tag()?(Sg(Hf.pop())&&a.defer(c),
0===Hf.length&&a.emitDeferred()):a.hasDeferred()?a.defer(c):a.emit(c)}),ek=!1,Yg=[Ya(function(a,c){"SCRIPT"===c.tag()?ek=c.type()===X:ek||(c.filterAttributes(function(d,e){return/^on/.test(d)||"language"===d?null:e}),a.emit(c))}),cp,hp,ap,gp,fp,dp,jp,ep,ip,bp],kp=Ya(function(a,c){c.filterAttributes(function(d,e){return"align"!==d&&("UL"!==c.tag()&&"OL"!==c.tag()||"type"!==d)?e:null});a.emit(c)}),lp=Bb(function(a,c){return/^xmlns(:|$)/.test(a)?null:c}),mp=Ya(function(a,c){c.tag&&/^([OVWXP]|U[0-9]+|ST[0-9]+):/.test(c.tag())||
a.emit(c)}),np=Bb(function(a,c){return"href"===a&&(0<=c.indexOf("#_Toc")||0<=c.indexOf("#_mso"))?null:c}),op=Bb(function(a,c){return/^v:/.test(a)?null:c}),Tk=[{regex:/^\(?[dc][\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[DC][\.\)]$/,type:{tag:"OL",type:"upper-alpha"}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:"OL",type:"upper-roman"}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:"OL",type:"lower-roman"}},{regex:/^\(?[0-9]+[\.\)]$/,
type:{tag:"OL"}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:"OL",variant:"outline"}},{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:"OL",type:"upper-alpha"}}],Sk={"\u2022":{tag:"UL",type:"disc"},"\u00b7":{tag:"UL",type:"disc"},"\u00a7":{tag:"UL",type:"square"}},Rk={o:{tag:"UL",type:"circle"},"-":{tag:"UL",type:"disc"},"\u25cf":{tag:"UL",type:"disc"}},Ug=function(a,c,d){return a===c||a&&c&&a.tag===c.tag&&a.type===c.type&&(d||a.variant===c.variant)},
Zk=(Mj=function(a,c){var d;c=/([^{]+){([^}]+)}/g;for(c.lastIndex=0;null!==(d=c.exec(a));){var e=Aa;d=d[1].split(",");var f=(void 0).indexOf(".");f=0<=f&&void 0===zb((void 0).substring(f+1))?!1:void 0;e(d,f)}return!1},Ld={},function(a,c){var d,e=a+","+c;return Ld.hasOwnProperty(e)?Ld[e]:(d=Mj.call(null,a,c),Ld[e]=d)}),Vk=["disc","circle","square"],Wk=function(a,c,d){d.type()!==X||"SPAN"!==d.tag()||0!==c.spanCount.length||!dk&&Vg(d,c)||me(d)?d.type()===Da?"SPAN"===d.tag()?(a.defer(d),c.spanCount.pop()):
"P"===d.tag()?(a.defer(d),c.skippedPara=!0,c.openedTag=null,c.nextFilter=pe):(c.nextFilter=Rb,c.nextFilter(a,c,d)):d.isWhitespace()?a.defer(d):(c.nextFilter=Rb,c.nextFilter(a,c,d)):(a.defer(d),c.spanCount.push(d))},Rb=function(a,c,d){function e(){c.emitter.closeAllLists();a.emitDeferred();c.openedTag=null;a.emit(d);c.nextFilter=Rb}var f;d.type()===X&&me(d)&&"LI"!==d.tag()?(f=/ level([0-9]+)/.exec(d.getStyle("mso-list")))&&f[1]?(c.itemLevel=parseInt(f[1],10)+c.styleLevelAdjust,c.nextFilter===Rb?a.emitDeferred():
a.dropDeferred(),c.nextFilter=fk,a.startTransaction(),c.originalToken=d,c.commentMode=!1):e():!dk&&(d.type()===Bc&&"[if !supportLists]"===d.text()||Vg(d,a))?(d.type()===X&&"SPAN"===d.tag()&&c.spanCount.push(d),c.nextFilter=fk,a.startTransaction(),c.originalToken=c.openedTag,c.commentMode=!0,c.openedTag=null,a.dropDeferred()):d.type()===Da&&Cb(d)?(a.defer(d),c.spanCount.pop()):d.type()===X?Cb(d)?(a.defer(d),c.spanCount.push(d)):(c.openedTag&&(c.emitter.closeAllLists(),a.emitDeferred()),c.openedTag=
d,a.defer(d)):e()},fk=function(a,c,d){var e,f;d.type()===X&&"Ignore"===d.getStyle("mso-list")&&(c.nextFilter=If);d.type()===X&&"SPAN"===d.tag()?(c.spanCount.push(d),(c.commentMode&&""===d.getAttribute("style")||null===d.getAttribute("style"))&&(c.nextFilter=If)):"A"===d.tag()?d.type()===X?c.spanCount.push(d):c.spanCount.pop():d.type()===qb?c.commentMode?(c.nextFilter=If,c.nextFilter(a,c,d)):(e=c.originalToken,f=c.spanCount,c.emitter.closeAllLists(),a.emit(e),Aa(f,Ng(a.emit,a)),a.emit(d),a.commit(),
c.originalToken=e,c.nextFilter=Xk):!c.commentMode&&d.type()===Bc||md(a,d)},If=function(a,c,d){d.type()===qb?d.isWhitespace()||(c.nextFilter=gk,c.bulletInfo={text:d.text(),symbolFont:c.symbolFont}):Cb(d)?d.type()===X?c.spanCount.push(d):c.spanCount.pop():d.type()===X&&"IMG"===d.tag()?(c.nextFilter=gk,c.bulletInfo={text:"\u2202",symbolFont:!0}):md(a,d)},gk=function(a,c,d){d.type()===X&&Cb(d)?(c.spanCount.push(d),c.nextFilter=pp):d.type()===Da&&Cb(d)?(c.spanCount.pop(),c.nextFilter=hk):d.type()===Da&&
"IMG"===d.tag()||md(a,d)},pp=function(a,c,d){d.type()===Da&&(Cb(d)&&c.spanCount.pop(),c.nextFilter=hk)},hk=function(a,c,d){function e(f){var g;if(c.nextFilter=qp,c.commentMode&&(c.itemLevel=c.indentGuesser.guessIndentLevel(d,c.originalToken,c.styles.styles,c.bulletInfo)),c.listType=Tg(c.bulletInfo,(g=c.emitter.getCurrentListType(),c.emitter.getCurrentLevel()===c.itemLevel?g:null),c.originalToken),c.listType){c.emitter.openItem(c.itemLevel,c.originalToken,c.listType,c.skippedPara);for(a.emitDeferred();0<
c.spanCount.length;)a.emit(c.spanCount.shift());f&&a.emit(d)}else je("Unknown list type: "+c.bulletInfo.text+" Symbol font? "+c.bulletInfo.symbolFont),a.rollback()}d.type()===qb||d.type()===X?e(!0):d.type()===Bc?e("[endif]"!==d.text()):d.type()===Da?Cb(d)&&c.spanCount.pop():md(a,d)},qp=function(a,c,d){d.type()===Da&&d.tag()===c.originalToken.tag()?(c.nextFilter=pe,c.skippedPara=!1):a.emit(d)},Yk=Rb,qa={};Wg({});var fa,$c,bl=[mp,Ya(function(a,c){var d,e;qa.styles.check(c)||(qa.symbolFont=(d=qa.symbolFont,
c.type()===X&&((e=c.getStyle("font-family"))?d="Wingdings"===e||"Symbol"===e:/^(P|H[1-6]|DIV)$/.test(c.tag())&&(d=!1)),d),qa.nextFilter(a,qa,c))},function(a){Wg(a)}),np,op,lp,kp],Xg=function(a){return 0<=a.indexOf("<o:p>")||0<=a.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal")||0<=a.indexOf("MsoListParagraphCxSpFirst")||0<=a.indexOf("<w:WordDocument>")},dl=Object.freeze({__proto__:null,openDialog:function(a,c,d){var e=c("cement.dialog.paste.clean"),f=c("cement.dialog.paste.merge");e=[{text:e,ariaLabel:e,
onclick:function(){g.close();d("clean")}},{text:f,ariaLabel:f,onclick:function(){g.close();d("merge")}}];c={title:c("cement.dialog.paste.title"),spacing:10,padding:10,items:[{type:"container",html:c("cement.dialog.paste.instructions")}],buttons:e};var g=a.windowManager.open(c);setTimeout(function(){g&&g.getEl().focus()},1)}}),cl=Object.freeze({__proto__:null,openDialog:function(a,c,d){var e=c("cement.dialog.paste.clean"),f=c("cement.dialog.paste.merge");c={title:c("cement.dialog.paste.title"),body:{type:"panel",
items:[{type:"htmlpanel",name:"instructions",html:c("cement.dialog.paste.instructions")}]},buttons:[{text:e,type:"custom",name:"clean"},{text:f,type:"custom",name:"merge"}],onAction:function(g,h){switch(h.name){case "clean":g.close();d("clean");break;case "merge":g.close(),d("merge")}}};a.windowManager.open(c)}}),se=function(a,c){return{major:a,minor:c}},ad={nu:se,detect:function(a,c){var d;c=String(c).toLowerCase();if(0===a.length)a=dh();else{a:{for(var e=0;e<a.length;e++){var f=a[e];if(f.test(c)){a=
f;break a}}a=void 0}a=(d=a)?se(Number(c.replace(d,"$1")),Number(c.replace(d,"$2"))):{major:0,minor:0}}return a},unknown:dh},Jf=/.*?version\/ ?([0-9]+)\.([0-9]+).*/,ik={browsers:z([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return U(a,"edge/")&&U(a,"chrome")&&U(a,"safari")&&U(a,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Jf],search:function(a){return U(a,"chrome")&&!U(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie ?([0-9]+)\.([0-9]+).*/,
/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return U(a,"msie")||U(a,"trident")}},{name:"Opera",versionRegexes:[Jf,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:hb("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/ ?([0-9]+)\.([0-9]+).*/],search:hb("firefox")},{name:"Safari",versionRegexes:[Jf,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(U(a,"safari")||U(a,"mobile/"))&&U(a,"applewebkit")}}]),oses:z([{name:"Windows",search:hb("win"),versionRegexes:[/.*?windows nt ?([0-9]+)\.([0-9]+).*/]},
{name:"iOS",search:function(a){return U(a,"iphone")||U(a,"ipad")},versionRegexes:[/.*?version\/ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:hb("android"),versionRegexes:[/.*?android ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:hb("mac os x"),versionRegexes:[/.*?mac os x ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:hb("linux"),versionRegexes:[]},{name:"Solaris",search:hb("sunos"),versionRegexes:[]},{name:"FreeBSD",search:hb("freebsd"),
versionRegexes:[]},{name:"ChromeOS",search:hb("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},fh="Firefox",rp=function(){return eh({current:void 0,version:ad.unknown()})},hh=(z("Edge"),z("Chrome"),z("IE"),z("Opera"),z(fh),z("Safari"),"Windows"),ih="Android",jh="Solaris",kh="FreeBSD",lh="ChromeOS",sp=function(){return gh({current:void 0,version:ad.unknown()})},lb=(z(hh),z("iOS"),z(ih),z("Linux"),z("OSX"),z(jh),z(kh),z(lh),Sb(function(){return a=navigator.userAgent,c=w.from(navigator.userAgentData),
d=gl,v=ik.browsers(),y=ik.oses(),A=c.bind(function(C){return E=v,vb(C.brands,function(H){var I=H.brand.toLowerCase();return Sa(E,function(Q){var T;return I===(null===(T=Q.brand)||void 0===T?void 0:T.toLowerCase())}).map(function(Q){return{current:Q.name,version:ad.nu(parseInt(H.version,10),0)}})});var E}).orThunk(function(){return ah(v,C=a).map(function(E){var H=ad.detect(E.versionRegexes,C);return{current:E.name,version:H}});var C}).fold(rp,eh),B=ah(y,e=a).map(function(C){var E=ad.detect(C.versionRegexes,
e);return{current:C.name,version:E}}).fold(sp,gh),{browser:A,os:B,deviceType:(g=A,h=a,l=d,m=(f=B).isiOS()&&!0===/ipad/i.test(h),k=f.isiOS()&&!m,p=(q=f.isiOS()||f.isAndroid())||l("(pointer:coarse)"),r=m||!k&&q&&l("(min-device-width:768px)"),n=k||q&&!r,u=g.isSafari()&&f.isiOS()&&!1===/safari/i.test(h),{isiPad:z(m),isiPhone:z(k),isTablet:z(r),isPhone:z(n),isTouch:z(p),isAndroid:f.isAndroid,isiOS:f.isiOS,isWebView:z(u),isDesktop:z(!n&&!r&&!u)})};var a,c,d,e,f,g,h,l,m,k,q,p,r,n,u,v,y,A,B})),jk=Ua(Element.prototype.attachShadow)&&
Ua(Node.prototype.getRootNode),xl=z(jk),tp=jk?function(a){return D.fromDom(a.dom.getRootNode())}:Dc,Le=function(a){var c=$b(a)?a.dom.parentNode:a.dom;if(null==c||null===c.ownerDocument)return!1;var d,e,f,g=c.ownerDocument;return e=D.fromDom(c),f=tp(e),(Co(f)&&null!=f.dom.host?w.some(f):w.none()).fold(function(){return g.body.contains(c)},(d=Le,function(h){return d(D.fromDom(h.dom.host))}))},Ze=function(a,c){var d=[];return G(da(a),function(e){d=(d=c(e)?d.concat([e]):d).concat(Ze(e,c))}),d},Kf=re("ephox-salmon").resolve,
ib={uploadInProgress:z(Kf("upload-image-in-progress")),blobId:z("data-"+Kf("image-blob")),trackedImage:z("data-"+Kf("image-upload"))},pd=ib.trackedImage();($c=fa=fa||{}).JSON="json";$c.Blob="blob";$c.Text="text";$c.FormData="formdata";$c.MultipartFormData="multipart/form-data";var lc=function(a){return{isValue:Ra,isError:Pa,getOr:z(a),getOrThunk:z(a),getOrDie:z(a),or:function(c){return lc(a)},orThunk:function(c){return lc(a)},fold:function(c,d){return d(a)},map:function(c){return lc(c(a))},mapError:function(c){return lc(a)},
each:function(c){c(a)},bind:function(c){return c(a)},exists:function(c){return c(a)},forall:function(c){return c(a)},toOptional:function(){return w.some(a)}}},bd=function(a){return{isValue:Pa,isError:Ra,getOr:wa,getOrThunk:function(c){return c()},getOrDie:function(){return pc(String(a))()},or:wa,orThunk:function(c){return c()},fold:function(c,d){return c(a)},map:function(c){return bd(a)},mapError:function(c){return bd(c(a))},each:ba,bind:function(c){return bd(a)},exists:Pa,forall:Ra,toOptional:w.none}},
R={value:lc,error:bd,fromOption:function(a,c){return a.fold(function(){return bd(c)},lc)}},jb=function(a){return ua(ua({},a),{toCached:function(){return jb(a.toCached())},bindFuture:function(c){return jb(a.bind(function(d){return d.fold(function(e){return kb(R.error(e))},function(e){return c(e)})}))},bindResult:function(c){return jb(a.map(function(d){return d.bind(c)}))},mapResult:function(c){return jb(a.map(function(d){return d.map(c)}))},mapError:function(c){return jb(a.map(function(d){return d.mapError(c)}))},
foldResult:function(c,d){return a.map(function(e){return e.fold(c,d)})},withTimeout:function(c,d){return jb(Mb(function(e){var f=!1,g=setTimeout(function(){f=!0;e(R.error(d()))},c);a.get(function(h){f||(clearTimeout(g),e(h))})}))}})},nh=function(a){return jb(kb(R.value(a)))},pl=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,ql=/^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
rl=/(?:^|&)([^&=]+)=?([^&]*)/g,up=["jpg","png","gif","jpeg"],vl=function(a){function c(l,m,k){var q,p,r,n=(r=l.name,fb(r)&&!Ob(r,".tmp")?r:function(u,v){return fb(u.type)&&ca(u.type,"image/")?(u=u.type.substr(6),pa(up,u)?v+"."+u:v):v}(l,m));l=((p=new FormData).append("image",l,n),q=p.get("image"),{type:fa.Blob,data:q});ol(ua(ua({},{url:a.url,body:l,responseType:fa.Text,credentials:!0===a.credentials}),{method:"post"})).get(function(u){u.fold(function(v){k(R.error(ue(v.message,v.status,v.responseText)))},
function(v){var y,A,B,C;try{var E=JSON.parse(v);if(!fb(E.location))return void k(R.error(ue("JSON response did not contain a string location",500,v)));var H=E.location}catch(Q){H=v}var I;v=H.split(/\s+/);H=1===v.length&&""!==v[0]?v[0]:n;v=te(h,E={strictMode:!0});E=te(H,E);H=C=B=A=y=void 0;""!==E.protocol?(y=E.protocol,A=E.authority,B=qd(E.path),C=E.query):(""!==E.authority?(A=E.authority,B=qd(E.path),C=E.query):(""===E.path?(B=v.path,""!==E.query?C=E.query:C=v.query):(ca(E.path,"/")?B=qd(E.path):
(y=v.path,A=E.path,""!==v.authority&&""===y?y="/"+A:(B=y.substring(y.lastIndexOf("/")+1),y=gd(y,B)+A),B=qd(y)),C=E.query),A=v.authority),y=v.protocol);v=(H=E.anchor,(I="")!==y&&(I+=y,I+=":"),""!==A&&(I+="//",I+=A),I+=B,""!==C&&(I+="?",I+=C),""!==H&&(I+="#",I+=H),I);k(R.value({location:v}))})})}var d,e,f,g,h=(f=0<(e=(d=a.url).lastIndexOf("/"))?d.substr(0,e):d,g=void 0===a.basePath?f:a.basePath,Ob(g,"/")?g:g+"/");return{upload:function(l,m,k){Cg(l.imageresult()).then(function(q){c(q,m,k)})}}},Ce=Wa([{failure:["error"]},
{success:["result","images","blob"]}]),ul=function(a,c){return a.get(c).fold(function(){return R.error("Internal error with blob cache")},function(d){return a.remove(c),R.value(d)})},va=function(a,c){a.dom.appendChild(c.dom)},wh=Object.freeze({__proto__:null,showDialog:function(a,c){var d=a.windowManager.open({title:"Error",spacing:10,padding:10,items:[{type:"container",html:c}],buttons:[{text:"Ok",onclick:function(){d.close()}}]})}}),yl=function(a,c,d,e){a.dom.removeEventListener(c,d,e)},zl=Ra,$e=
zh(xb,"comment"),kk=lb(),vp=z({isSupported:!1,cleanDocument:function(){return L.reject("not supported")}}),oo=kk.deviceType.isiOS()||kk.deviceType.isAndroid()?vp:function(a,c,d){c=c+"/wordimport.min.js"+w.from(d||"v=8.0.1").filter(function(f){return 0!==f.length}).map(function(f){return(-1===f.indexOf("?")?"?":"")+f}).getOr("");var e=a.loadScript("ephox.wimp",c);return e.catch(function(f){console.error("Unable to load word import: ",f)}),{isSupported:!0,cleanDocument:function(f,g,h){return e.then(function(l){return l.cleanDocument(f,
g,h.cleanFilteredInlineElements)})}}},Gc=Wa([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);Gc.ltr;Gc.rtl;var He=function(a,c,d,e){return{start:a,soffset:c,finish:d,foffset:e}},Fe=zh($b,"text"),Lf=Wa([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Fc={before:Lf.before,on:Lf.on,after:Lf.after,cata:function(a,c,d,e){return a.fold(c,d,e)},getStart:function(a){return a.fold(wa,wa,wa)}},Qd=Wa([{domRange:["rng"]},{relative:["startSitu",
"finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),wp={domRange:Qd.domRange,relative:Qd.relative,exact:Qd.exact,exactFromRange:function(a){return Qd.exact(a.start,a.soffset,a.finish,a.foffset)},getWin:function(a){return D.fromDom(Dc(a.match({domRange:function(c){return D.fromDom(c.startContainer)},relative:function(c,d){return Fc.getStart(c)},exact:function(c,d,e,f){return c}})).dom.defaultView)},range:He},Y=function(a){a=a.dom;null!==a.parentNode&&a.parentNode.removeChild(a)},Ih=function(a,
c){return Hc(a)?a.style.getPropertyValue(c):""},Li=z((0,re("ephox-sloth").resolve)("bin")),El="b i u sub sup strike".split(" "),Dl=function(a,c){G(da(a),function(d){var e,f;c(d)&&(e=da(d),Ma(f=D.fromTag("div",ab(d).dom),e),cb(d,f),Y(d))})},Kh=Li(),Jh=Kh+sc(""),lk=lb(),Oi=z(lk.browser.isIE()&&10>=lk.browser.version.major),Il=Oi()?function(a,c,d){c.control.block();a.dom.execCommand("paste");d();c.control.unblock()}:function(a,c,d){setTimeout(d,1)},Hl={set:function(a,c){var d,e;var f=c.startContainer();
var g=c.startOffset();var h=c.endContainer();c=c.endOffset();Al(a,(d=Dh(f,g),e=Dh(h,c),wp.relative(d,e)))},get:function(a){return Gh(a).map(Fl)}},Rd,mk,cd,xp=function(a){function c(f,g){var h,l,m=e(),k=(l="callback_"+(h=void 0===m.count?0:m.count),m.count=h+1,l);return m.callbacks[k]=function(){for(var q=[],p=0;p<arguments.length;p++)q[p]=arguments[p];g||d(k);f.apply(void 0,q)},a+".callbacks."+k}function d(f){f=f.substring(f.lastIndexOf(".")+1);var g=e();void 0!==g.callbacks[f]&&delete g.callbacks[f]}
var e=la(Fg,a);Fg("callbacks",e());return{ephemeral:function(f){return c(f,!1)},permanent:function(f){return c(f,!0)},unregister:d}}("ephox.henchman.features"),yp=(cd={},Rd={getOrSetIndexed:function(a,c){return void 0!==cd[a]?cd[a]:(d=a,e=c(),cd[d]=e);var d,e},waitForLoad:function(){return rc(pg(cd,wa))}},{preload:function(){mk().get(wa)},addStylesheet:function(a,c){return Rd.getOrSetIndexed(a,function(){return Jl(a,c)})},addScript:function(a,c){return Rd.getOrSetIndexed(a,function(){return d=a,Ne.nu(function(e){function f(){h.unbind();
l.unbind()}var g=D.fromTag("script");S(g,"src",d);S(g,"type","text/javascript");S(g,"async","async");S(g,"data-main",xp.ephemeral(function(m){e(R.value(m))}));var h=Vb(g,"error",function(){f();e(R.error("Error loading external script tag "+d))}),l=Vb(g,"load",f);va(D.fromDom(document.head),g)}).map(c);var d})},waitForLoad:mk=function(){return Rd.waitForLoad()}}),po={loadScript:function(a,c){return new L(function(d,e){yp.addScript(c,wa).get(function(f){f.fold(e,d)})})}},Jc=Wa([{error:["message"]},
{paste:["elements","correlated"]},{cancel:[]},{incomplete:["elements","correlated","message"]}]),vd=Jc.error,Oa=Jc.paste,Id=Jc.cancel,Jb=Jc.incomplete,Mh="officeStyles htmlStyles gdocsStyles isWord isGoogleDocs proxyBin isInternal backgroundAssets".split(" "),na=function(a){return gg(Mh,function(c){return w.from(a[c])})},Pn={response:Id(),bundle:na({})},Zb=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(0===a.length)throw Error("Can't merge zero objects");c={};for(var d=0;d<
a.length;d++){var e,f=a[d];for(e in f)wb(f,e)&&(c[e]=(c[e],f[e]))}return c},mc=Wa([{starts:["value","f"]},{pattern:["regex","f"]},{contains:["value","f"]},{exact:["value","f"]},{all:[]},{not:["stringMatch"]}]),nk=function(a,c){return a.fold(function(d,e){return 0===e(c).indexOf(e(d))},function(d,e){return d.test(e(c))},function(d,e){return 0<=e(c).indexOf(e(d))},function(d,e){return e(c)===e(d)},Ra,function(d){return!nk(d,c)})},t={starts:mc.starts,pattern:mc.pattern,contains:mc.contains,exact:mc.exact,
all:mc.all,not:mc.not,cata:function(a,c,d,e,f,g,h){return a.fold(c,d,e,f,g,h)},matches:nk,caseSensitive:wa,caseInsensitive:function(a){return a.toLowerCase()}},Ll=["mso-list"],Qe="startElement",Yb="endElement",Kc="text",Uh="comment",xd=Lc("html",window.document),Yh=function(a,c,d){return void 0===d&&(d=!1),a===c||null!=a&&null!=c&&a.tag===c.tag&&a.type===c.type&&(d||a.variant===c.variant)},Sd,ok,Mf,Nf,Of,Ba,nc,zp=["disc","circle","square"],dd=function(){return{getCurrentListType:z({}),getCurrentLevel:z(1),
closeAllLists:ba,openItem:wa}},Pf={inside:function(){return Ap},outside:function(){return pk}},Bp=(Sd=!1,{check:function(a){return!(!Sd||a.type()!==Kc)||(a.type()===Qe&&"style"===a.tag()?Sd=!0:a.type()===Yb&&"style"===a.tag()&&!(Sd=!1))}}),Ap=Zh("Inside.List.Item",[Te(function(a,c){a=a.originalToken.get();return c.type()===Yb&&null!==a&&c.tag()===a.tag()},function(a,c){Se(c,Pf.outside())},"Closing open tag")],function(a,c,d){a.emit(d)}),pk=Zh("Outside.List.Item",[Te(function(a,c){return wc(D.fromDom(c.getNode()),
"data-list-level")},function(a,c,d){var e,f,g,h;a=(e=D.fromDom(d.getNode()),f=parseInt(za(e,"data-list-level"),10),h=null==(g=za(e,"data-list-emblems"))?[]:JSON.parse(g),V(e,"data-list-level"),V(e,"data-list-emblems"),{level:z(f),emblems:z(h)});c.originalToken.set(d);d=(Ol(c.listType.get(),d,c.emitter,a).each(c.listType.set),{level:z(a.level()),token:z(c.originalToken.get()),type:z(c.listType.get())});c.emitter.openItem(d.level(),d.token(),d.type());Se(c,Pf.inside())},"Data List ****"),Te(function(a,
c){return c.type()===Kc&&(d=c).type()===Kc&&/^[\s\u00A0]*$/.test(d.text());var d},function(a,c,d){a.emit(d)},"Whitespace")],function(a,c,d){c.emitter.closeAllLists();a.emit(d);Se(c,Pf.outside())}),Qf=(Mf=sb(ok=pk),Nf=sb(null),Of=sb(null),{reset:function(a){function c(g){G(g.result(),function(h){h=h(e);d.emit(h)})}var d,e,f;Mf.set(ok);Nf.set(null);Of.set(null);dd=z((e=(d=a).document,f=Mc(0,void 0,[],[]),{closeAllLists:function(){var g=fi(f,0);f=g.state();c(g)},openItem:function(g,h,l){var m,k;l&&(m=
"ul"===l.tag&&zp[g-1]===l.type?{tag:"ul"}:l,k=Ql(f,g,h,m),f=k.state(),c(k))},getCurrentListType:function(){return f.type()},getCurrentLevel:function(){return f.level()}}))},nextFilter:Mf,originalToken:Nf,listType:Of,emitter:{getCurrentListType:function(){return dd().getCurrentListType()},getCurrentLevel:function(){return dd().getCurrentLevel()},closeAllLists:function(){return dd().closeAllLists()},openItem:function(a,c,d){return dd().openItem(a,c,d)}}}),Cp=Xh(function(a,c,d){Bp.check(c)||Qf.nextFilter.get()(a,
Qf,c)},Qf.reset),Tl=z(Ra),Rl=[{regex:/^\(?[dc][\.\)]$/,type:{tag:"ol",type:"lower-alpha"}},{regex:/^\(?[DC][\.\)]$/,type:{tag:"ol",type:"upper-alpha"}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:"ol",type:"upper-roman"}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:"ol",type:"lower-roman"}},{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:"ol"}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:"ol",variant:"outline"}},{regex:/^\(?[a-z]+[\.\)]$/,
type:{tag:"ol",type:"lower-alpha"}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:"ol",type:"upper-alpha"}}],ii={"\u2022":{tag:"ul",type:"disc"},"\u00b7":{tag:"ul",type:"disc"},"\u00a7":{tag:"ul",type:"square"}},hi={o:{tag:"ul",type:"circle"},"-":{tag:"ul",type:"disc"},"\u25cf":{tag:"ul",type:"disc"},"\ufffd":{tag:"ul",type:"circle"}},Bd=function(a){return Ha(a)&&ka(a,"font-family").exists(function(c){return pa(["wingdings","symbol"],c.toLowerCase())})},fm=Ea({tags:[{name:t.pattern(/^(p|h\d+)$/,t.caseInsensitive),
mutate:function(a){Ul(a).each(function(c){c.mutate()})}}]});(nc=Ba=Ba||{})[nc.Word=0]="Word";nc[nc.GoogleDocs=1]="GoogleDocs";nc[nc.Html=2]="Html";var qk,rk,sk,Xl=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Yl=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Zl=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,$l=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,rm=Ea({tags:[{name:t.pattern(/^(p|div)$/,t.caseInsensitive),mutate:function(a){var c="ltr"===Ic(a),d=c?"margin-left":"margin-right",e=c?"padding-left":"padding-right";
ka(a,d).each(function(){var f=ja(a,d);sa(a,e,f);ha(a,d)})}}]}),gm=Ib({tags:[{name:t.exact("b",t.caseInsensitive),condition:function(a){return ma(a,"id").exists(function(c){return ca(c,"docs-internal-guid")})}}]}),sm=oa({attributes:[{name:t.exact("id",t.caseInsensitive),value:t.starts("docs-internal-guid",t.caseInsensitive)}]}),om=[Ea({tags:[{name:t.exact("col",t.caseInsensitive),mutate:Ve({attrName:"width",mapValue:function(a){return a.replace(/^(\d+)$/,"$1px")}})}]})],nm=[Cd({matchTag:"span",key:"font-weight",
values:["700","bold"],newTag:"strong"}),Cd({matchTag:"span",key:"font-style",values:["italic"],newTag:"em"}),Cd({matchTag:"span",key:"vertical-align",values:["sub"],newTag:"sub",removeExtra:["font-size"]}),Cd({matchTag:"span",key:"vertical-align",values:["super"],newTag:"sup",removeExtra:["font-size"]})],Dp="p div article aside details dt figcaption footer form fieldset header hgroup html main nav section summary body dl multicol dd figure address center blockquote h1 h2 h3 h4 h5 h6 listing xmp pre plaintext menu dir ul ol li hr table tbody thead tfoot th tr td caption".split(" "),
mm=oa({styles:[{name:t.exact("background-color",t.caseInsensitive),value:t.exact("transparent",t.caseInsensitive)},{name:t.exact("white-space",t.caseInsensitive),value:t.starts("pre",t.caseInsensitive)},{name:t.pattern(/^overflow(-[xy])?$/,t.caseInsensitive),condition:function(a){return Qc(a)&&td(ka(a,"overflow"),"hidden")}},{name:t.exact("overflow-wrap",t.caseInsensitive),condition:Qc},{name:t.exact("table-layout",t.caseInsensitive),value:t.exact("fixed",t.caseInsensitive),condition:ya("table")},
{name:t.exact("line-height",t.caseInsensitive),value:t.exact("1.38",t.caseInsensitive)},{name:t.exact("vertical-align",t.caseInsensitive),value:t.exact("baseline",t.caseInsensitive)},{name:t.exact("font-style",t.caseInsensitive),value:t.exact("normal",t.caseInsensitive)},{name:t.exact("font-variant",t.caseInsensitive),value:t.exact("normal",t.caseInsensitive)},{name:t.exact("background-color",t.caseInsensitive),value:t.exact("transparent",t.caseInsensitive)},{name:t.starts("padding",t.caseInsensitive),
condition:Qc},{name:t.pattern(/^text-decoration(-(line|thickness|style|color))?$/,t.caseInsensitive),condition:function(a){return!ya("a")(a)&&td(ka(a,"text-decoration"),"none")}}],attributes:[{name:t.exact("aria-level",t.caseInsensitive),condition:ya("li")},{name:t.exact("dir",t.caseInsensitive),value:t.exact("ltr",t.caseInsensitive),condition:function(a){return pa(Dp,Z(a))}},{name:t.exact("role",t.caseInsensitive),value:t.exact("presentation",t.caseInsensitive),condition:function(a){return ya("p")(a)&&
bb(a).exists(ya("li"))}}]}),pm=oa({styles:[{name:t.exact("text-align",t.caseInsensitive),value:t.exact("right",t.caseInsensitive),condition:function(a){return"rtl"===Ic(a)}}]}),qm=Ea({tags:[{name:t.exact("p",t.caseInsensitive),condition:function(a){function c(e){return ka(a,e).map(function(f){return parseInt(f,10)}).filter(function(f){return!isNaN(f)}).getOr(0)}var d=Ic(a);return 0===c("text-indent")+c("rtl"===d?"padding-right":"padding-left")},mutate:function(a){var c=Ic(a);ha(a,"text-indent");ha(a,
"rtl"===c?"padding-right":"padding-left")}}]}),Ep=ya("li"),tk=function(a){return nd(a).bind(function(c){return $b(c)&&0===Ch(c).trim().length?tk(c):Ep(c)?w.some(c):w.none()})},um=oa({tags:[{name:t.exact("script",t.caseInsensitive)},{name:t.exact("link",t.caseInsensitive)},{name:t.exact("style",t.caseInsensitive),condition:function(a){return 0===a.dom.innerHTML.length}}],attributes:[{name:t.starts("on",t.caseInsensitive)},{name:t.exact('"',t.caseInsensitive)},{name:t.exact("lang",t.caseInsensitive)},
{name:t.exact("language",t.caseInsensitive)}],styles:[{name:t.all(),value:t.pattern(/OLE_LINK/i,t.caseInsensitive)}]}),ti=oa({tags:[{name:t.exact("meta",t.caseInsensitive)}]}),Pm=oa({tags:[{name:t.exact("style",t.caseInsensitive)}]}),xm=oa({styles:[{name:t.not(t.pattern(/^(width|height|list-style-type)$/,t.caseInsensitive)),condition:function(a){return!rd(a,"ephox-limbo-transform")}},{name:t.pattern(/^(width|height)$/,t.caseInsensitive),condition:function(a){return"img"!==Z(a)&&!("table"===Z(c=a)||
Qc(c));var c}}]}),ym=oa({classes:[{name:t.not(t.exact("rtf-data-image",t.caseInsensitive))}]}),vm=oa({styles:[{name:t.pattern(/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/,t.caseInsensitive)}]}),wm=oa({classes:[{name:t.pattern(/mso/i,t.caseInsensitive)}]}),em=Ib({tags:[{name:t.exact("img",t.caseInsensitive),condition:function(a){a=za(a,"src");return fb(a)&&
/^file:/.test(a)}}]}),Bm=Ib({tags:[{name:t.exact("a",t.caseInsensitive),condition:Ye}]}),Cm=oa({attributes:[{name:t.exact("style",t.caseInsensitive),value:t.exact("",t.caseInsensitive)}]}),Dm=oa({attributes:[{name:t.exact("class",t.caseInsensitive),value:t.exact("",t.caseInsensitive)}]}),Em=Ib({tags:[{name:t.pattern(/^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/,t.caseInsensitive),condition:(qk=function(a){return!Ye(a)||(d=null!=(c=a.dom.attributes)&&0<c.length,
("span"!==Z(a)||d)&&oi(a,function(e){var f=!Ye(e),g=!pa("font em strong samp acronym cite code dfn kbd tt b i u s sub sup ins del var span".split(" "),Z(e));return $b(e)||f||g}));var c,d},function(a){return!qk(a)})}]}),Im=Ea({tags:[{name:t.exact("p",t.caseInsensitive),mutate:function(a){0===a.dom.innerHTML.length&&va(a,D.fromTag("br"))}}]}),tm=Ea({tags:[{name:t.pattern(/ol|ul/,t.caseInsensitive),mutate:function(a){bb(a).each(function(c){pa(["ol","ul"],Z(c))&&tk(a).fold(function(){var d=D.fromTag("li");
sa(d,"list-style-type","none");Be(a,d)},function(d){va(d,a)})})}}]}),Om=oa({classes:[{name:t.exact("ephox-limbo-transform",t.caseInsensitive)}]}),Fm=oa({tags:[{name:t.exact("br",t.caseInsensitive),condition:ph("Apple-interchange-newline")}]}),Gm=oa({styles:[{name:t.pattern(/^-/,t.caseInsensitive)},{name:t.all(),value:t.exact("initial",t.caseInsensitive)},{name:t.exact("background-color",t.caseInsensitive),value:t.exact("transparent",t.caseInsensitive)},{name:t.exact("font-style",t.caseInsensitive),
value:t.exact("normal",t.caseInsensitive)},{name:t.pattern(/font-variant.*/,t.caseInsensitive)},{name:t.exact("letter-spacing",t.caseInsensitive)},{name:t.exact("font-weight",t.caseInsensitive),value:t.pattern(/400|normal/,t.caseInsensitive)},{name:t.exact("orphans",t.caseInsensitive)},{name:t.exact("text-decoration",t.caseInsensitive),value:t.exact("none",t.caseInsensitive)},{name:t.exact("text-size-adjust",t.caseInsensitive)},{name:t.exact("text-indent",t.caseInsensitive),value:t.exact("0px",t.caseInsensitive)},
{name:t.exact("text-transform",t.caseInsensitive),value:t.exact("none",t.caseInsensitive)},{name:t.exact("white-space",t.caseInsensitive),value:t.exact("normal",t.caseInsensitive)},{name:t.exact("widows",t.caseInsensitive)},{name:t.exact("word-spacing",t.caseInsensitive),value:t.exact("0px",t.caseInsensitive)},{name:t.exact("text-align",t.caseInsensitive),value:t.pattern(/start|end/,t.caseInsensitive)},{name:t.exact("font-weight",t.caseInsensitive),value:t.pattern(/700|bold/,t.caseInsensitive),condition:function(a){return/^h\d$/.test(Z(a))}}]}),
Hm=(rk=pi(nd,Ob),sk=pi(Tb,ca),Ea({tags:[{name:t.exact("span",t.caseInsensitive),condition:ph("Apple-converted-space"),mutate:function(a){"\u00a0"===a.dom.textContent&&(rk(a)||sk(a)?sd(a):(cb(a,D.fromText(" ")),Y(a)))}}]})),Rf,zm=(Rf=/^file:\/\/\/[^#]+(#[^#]+)$/,Ea({tags:[{name:t.exact("a",t.caseInsensitive),condition:function(a){a=za(a,"href");return!!a&&Rf.test(a)},mutate:function(a){ma(a,"href").each(function(c){S(a,"href",c.replace(Rf,"$1"))})}}]})),Am=oa({attributes:[{name:t.exact("href",t.caseInsensitive),
value:t.starts("file:///",t.caseInsensitive)}]}),vi=Ea({tags:[qi("a","data-ephox-href","href"),qi("img","data-ephox-src","src")]}),wi=Ea({tags:[{name:t.pattern(/^(img|table)$/,t.caseInsensitive),mutate:function(a){ka(a,"margin-left").exists(function(c){return ca(c,"-")})&&ha(a,"margin-left");ca(ja(a,"margin-left"),"-")&&(sa(a,"margin-top",ja(a,"margin-top")),sa(a,"margin-bottom",ja(a,"margin-bottom")),sa(a,"margin-right",ja(a,"margin-right")),ha(a,"margin"))}}]}),ui=Ea({tags:[{name:t.exact("p",t.caseInsensitive),
mutate:Ve({attrName:"align",styleName:"text-align",mapValue:wa})}]}),hm=oa({tags:[{name:t.exact("font",t.caseInsensitive),condition:function(a){function c(d){return d.replace(/[ \r\n\uFEFF]+/g,"")}a=da(a);return 0===a.length||fg(a,function(d){return ri(d,c)})}}]}),im=Ea({tags:[{name:t.exact("ol",t.caseInsensitive),mutate:si},{name:t.exact("ul",t.caseInsensitive),mutate:si}]}),jm=Ib({tags:[{name:t.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i,t.caseInsensitive)}]}),km=[Wh([Cp])],Nm=oa({attributes:[{name:t.exact("height",
t.caseInsensitive),condition:ya("table")}]}),Mm=oa({attributes:[{name:t.pattern(/^(width|height)$/,t.caseInsensitive),condition:Qc}]}),Lm=Ea({tags:[{name:t.exact("table",t.caseInsensitive),mutate:Ve({attrName:"width",mapValue:function(a){return a.replace(/^(\d+)$/,"$1px")}})}]}),Km=oa({styles:[{name:t.exact("height",t.caseInsensitive),condition:ya("td")},{name:t.exact("width",t.caseInsensitive),condition:ya("tr")},{name:t.exact("height",t.caseInsensitive),condition:ya("col")}]}),lm=oa({attributes:[{name:t.pattern(/^v:/,
t.caseInsensitive)},{name:t.exact("href",t.caseInsensitive),value:t.contains("#_toc",t.caseInsensitive)},{name:t.exact("href",t.caseInsensitive),value:t.contains("#_mso",t.caseInsensitive)},{name:t.pattern(/^xmlns(:|$)/,t.caseInsensitive)},{name:t.exact("type",t.caseInsensitive),condition:function(a){return"ol"===Z(a)||"ul"===Z(a)}}]}),Jm=Ib({tags:[{name:t.exact("p",t.caseInsensitive),condition:function(a){return bb(a).exists(function(c){return"li"===Z(c)&&1===da(c).length})}}]});Ea({tags:[{name:t.pattern(/^(img|table)$/,
t.caseInsensitive),mutate:function(a){ka(a,"margin-left").exists(function(c){return ca(c,"-")})&&ha(a,"margin-left");ca(ja(a,"margin-left"),"-")&&(sa(a,"margin-top",ja(a,"margin-top")),sa(a,"margin-bottom",ja(a,"margin-bottom")),sa(a,"margin-right",ja(a,"margin-right")),ha(a,"margin"))}}]});Wa([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var Bi=function(a,c,d){var e=c/(a.naturalWidth||a.width),f=d/(a.naturalHeight||
a.height),g=!1;(.5>e||2<e)&&(e=.5>e?.5:2,g=!0);(.5>f||2<f)&&(f=.5>f?.5:2,g=!0);a=Fp(a,e,f);return g?a.then(function(h){return Bi(h,c,d)}):a},Fp=function(a,c,d){return new Ka(function(e){var f=a.naturalWidth||a.width,g=a.naturalHeight||a.height,h=Math.floor(f*c),l=Math.floor(g*d),m=tc(h,l);m.getContext("2d").drawImage(a,0,0,f,g,0,0,h,l);e(m)})},Ai=/rotate\((\d\.\d+)rad\)/,Gp="body p div article aside figcaption figure footer header nav section ol ul li table thead tbody tfoot caption tr td th h1 h2 h3 h4 h5 h6 blockquote pre address".split(" "),
Ym=function(a){return c=a,d=z(0),e=z(0),f=w.none(),{term:function(){return new RegExp(c,f.getOr("g"))},prefix:d,suffix:e};var c,d,e,f},Sf=Wa([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}]),Uc={include:Sf.include,excludeWith:Sf.excludeWith,excludeWithout:Sf.excludeWithout,cata:function(a,c,d,e){return a.fold(c,d,e)}},Td=Wa([{boundary:["item","universe"]},{empty:["item","universe"]},{text:["item","universe"]},{nonEditable:["item","universe"]}]),ac=Pa,Tm=Ra,Um=z(0),Di=z(1),Tf=
{text:oc(Fd,Td.text),boundary:oc(Fd,Td.boundary),empty:oc(Fd,Td.empty),nonEditable:oc(Fd,Td.empty),cata:function(a,c,d,e,f){return a.fold(c,d,e,f)}},Uf=z([]),uk=function(a,c,d){if(a.property().isText(c))return[Tf.text(c,a)];if(a.property().isEmptyTag(c))return[Tf.empty(c,a)];if(a.property().isNonEditable(c))return[];if(a.property().isElement(c)){var e=a.property().children(c),f=a.property().isBoundary(c)?[Tf.boundary(c,a)]:[];c=void 0!==d&&d(c)?[]:ia(e,function(g){return uk(a,g,d)});return f.concat(c).concat(f)}return[]},
vn=uk,$m=function(a,c,d,e){return ia(un(a,c,e),function(f){var g,h,l,m=ia(f,function(k){return k.fold(Uf,Uf,function(q){return[q]},Uf)});f=(g=N(m,a.property().getText).join(""),l=ia(d,function(k){return N(function(q,p){for(var r=p.term(),n=[],u=r.exec(q);u;){var v=u.index+p.prefix(u);u=u[0].length-p.prefix(u)-p.suffix(u);n.push({start:v,finish:v+u});r.lastIndex=v+u;u=r.exec(q)}return n}(g,k.pattern),function(q){return ua(ua({},k),q)})}),(h=Array.prototype.slice.call(l,0)).sort(function(k,q){return k.start<
q.start?-1:q.start<k.start?1:0}),h);h=Ei(m,function(k,q){var p=q+a.property().getText(k).length;return w.from(Ed(k,q,p))});return Vm(a,h,f)})},an={up:z({selector:ze,closest:rh,predicate:qh,all:function(a,c){c=Ua(c)?c:Pa;var d=a.dom;for(a=[];null!==d.parentNode&&void 0!==d.parentNode;){d=d.parentNode;var e=D.fromDom(d);if(a.push(e),!0===c(e))break}return a}}),down:z({selector:od,predicate:Ze}),styles:z({get:ja,getRaw:ka,set:sa,remove:ha}),attrs:z({get:za,set:S,remove:V,copyTo:function(a,c){vc(c,ob(a.dom.attributes,
function(d,e){return d[e.name]=e.value,d},{}))}}),insert:z({before:cb,after:th,afterAll:function(a,c){G(c,function(d,e){th(0===e?a:c[e-1],d)})},append:va,appendAll:Ma,prepend:uh,wrap:Be}),remove:z({unwrap:sd,remove:Y}),create:z({nu:D.fromTag,clone:function(a){return D.fromDom(a.dom.cloneNode(!1))},text:D.fromText}),query:z({comparePosition:function(a,c){return a.dom.compareDocumentPosition(c.dom)},prevSibling:nd,nextSibling:Tb}),property:z({children:da,name:Z,parent:bb,document:function(a){return Dc(a).dom},
isText:$b,isComment:xb,isElement:Ha,isSpecial:function(a){return pa("script noscript iframe noframes noembed title style textarea xmp".split(" "),Z(a))},getLanguage:function(a){return Ha(a)?ma(a,"lang"):w.none()},getText:Ch,setText:function(a,c){return Fe.set(a,c)},isBoundary:function(a){return!!Ha(a)&&("body"===Z(a)||pa(Gp,Z(a)))},isEmptyTag:function(a){return!!Ha(a)&&pa(["br","img","hr","input"],Z(a))},isNonEditable:function(a){return Ha(a)&&"false"===za(a,"contenteditable")}}),eq:Eb,is:qe},Zm=
/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-+~=.,%()\/\w]*[-+~=%()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source,bn=function(a){a=a.indexOf("://");return 3<=a&&9>=a},Vf={disabled:function(){return{discriminator:"disabled",data:{}}},fromClipboard:function(a){return{discriminator:"fromClipboard",data:{rtf:a}}}},$n=Va(Vf),Ni=Vf.disabled,on=Vf.fromClipboard,
Hi=function(a,c){var d=new RegExp(c,"i");return vb(a,function(e){var f=null!==d.exec(e);e={type:e,flavor:c};return f?w.some(e):w.none()})},pn=bc("event"),ln=bc("html"),nn=bc("images"),Mi=bc("word"),bf=bc("text"),qn=bc("void"),qo=Sc("event"),hf=Sc("html"),mo=Sc("images"),pj=Sc("word"),Mn=Sc("text"),Wf=lb().browser,kn=!(Wf.isIE()||Wf.isEdge()&&16>Wf.version.major),mn=["^image/","file"],Xf={native:"Outside of Textbox.io pasting HTML5 API (could be internal)",fallback:"Outside of Textbox.io pasting offscreen (could be internal)",
msoffice:"Word Import pasting",googledocs:"Google Docs pasting",image:"Image pasting",plaintext:"Only plain text is available to paste",text:"Plain text pasting",none:"There is no valid way to paste",discard:"There is no valid way to paste, discarding content"},mb=ua({getLabelForApi:function(a){return Sa(Va(Xf),function(c){return Xf[c]===a}).fold(z("unknown"),function(c){switch(c){case "native":case "fallback":return"html";case "none":case "discard":return"invalid";default:return c}})}},Xf),Pi=function(a){var c=
function(e){for(var f=Gg,g=0;g<e.length&&null!=f;++g)f=f[e[g]];return f}(["window","clipboardData","files"]),d=null==a.convertURL?null==a.msConvertURL?void 0:a.msConvertURL:a.convertURL;return void 0!==c&&void 0!==Pi&&0<c.length?(c=L.all(N(c,function(e){var f=URL.createObjectURL(e);return d.apply(a,[e,"specified",f]),Dg(e,f).toPromise()})),w.some(c)):w.none()},wn=[{code:404,message:"Could not find Image Proxy"},{code:403,message:"Rejected request"},{code:0,message:"Incorrect Image Proxy URL"}],yn=
[{type:"not_found",message:"Failed to load image."},{type:"key_missing",message:"The request did not include an api key."},{type:"key_not_found",message:"The provided api key could not be found."},{type:"domain_not_trusted",message:"The api key is not valid for the request origins."}],Hd=re("ephox-cement").resolve,vk={},Yf={exports:vk};(function(a){"object"==typeof vk&&void 0!==Yf?Yf.exports=a():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=
a()})(function(){return function f(c,d,e){function g(m,k){if(!d[m]){if(!c[m]){if(h)return h(m,!0);k=Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k;}k=d[m]={exports:{}};c[m][0].call(k.exports,function(q){return g(c[m][1][q]||q)},k,k.exports,f,c,d,e)}return d[m].exports}for(var h=!1,l=0;l<e.length;l++)g(e[l]);return g}({1:[function(c,d,e){var f,g;c=(f=function(h){var l,m=[];h=h.split(",");for(var k=0,q=h.length;k<q;k+=1)0<(l=h[k]).length&&m.push(g(l));return m},g=function(h){function l(n){var u;
if(n.test(q)){var v=0;for(u=(n=q.match(n)).length;v<u;v+=1){var y=n[v];q=q.replace(y,Array(y.length+1).join("A"))}}}var m,k,q=h,p={a:0,b:0,c:0},r=[];return m=function(n,u){var v;if(n.test(q)){var y=0;for(v=(n=q.match(n)).length;y<v;y+=1){p[u]+=1;var A=n[y];var B=q.indexOf(A);var C=A.length;r.push({selector:h.substr(B,C),type:u,index:B,length:C});q=q.replace(A,Array(C+1).join(" "))}}},l(/\\[0-9A-Fa-f]{6}\s?/g),l(/\\[0-9A-Fa-f]{1,5}\s/g),l(/\\./g),(k=/:not\(([^\)]*)\)/g).test(q)&&(q=q.replace(k,"     $1 ")),
function(){var n;var u=/{[^]*/gm;if(u.test(q)){var v=0;for(n=(u=q.match(u)).length;v<n;v+=1){var y=u[v];q=q.replace(y,Array(y.length+1).join(" "))}}}(),m(/(\[[^\]]+\])/g,"b"),m(/(#[^#\s\+>~\.\[:]+)/g,"a"),m(/(\.[^\s\+>~\.\[:]+)/g,"b"),m(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,"c"),m(/(:[\w-]+\([^\)]*\))/gi,"b"),m(/(:[^\s\+>~\.\[:]+)/g,"b"),q=(q=q.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),m(/([^\s\+>~\.\[:]+)/g,"c"),r.sort(function(n,u){return n.index-u.index}),{selector:h,
specificity:"0,"+p.a.toString()+","+p.b.toString()+","+p.c.toString(),specificityArray:[0,p.a,p.b,p.c],parts:r}},{calculate:f,compare:function(h,l){var m;if("string"==typeof h){if(-1!==h.indexOf(","))throw"Invalid CSS selector";h=g(h).specificityArray}else{if(!Array.isArray(h))throw"Invalid CSS selector or specificity array";if(4!==h.filter(function(k){return"number"==typeof k}).length)throw"Invalid specificity array";}if("string"==typeof l){if(-1!==l.indexOf(","))throw"Invalid CSS selector";l=g(l).specificityArray}else{if(!Array.isArray(l))throw"Invalid CSS selector or specificity array";
if(4!==l.filter(function(k){return"number"==typeof k}).length)throw"Invalid specificity array";}for(m=0;4>m;m+=1){if(h[m]<l[m])return-1;if(h[m]>l[m])return 1}return 0}});void 0!==e&&(e.calculate=c.calculate,e.compare=c.compare)},{}],2:[function(c,d,e){c=c("specificity");d.exports={boltExport:c}},{specificity:1}]},{},[2])(2)});var Dn=Yf.exports.boltExport,Jd=function(a){return ia(a.cssRules,function(c){if(c.type===window.CSSRule.IMPORT_RULE)c=Jd(c.styleSheet);else if(c.type===window.CSSRule.STYLE_RULE){var d=
c.selectorText,e=c.style.cssText;if(void 0===e)throw Error("WARNING: Browser does not support cssText property");c=[{selector:d,style:e,raw:c.style}]}else c=[];return c})},Fn={inlineStyles:function(a,c,d){bj(a,c,d,!0)},inlineStylesKeepClasses:function(a,c,d){bj(a,c,d,!1)},inlinePrefixedStyles:function(a,c,d){cj(a,c,d,!0)},inlinePrefixedStylesKeepClasses:function(a,c,d){cj(a,c,d,!1)},inlineSelectorsStyles:function(a,c,d){dj(a,c,d,!0)},inlineSelectorsStylesKeepClasses:function(a,c,d){dj(a,c,d,!1)}},
Gn={p:"p, li[data-converted-paragraph]"},Hn=function(a,c){G(ra("li[data-converted-paragraph]",a),function(d){V(d,"data-converted-paragraph")});c&&(G(ra("li",a),function(d){var e,f,g=(uh(a,f=D.fromTag("span")),{convertToPx:function(l){var m;return sa(f,"margin-left",l),m=ja(f,"margin-left"),parseFloat(/-?\d+\.?\d*/.exec(m)[0])},destroy:function(){return Y(f)}}),h=(e=ma(a,"data-tab-interval").getOr("36pt"),g.convertToPx(e));e=Hp(d,h,g).getOr({});V(d,"data-list-level");V(d,"data-text-indent-alt");V(d,
"data-border-margin");ha(d,"margin-left");ha(d,"text-indent");xa(Me(d),function(l,m){!ca(m,"border")||"border-image"!==m&&"none"!==l.trim()&&"initial"!==l.trim()||ha(d,m)});g.destroy();Wb(d,e)}),G(ra("ol,ul",a),function(d){var e=ra("li",d);ka(d,"margin-top").isNone()&&w.from(e[0]).each(function(f){sa(d,"margin-top",ja(f,"margin-top"))});ka(d,"margin-bottom").isNone()&&w.from(e[e.length-1]).each(function(f){sa(d,"margin-bottom",ja(f,"margin-bottom"))})}));V(a,"data-tab-interval")},Hp=function(a,c,
d){function e(f){return ma(f,"data-list-level").map(function(g){return parseInt(g,10)}).getOr(1)}return ka(a,"text-indent").bind(function(f){return ka(a,"margin-left").map(function(g){var h=ka(a,"list-style").exists(function(k){return U(k,"none")}),l=ma(a,"data-border-margin").getOr("0px");h=h?e(a)+1:e(a);g=d.convertToPx(g)+d.convertToPx(l);l=c*h;h=ma(a,"data-text-indent-alt").getOr(f);var m=d.convertToPx(h);h={};m=c/2*-1-m;0<m&&(h["text-indent"]=m+"px");g=g-l-m;return h["margin-left"]=0<g?g+"px":
"0px",h})})},Jn=lb(),ro=z(Hd("smartpaste-eph-bin")),mf=lb(),wk=Wa([{unsupported:["id","message","isEquation","attrs"]},{supported:["id","contentType","blob","isEquation","attrs"]}]),Kb={unsupported:wk.unsupported,supported:wk.supported,cata:function(a,c,d){return a.fold(c,d)}},Wn=function(a,c){var d=a.indexOf("{\\pict{",c),e=jf(a,d),f=a.indexOf("{\\shp{",c),g=jf(a,f),h=a.indexOf("{\\mmathPict{",c),l=jf(a,h);l=-1!==h&&(h<d&&e<l||h<f&&g<l);h=la(Un,a,c,f,g,l);a=la(Tn,a,c,d,e,l);return-1===d&&-1===f?
w.none():-1===d?h():-1===f||f<d&&e<g?a():d<f&&g<e?h():d<f?a():f<d?h():w.none()},wo=Object.freeze({__proto__:null,loadScript:function(a,c){return tinymce.Resource||so(),tinymce.Resource.load(a,c)}}),Zf=lb().browser,yo=!(Zf.isIE()||Zf.isEdge()&&16>Zf.version.major),xo=Object.freeze({__proto__:null,showDialog:function(a,c){a.windowManager.open({title:"Error",body:{type:"panel",items:[{type:"htmlpanel",html:c}]},initialData:{},buttons:[{text:"OK",type:"cancel",name:"ok",primary:!0}]})}});tinymce.PluginManager.requireLangPack("powerpaste",
"ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hr,hu_HU,id,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW");tinymce.PluginManager.add("powerpaste",Xd(tinymce,"4.0.28")?(console.error('The "powerpaste" plugin requires at least 4.0.28 version of TinyMCE.'),ba):function(a,c){function d(k){function q(p){k.setActive(p.state)}return k.setActive(h.isText()),a.on("PastePlainTextToggle",q),function(){return a.off("PastePlainTextToggle",q)}}function e(){var k=this;k.active(h.isText());
a.on("PastePlainTextToggle",function(q){k.active(q.state)})}var f,g=!Xd(tinymce,"5.0.0"),h=zo(a,g);tinymce.Env.ie&&10>tinymce.Env.ie?function(k,q){function p(C){return function(E){C(E)}}var r,n,u=this,v=Zg(k,gb,!1),y=(n=v.showDialog,function(C){xh(r,n,q,C)});(r=k).on("paste",p(y));var A,B;y=(B=v.showDialog,function(C){(tinymce.isOpera||0<navigator.userAgent.indexOf("Firefox/2"))&&((tinymce.isMac?C.metaKey:C.ctrlKey)&&86===C.keyCode||C.shiftKey&&45===C.keyCode)&&xh(A,B,q,C)});(A=k).on("keydown",p(y));
k.addCommand("mceInsertClipboardContent",function(C,E){v.showDialog(E.content||E)});$d(k)&&k.on("PastePreProcess",function(C){$d(k).call(u,u,C)})}(a,h):(f=(void 0!==a.uploadImages?vh:function(k){if(fb(k.getParam("images_upload_url"))){var q={url:k.getParam("images_upload_url"),basePath:k.getParam("images_upload_base_path"),credentials:k.getParam("images_upload_credentials",!1)};return tl(k,q)}var p;return{importImages:function(){return kb([])},uploadImages:ba,prepareImages:function(r){G(r,function(n){La.cata(n,
function(u,v,y){var A=v.toDataURL();G(p.dom.select('img[src="'+y+'"]'),function(B){p.dom.setAttrib(B,"src",A)})},ba)})},getLocalURL:vh(p=k).getLocalURL}})(a),vo(a,h,c,void 0,f,g),a.getParam("powerpaste_block_drop",!1,"boolean")?a.on("init",function(){mg(a,a.getBody());a.inline||mg(a,a.getDoc())}):el(a,0,f,g));var l=$d(a);var m=a.getParam("paste_postprocess");l&&a.on("PastePreProcess",function(k){return l.call(a,a.plugins.powerpaste,k)});m&&a.on("PastePostProcess",function(k){return m.call(a,a.plugins.powerpaste,
k)});g?(a.ui.registry.addToggleButton("pastetext",{icon:"paste-text",tooltip:"Paste as text",onAction:h.buttonToggle,onSetup:d}),a.ui.registry.addToggleMenuItem("pastetext",{icon:"paste-text",text:"Paste as text",onAction:h.buttonToggle,onSetup:d})):(a.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:h.buttonToggle,onPostRender:e}),a.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,onclick:h.buttonToggle,onPostRender:e}));a.addCommand("mceTogglePlainTextPaste",h.toggle)})}();
